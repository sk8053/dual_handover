\hypertarget{classns3_1_1PacketMetadata}{}\section{ns3\+:\+:Packet\+Metadata Class Reference}
\label{classns3_1_1PacketMetadata}\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}


Handle packet metadata about packet headers and trailers.  




{\ttfamily \#include $<$packet-\/metadata.\+h$>$}



Collaboration diagram for ns3\+:\+:Packet\+Metadata\+:
% FIG 0
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structns3_1_1PacketMetadata_1_1Data}{Data}
\item 
class \hyperlink{classns3_1_1PacketMetadata_1_1DataFreeList}{Data\+Free\+List}
\begin{DoxyCompactList}\small\item\em Class to hold all the metadata. \end{DoxyCompactList}\item 
struct \hyperlink{structns3_1_1PacketMetadata_1_1ExtraItem}{Extra\+Item}
\begin{DoxyCompactList}\small\item\em \hyperlink{structns3_1_1PacketMetadata_1_1ExtraItem}{Extra\+Item} structure. \end{DoxyCompactList}\item 
struct \hyperlink{structns3_1_1PacketMetadata_1_1Item}{Item}
\begin{DoxyCompactList}\small\item\em structure describing a packet metadata item \end{DoxyCompactList}\item 
class \hyperlink{classns3_1_1PacketMetadata_1_1ItemIterator}{Item\+Iterator}
\begin{DoxyCompactList}\small\item\em Iterator class for metadata items. \end{DoxyCompactList}\item 
struct \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Small\+Item}
\begin{DoxyCompactList}\small\item\em \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Small\+Item} structure. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classns3_1_1PacketMetadata_a3c1a7bc063be52d90c9bdf7dbbcfeff7}{Packet\+Metadata} (uint64\+\_\+t uid, uint32\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1PacketMetadata_acc6ec4194d1858d85ffc8ccf68535a37}{Packet\+Metadata} (\hyperlink{classns3_1_1PacketMetadata}{Packet\+Metadata} const \&o)
\begin{DoxyCompactList}\small\item\em Copy constructor. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1PacketMetadata}{Packet\+Metadata} \& \hyperlink{classns3_1_1PacketMetadata_a808cc741d74271cce313d5a0691de5b7}{operator=} (\hyperlink{classns3_1_1PacketMetadata}{Packet\+Metadata} const \&o)
\begin{DoxyCompactList}\small\item\em Basic assignment. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1PacketMetadata_a3e5d8647a8dbf2d041e8275805b1692f}{$\sim$\+Packet\+Metadata} ()
\item 
void \hyperlink{classns3_1_1PacketMetadata_abdce736c4c5f647242f0808c0d2f9249}{Add\+Header} (\hyperlink{classns3_1_1Header}{Header} const \&header, uint32\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Add an header. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_afa8a589ec783d4998516d7f39f21242d}{Remove\+Header} (\hyperlink{classns3_1_1Header}{Header} const \&header, uint32\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Remove an header. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_afd698b5f0ce0e9f498fff8a6915837c5}{Add\+Trailer} (\hyperlink{classns3_1_1Trailer}{Trailer} const \&trailer, uint32\+\_\+t size)
\item 
void \hyperlink{classns3_1_1PacketMetadata_a2eaa46d9f7c88a5aef121521b196753c}{Remove\+Trailer} (\hyperlink{classns3_1_1Trailer}{Trailer} const \&trailer, uint32\+\_\+t size)
\item 
\hyperlink{classns3_1_1PacketMetadata}{Packet\+Metadata} \hyperlink{classns3_1_1PacketMetadata_a0c4fe43ab63b49432451c37263826d67}{Create\+Fragment} (uint32\+\_\+t start, uint32\+\_\+t end) const 
\begin{DoxyCompactList}\small\item\em Creates a fragment. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_af7ceb1a4a7ded625c85dbd477b5fc8b6}{Add\+At\+End} (\hyperlink{classns3_1_1PacketMetadata}{Packet\+Metadata} const \&o)
\begin{DoxyCompactList}\small\item\em Add a metadata at the metadata start. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_a9398445226b4df97e2d489cf0a431ace}{Add\+Padding\+At\+End} (uint32\+\_\+t end)
\begin{DoxyCompactList}\small\item\em Add some padding at the end. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_a9a0300e7ae709f269d59b6733e590d56}{Remove\+At\+Start} (uint32\+\_\+t start)
\begin{DoxyCompactList}\small\item\em Remove a chunk of metadata at the metadata start. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_a7c76154f5302bd55a68406f0103d50c6}{Remove\+At\+End} (uint32\+\_\+t end)
\begin{DoxyCompactList}\small\item\em Remove a chunk of metadata at the metadata end. \end{DoxyCompactList}\item 
uint64\+\_\+t \hyperlink{classns3_1_1PacketMetadata_a08284bf2d5d0690d16a2eee813122ede}{Get\+Uid} (void) const 
\begin{DoxyCompactList}\small\item\em Get the packet Uid. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{classns3_1_1PacketMetadata_a8d399798f5b18fc287a772914bfd9386}{Get\+Serialized\+Size} (void) const 
\begin{DoxyCompactList}\small\item\em Get the metadata serialized size. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1PacketMetadata_1_1ItemIterator}{Item\+Iterator} \hyperlink{classns3_1_1PacketMetadata_aa574c0500da92d42d3cb53ae8a9fd0ad}{Begin\+Item} (\hyperlink{classns3_1_1Buffer}{Buffer} buffer) const 
\begin{DoxyCompactList}\small\item\em Initialize the item iterator to the buffer begin. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{classns3_1_1PacketMetadata_aae036ce6844106a8a3ce88e0e095a7eb}{Serialize} (uint8\+\_\+t $\ast$buffer, uint32\+\_\+t max\+Size) const 
\begin{DoxyCompactList}\small\item\em Serialization to raw uint8\+\_\+t$\ast$. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{classns3_1_1PacketMetadata_a88efb0a5ff0339b9430ded4e3452397d}{Deserialize} (const uint8\+\_\+t $\ast$buffer, uint32\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Deserialization from raw uint8\+\_\+t$\ast$. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{classns3_1_1PacketMetadata_addee67896039c1a356ee47698b04e953}{Enable} (void)
\begin{DoxyCompactList}\small\item\em Enable the packet metadata. \end{DoxyCompactList}\item 
static void \hyperlink{classns3_1_1PacketMetadata_a5bb19e2208a6a0573cdc79c3959ac6b4}{Enable\+Checking} (void)
\begin{DoxyCompactList}\small\item\em Enable the packet metadata checking. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
friend \hyperlink{classns3_1_1PacketMetadata_a343187327aa7336b54e71cc3b1df881d}{Data\+Free\+List\+::$\sim$\+Data\+Free\+List} ()
\item 
\hyperlink{classns3_1_1PacketMetadata_a78447d800a9c3b6c85a3f38a09682b00}{Packet\+Metadata} ()
\item 
uint16\+\_\+t \hyperlink{classns3_1_1PacketMetadata_a9d74d684e6a7448a6790220c6c8e99f2}{Add\+Small} (const \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Packet\+Metadata\+::\+Small\+Item} $\ast$item)
\begin{DoxyCompactList}\small\item\em Add a \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Small\+Item}. \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{classns3_1_1PacketMetadata_ae89a0bf5e3dcd624bd37bc8ca67544da}{Add\+Big} (uint32\+\_\+t head, uint32\+\_\+t tail, const \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Packet\+Metadata\+::\+Small\+Item} $\ast$item, const \hyperlink{structns3_1_1PacketMetadata_1_1ExtraItem}{Packet\+Metadata\+::\+Extra\+Item} $\ast$extra\+Item)
\begin{DoxyCompactList}\small\item\em Add a \char`\"{}\+Big\char`\"{} \hyperlink{structns3_1_1PacketMetadata_1_1Item}{Item} (a \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Small\+Item} plus an \hyperlink{structns3_1_1PacketMetadata_1_1ExtraItem}{Extra\+Item}) \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_a0ad8fd1e4af8eaafca676b4cc3d9749b}{Replace\+Tail} (\hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Packet\+Metadata\+::\+Small\+Item} $\ast$item, \hyperlink{structns3_1_1PacketMetadata_1_1ExtraItem}{Packet\+Metadata\+::\+Extra\+Item} $\ast$extra\+Item, uint32\+\_\+t available)
\begin{DoxyCompactList}\small\item\em Replace the tail. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_a3baa0c324423e6fd600b31858aa4ade9}{Update\+Head} (uint16\+\_\+t written)
\begin{DoxyCompactList}\small\item\em Update the head. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_ad975bb9c1c0a6875ccc2309f071c5b55}{Update\+Tail} (uint16\+\_\+t written)
\begin{DoxyCompactList}\small\item\em Update the tail. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{Get\+Uleb128\+Size} (uint32\+\_\+t value) const 
\begin{DoxyCompactList}\small\item\em Get the U\+L\+E\+B128 (Unsigned Little Endian Base 128) size. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{classns3_1_1PacketMetadata_a7ae75db766a843dbee8960ae8cbf23ee}{Read\+Uleb128} (const uint8\+\_\+t $\ast$$\ast$p\+Buffer) const 
\begin{DoxyCompactList}\small\item\em Read a U\+L\+E\+B128 (Unsigned Little Endian Base 128) coded number. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (uint16\+\_\+t value, uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Append a 16-\/bit value to the buffer. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_a254b3766510c9b38a2ad0bec6d973f15}{Append32} (uint32\+\_\+t value, uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Append a 32-\/bit value to the buffer. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{Append\+Value} (uint32\+\_\+t value, uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Append a value to the buffer. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_a1cac4e4c0f975898b39dc0a8cd7fd4d0}{Append\+Value\+Extra} (uint32\+\_\+t value, uint8\+\_\+t $\ast$buffer)
\begin{DoxyCompactList}\small\item\em Append a value to the buffer -\/ extra. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_a6c58b1e40fee94cdae50c0bf6571bf85}{Reserve} (uint32\+\_\+t \hyperlink{lte__link__budget__x2__handover__measures_8m_abdb05bc5a064cf642a06c83b3392f148}{n})
\begin{DoxyCompactList}\small\item\em Reserve space. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_a18a4039a86f4c212742f6359849ddfd6}{Reserve\+Copy} (uint32\+\_\+t \hyperlink{lte__link__budget__x2__handover__measures_8m_abdb05bc5a064cf642a06c83b3392f148}{n})
\begin{DoxyCompactList}\small\item\em Reserve space and make a metadata copy. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{classns3_1_1PacketMetadata_abb9dbf67e16dd56f9ad8b2bc29bbeb3b}{Get\+Total\+Size} (void) const 
\begin{DoxyCompactList}\small\item\em Get the total size used by the metadata. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{Read\+Items} (uint16\+\_\+t current, struct \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Packet\+Metadata\+::\+Small\+Item} $\ast$item, struct \hyperlink{structns3_1_1PacketMetadata_1_1ExtraItem}{Packet\+Metadata\+::\+Extra\+Item} $\ast$extra\+Item) const 
\begin{DoxyCompactList}\small\item\em Read items. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1PacketMetadata_ae5ad09674e28733405c49b2655c51a5a}{Do\+Add\+Header} (uint32\+\_\+t uid, uint32\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Add an header. \end{DoxyCompactList}\item 
bool \hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{Is\+State\+Ok} (void) const 
\begin{DoxyCompactList}\small\item\em Check if the metadata state is ok. \end{DoxyCompactList}\item 
bool \hyperlink{classns3_1_1PacketMetadata_acf15fba7d020ebd77591619b5ad273c5}{Is\+Pointer\+Ok} (uint16\+\_\+t pointer) const 
\begin{DoxyCompactList}\small\item\em Check if the position is valid. \end{DoxyCompactList}\item 
bool \hyperlink{classns3_1_1PacketMetadata_ae62c5bb3dce611a0f8c5e9ba3ba8e26e}{Is\+Shared\+Pointer\+Ok} (uint16\+\_\+t pointer) const 
\begin{DoxyCompactList}\small\item\em Check if the position is valid. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static uint8\+\_\+t $\ast$ \hyperlink{classns3_1_1PacketMetadata_acf61c8b898fa059a3c3de4aa03c8c0c3}{Add\+To\+Raw\+U8} (const uint8\+\_\+t \&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, uint8\+\_\+t $\ast$start, uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)
\begin{DoxyCompactList}\small\item\em Helper for the raw serialization. \end{DoxyCompactList}\item 
static uint8\+\_\+t $\ast$ \hyperlink{classns3_1_1PacketMetadata_af48d704fec44aeedcfc257b6eb382e30}{Add\+To\+Raw\+U16} (const uint16\+\_\+t \&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, uint8\+\_\+t $\ast$start, uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)
\begin{DoxyCompactList}\small\item\em Helper for the raw serialization. \end{DoxyCompactList}\item 
static uint8\+\_\+t $\ast$ \hyperlink{classns3_1_1PacketMetadata_a5ae4821ac2aae1d62c02243cdd27572a}{Add\+To\+Raw\+U32} (const uint32\+\_\+t \&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, uint8\+\_\+t $\ast$start, uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)
\begin{DoxyCompactList}\small\item\em Helper for the raw serialization. \end{DoxyCompactList}\item 
static uint8\+\_\+t $\ast$ \hyperlink{classns3_1_1PacketMetadata_af872909b61feca47e71738b83a125b86}{Add\+To\+Raw\+U64} (const uint64\+\_\+t \&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, uint8\+\_\+t $\ast$start, uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)
\begin{DoxyCompactList}\small\item\em Helper for the raw serialization. \end{DoxyCompactList}\item 
static uint8\+\_\+t $\ast$ \hyperlink{classns3_1_1PacketMetadata_add5d8a1457ffc3eb6f3453c2ec924726}{Add\+To\+Raw} (const uint8\+\_\+t $\ast$\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, uint32\+\_\+t data\+Size, uint8\+\_\+t $\ast$start, uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)
\begin{DoxyCompactList}\small\item\em Helper for the raw serialization. \end{DoxyCompactList}\item 
static uint8\+\_\+t $\ast$ \hyperlink{classns3_1_1PacketMetadata_aeab158c490a41b3776aab0b26092ff50}{Read\+From\+Raw\+U8} (uint8\+\_\+t \&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, const uint8\+\_\+t $\ast$start, const uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)
\begin{DoxyCompactList}\small\item\em Helper for the raw deserialization. \end{DoxyCompactList}\item 
static uint8\+\_\+t $\ast$ \hyperlink{classns3_1_1PacketMetadata_a9466105641875317279a17991707e308}{Read\+From\+Raw\+U16} (uint16\+\_\+t \&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, const uint8\+\_\+t $\ast$start, const uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)
\begin{DoxyCompactList}\small\item\em Helper for the raw deserialization. \end{DoxyCompactList}\item 
static uint8\+\_\+t $\ast$ \hyperlink{classns3_1_1PacketMetadata_a5a055957d2f52aeee983871a358215a7}{Read\+From\+Raw\+U32} (uint32\+\_\+t \&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, const uint8\+\_\+t $\ast$start, const uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)
\begin{DoxyCompactList}\small\item\em Helper for the raw deserialization. \end{DoxyCompactList}\item 
static uint8\+\_\+t $\ast$ \hyperlink{classns3_1_1PacketMetadata_a069d077359e7d6dac6b575b12584a7ae}{Read\+From\+Raw\+U64} (uint64\+\_\+t \&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, const uint8\+\_\+t $\ast$start, const uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)
\begin{DoxyCompactList}\small\item\em Helper for the raw deserialization. \end{DoxyCompactList}\item 
static void \hyperlink{classns3_1_1PacketMetadata_ae4bff0e3145f955d12e75531b0be6b7f}{Recycle} (struct \hyperlink{structns3_1_1PacketMetadata_1_1Data}{Packet\+Metadata\+::\+Data} $\ast$\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data})
\begin{DoxyCompactList}\small\item\em Recycle the buffer memory. \end{DoxyCompactList}\item 
static struct \hyperlink{structns3_1_1PacketMetadata_1_1Data}{Packet\+Metadata\+::\+Data} $\ast$ \hyperlink{classns3_1_1PacketMetadata_a94be0cf01bdfdf5dda7ae0afc475dc2a}{Create} (uint32\+\_\+t size)
\begin{DoxyCompactList}\small\item\em Create a buffer data storage. \end{DoxyCompactList}\item 
static struct \hyperlink{structns3_1_1PacketMetadata_1_1Data}{Packet\+Metadata\+::\+Data} $\ast$ \hyperlink{classns3_1_1PacketMetadata_a5cb8aff27ae7a4b60c0bc1a743e1cc8a}{Allocate} (uint32\+\_\+t \hyperlink{lte__link__budget__x2__handover__measures_8m_abdb05bc5a064cf642a06c83b3392f148}{n})
\begin{DoxyCompactList}\small\item\em Allocate a buffer data storage. \end{DoxyCompactList}\item 
static void \hyperlink{classns3_1_1PacketMetadata_a5284ea0e3b7e0e272ca521cb976431b7}{Deallocate} (struct \hyperlink{structns3_1_1PacketMetadata_1_1Data}{Packet\+Metadata\+::\+Data} $\ast$\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data})
\begin{DoxyCompactList}\small\item\em Deallocate the buffer memory. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structns3_1_1PacketMetadata_1_1Data}{Data} $\ast$ \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\+\_\+data}
\begin{DoxyCompactList}\small\item\em Metadata storage. \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\+\_\+head}
\begin{DoxyCompactList}\small\item\em list head \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\+\_\+tail}
\begin{DoxyCompactList}\small\item\em list tail \end{DoxyCompactList}\item 
uint16\+\_\+t \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\+\_\+used}
\begin{DoxyCompactList}\small\item\em used portion \end{DoxyCompactList}\item 
uint64\+\_\+t \hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\+\_\+packet\+Uid}
\begin{DoxyCompactList}\small\item\em packet Uid \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Private Attributes}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classns3_1_1PacketMetadata_1_1DataFreeList}{Data\+Free\+List} \hyperlink{classns3_1_1PacketMetadata_aa646ed601542eec6bb98e6219165a7c8}{m\+\_\+free\+List}
\begin{DoxyCompactList}\small\item\em the metadata data storage \end{DoxyCompactList}\item 
static bool \hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\+\_\+enable} = \hyperlink{lte__cqi__generation_8m_ab1bef239d413c4da139c4bac92cd657a}{false}
\begin{DoxyCompactList}\small\item\em Enable the packet metadata. \end{DoxyCompactList}\item 
static bool \hyperlink{classns3_1_1PacketMetadata_a3b4333cb8df79817e7ca74de1a090d89}{m\+\_\+enable\+Checking} = \hyperlink{lte__cqi__generation_8m_ab1bef239d413c4da139c4bac92cd657a}{false}
\begin{DoxyCompactList}\small\item\em Enable the packet metadata checking. \end{DoxyCompactList}\item 
static bool \hyperlink{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{m\+\_\+metadata\+Skipped} = \hyperlink{lte__cqi__generation_8m_ab1bef239d413c4da139c4bac92cd657a}{false}
\item 
static uint32\+\_\+t \hyperlink{classns3_1_1PacketMetadata_a3816d0a0ab763831fd248b0b2693db1c}{m\+\_\+max\+Size} = 0
\begin{DoxyCompactList}\small\item\em maximum metadata size \end{DoxyCompactList}\item 
static uint16\+\_\+t \hyperlink{classns3_1_1PacketMetadata_a98e20e3da84be30e3ff4b1761f215cbd}{m\+\_\+chunk\+Uid} = 0
\begin{DoxyCompactList}\small\item\em \hyperlink{classns3_1_1Chunk}{Chunk} Uid. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classns3_1_1PacketMetadata_a32606143b9dd3fe0db01264200e27783}{Item\+Iterator}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Handle packet metadata about packet headers and trailers. 

This class is used by the \hyperlink{classns3_1_1Packet}{Packet} class to record every operation performed on the packet\textquotesingle{}s buffer. This class also provides an implementation of the \hyperlink{classns3_1_1Packet_aa34058a5cdbf94673531f8c4001ab227}{Packet\+::\+Print} methods which uses the metadata to analyse the content of the packet\textquotesingle{}s buffer.

To achieve this, this class maintains a linked list of so-\/called \char`\"{}items\char`\"{}, each of which represents a header or a trailer, or payload, or a fragment of any of these. Each item contains a \char`\"{}next\char`\"{} and a \char`\"{}prev\char`\"{} field which point to the next and previous entries in the linked list. The \hyperlink{classns3_1_1PacketMetadata}{Packet\+Metadata} class maintains a pair of pointers to the head and the tail of the linked list.

Each entry in the list also maintains\+:
\begin{DoxyItemize}
\item its native size (the size it had when it was first added to the packet)
\item its type\+: identifies what kind of header, what kind of trailer, if it is payload or not
\item the uid of the packet to which it was first added
\item the start and end of the area represented by a fragment if it is one.
\end{DoxyItemize}

This linked list is flattened in a byte buffer stored in struct \hyperlink{structns3_1_1PacketMetadata_1_1Data}{Packet\+Metadata\+::\+Data}. Each entry of the linked list is identified by an offset which identifies the first byte of the entry from the start of the data buffer. The size of this data buffer is 2$^\wedge$16-\/1 bytes maximum which somewhat limits the number of entries which can be stored in this linked list but it is quite unlikely to hit this limit in practice.

Each item of the linked list is a variable-\/sized byte buffer made of a number of fields. Some of these fields are stored as fixed-\/size 32 bit integers, others as fixed-\/size 16 bit integers, and some others as variable-\/size 32-\/bit integers. The variable-\/size 32 bit integers are stored using the uleb128 encoding. 

\subsection{Constructor \& Destructor Documentation}
\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Packet\+Metadata@{Packet\+Metadata}}
\index{Packet\+Metadata@{Packet\+Metadata}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Packet\+Metadata(uint64\+\_\+t uid, uint32\+\_\+t size)}{PacketMetadata(uint64_t uid, uint32_t size)}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Packet\+Metadata\+::\+Packet\+Metadata (
\begin{DoxyParamCaption}
\item[{uint64\+\_\+t}]{uid, }
\item[{uint32\+\_\+t}]{size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classns3_1_1PacketMetadata_a3c1a7bc063be52d90c9bdf7dbbcfeff7}{}\label{classns3_1_1PacketMetadata_a3c1a7bc063be52d90c9bdf7dbbcfeff7}


Constructor. 


\begin{DoxyParams}{Parameters}
{\em uid} & packet uid \\
\hline
{\em size} & size of the header \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
690   : \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} (\hyperlink{classns3_1_1PacketMetadata_a94be0cf01bdfdf5dda7ae0afc475dc2a}{PacketMetadata::Create} (10)),
691     \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} (0xffff),
692     \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} (0xffff),
693     \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} (0),
694     \hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\_packetUid} (uid)
695 \{
696   memset (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}, 0xff, 4);
697   \textcolor{keywordflow}{if} (size > 0)
698     \{
699       \hyperlink{classns3_1_1PacketMetadata_ae5ad09674e28733405c49b2655c51a5a}{DoAddHeader} (0, size);
700     \}
701 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 1


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Packet\+Metadata@{Packet\+Metadata}}
\index{Packet\+Metadata@{Packet\+Metadata}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Packet\+Metadata(\+Packet\+Metadata const \&o)}{PacketMetadata(PacketMetadata const &o)}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Packet\+Metadata\+::\+Packet\+Metadata (
\begin{DoxyParamCaption}
\item[{{\bf Packet\+Metadata} const \&}]{o}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classns3_1_1PacketMetadata_acc6ec4194d1858d85ffc8ccf68535a37}{}\label{classns3_1_1PacketMetadata_acc6ec4194d1858d85ffc8ccf68535a37}


Copy constructor. 


\begin{DoxyParams}{Parameters}
{\em o} & the object to copy \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
703   : \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} (o.m\_data),
704     \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} (o.m\_head),
705     \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} (o.m\_tail),
706     \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} (o.m\_used),
707     \hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\_packetUid} (o.m\_packetUid)
708 \{
709   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != 0);
710   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count} < 
      \hyperlink{80211b_8c_affe776513b24d84b39af8ab0930fef7f}{std::numeric\_limits<uint32\_t>::max}());
711   \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count}++;
712 \}
\end{DoxyCode}
\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!````~Packet\+Metadata@{$\sim$\+Packet\+Metadata}}
\index{````~Packet\+Metadata@{$\sim$\+Packet\+Metadata}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{$\sim$\+Packet\+Metadata()}{~PacketMetadata()}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Packet\+Metadata\+::$\sim$\+Packet\+Metadata (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classns3_1_1PacketMetadata_a3e5d8647a8dbf2d041e8275805b1692f}{}\label{classns3_1_1PacketMetadata_a3e5d8647a8dbf2d041e8275805b1692f}

\begin{DoxyCode}
736 \{
737   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != 0);
738   \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count}--;
739   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count} == 0) 
740     \{
741       \hyperlink{classns3_1_1PacketMetadata_ae4bff0e3145f955d12e75531b0be6b7f}{PacketMetadata::Recycle} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data});
742     \}
743 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Data\+Free\+List\+::````~Data\+Free\+List@{Data\+Free\+List\+::$\sim$\+Data\+Free\+List}}
\index{Data\+Free\+List\+::````~Data\+Free\+List@{Data\+Free\+List\+::$\sim$\+Data\+Free\+List}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Data\+Free\+List\+::$\sim$\+Data\+Free\+List()}{DataFreeList::~DataFreeList()}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ns3\+::\+Packet\+Metadata\+::\+Data\+Free\+List\+::$\sim$\+Data\+Free\+List} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a343187327aa7336b54e71cc3b1df881d}{}\label{classns3_1_1PacketMetadata_a343187327aa7336b54e71cc3b1df881d}
\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Packet\+Metadata@{Packet\+Metadata}}
\index{Packet\+Metadata@{Packet\+Metadata}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Packet\+Metadata()}{PacketMetadata()}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Packet\+Metadata\+::\+Packet\+Metadata (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a78447d800a9c3b6c85a3f38a09682b00}{}\label{classns3_1_1PacketMetadata_a78447d800a9c3b6c85a3f38a09682b00}


\subsection{Member Function Documentation}
\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+At\+End@{Add\+At\+End}}
\index{Add\+At\+End@{Add\+At\+End}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+At\+End(\+Packet\+Metadata const \&o)}{AddAtEnd(PacketMetadata const &o)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Add\+At\+End (
\begin{DoxyParamCaption}
\item[{{\bf Packet\+Metadata} const \&}]{o}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1PacketMetadata_af7ceb1a4a7ded625c85dbd477b5fc8b6}{}\label{classns3_1_1PacketMetadata_af7ceb1a4a7ded625c85dbd477b5fc8b6}


Add a metadata at the metadata start. 


\begin{DoxyParams}{Parameters}
{\em o} & the metadata to add \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
802 \{
803   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << &o);
804   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
805   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable}) 
806     \{
807       \hyperlink{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{m\_metadataSkipped} = \textcolor{keyword}{true};
808       \textcolor{keywordflow}{return};
809     \}
810   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} == 0xffff)
811     \{
812       \textcolor{comment}{// We have no items so 'AddAtEnd' is }
813       \textcolor{comment}{// equivalent to self-assignment.}
814       *\textcolor{keyword}{this} = o;
815       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
816       \textcolor{keywordflow}{return};
817     \}
818   \textcolor{keywordflow}{if} (o.m\_head == 0xffff)
819     \{
820       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (o.m\_tail == 0xffff);
821       \textcolor{comment}{// we have nothing to append.}
822       \textcolor{keywordflow}{return};
823     \}
824   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} != 0xffff && \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} != 0xffff);
825 
826   \textcolor{comment}{// We read the current tail because we are going to append}
827   \textcolor{comment}{// after this item.}
828   \textcolor{keyword}{struct }PacketMetadata::SmallItem tailItem;
829   PacketMetadata::ExtraItem tailExtraItem;
830   uint32\_t tailSize = \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail}, &tailItem, &tailExtraItem);
831 
832   uint16\_t current;
833   \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
834   PacketMetadata::ExtraItem extraItem;
835   o.ReadItems (o.m\_head, &item, &extraItem);
836   \textcolor{keywordflow}{if} (extraItem.packetUid == tailExtraItem.packetUid &&
837       item.typeUid == tailItem.typeUid &&
838       item.chunkUid == tailItem.chunkUid &&
839       item.size == tailItem.size &&
840       extraItem.fragmentStart == tailExtraItem.fragmentEnd)
841     \{
842       \textcolor{comment}{/* If the previous tail came from the same header as}
843 \textcolor{comment}{       * the next item we want to append to our array, then, }
844 \textcolor{comment}{       * we merge them and attempt to reuse the previous tail's}
845 \textcolor{comment}{       * location.}
846 \textcolor{comment}{       */}
847       tailExtraItem.fragmentEnd = extraItem.fragmentEnd;
848       \hyperlink{classns3_1_1PacketMetadata_a0ad8fd1e4af8eaafca676b4cc3d9749b}{ReplaceTail} (&tailItem, &tailExtraItem, tailSize);
849       \textcolor{keywordflow}{if} (o.m\_head == o.m\_tail)
850         \{
851           \textcolor{comment}{// there is only one item to append to self from other.}
852           \textcolor{keywordflow}{return};
853         \}
854       current = item.next;
855     \}
856   \textcolor{keywordflow}{else}
857     \{
858       current = o.m\_head;
859     \}
860 
861   \textcolor{comment}{/* Now that we have merged our current tail with the head of the}
862 \textcolor{comment}{   * next packet, we just append all items from the next packet}
863 \textcolor{comment}{   * to the current packet.}
864 \textcolor{comment}{   */}
865   \textcolor{keywordflow}{while} (current != 0xffff)
866     \{
867       o.ReadItems (current, &item, &extraItem);
868       uint16\_t written = \hyperlink{classns3_1_1PacketMetadata_ae89a0bf5e3dcd624bd37bc8ca67544da}{AddBig} (0xffff, \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail}, &item, &extraItem);
869       \hyperlink{classns3_1_1PacketMetadata_ad975bb9c1c0a6875ccc2309f071c5b55}{UpdateTail} (written);
870       \textcolor{keywordflow}{if} (current == o.m\_tail)
871         \{
872           \textcolor{keywordflow}{break};
873         \}
874       current = item.next;
875     \}
876   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
877 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 3




Here is the caller graph for this function\+:
% FIG 4


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+Big@{Add\+Big}}
\index{Add\+Big@{Add\+Big}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+Big(uint32\+\_\+t head, uint32\+\_\+t tail, const Packet\+Metadata\+::\+Small\+Item $\ast$item, const Packet\+Metadata\+::\+Extra\+Item $\ast$extra\+Item)}{AddBig(uint32_t head, uint32_t tail, const PacketMetadata::SmallItem *item, const PacketMetadata::ExtraItem *extraItem)}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t ns3\+::\+Packet\+Metadata\+::\+Add\+Big (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{head, }
\item[{uint32\+\_\+t}]{tail, }
\item[{const {\bf Packet\+Metadata\+::\+Small\+Item} $\ast$}]{item, }
\item[{const {\bf Packet\+Metadata\+::\+Extra\+Item} $\ast$}]{extra\+Item}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_ae89a0bf5e3dcd624bd37bc8ca67544da}{}\label{classns3_1_1PacketMetadata_ae89a0bf5e3dcd624bd37bc8ca67544da}


Add a \char`\"{}\+Big\char`\"{} \hyperlink{structns3_1_1PacketMetadata_1_1Item}{Item} (a \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Small\+Item} plus an \hyperlink{structns3_1_1PacketMetadata_1_1ExtraItem}{Extra\+Item}) 


\begin{DoxyParams}{Parameters}
{\em head} & the head \\
\hline
{\em tail} & the tail \\
\hline
{\em item} & the \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Small\+Item} to add \\
\hline
{\em extra\+Item} & the \hyperlink{structns3_1_1PacketMetadata_1_1ExtraItem}{Extra\+Item} to add \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
added size 
\end{DoxyReturn}

\begin{DoxyCode}
406 \{
407   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << next << prev <<
408                    item->next << item->prev << item->typeUid << item->size << item->chunkUid <<
409                    extraItem->fragmentStart << extraItem->fragmentEnd << extraItem->packetUid);
410   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != 0);
411   uint32\_t typeUid = ((item->typeUid & 0x1) == 0x1) ? item->typeUid : item->typeUid+1;
412   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} != prev && \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} != next);
413 
414   uint32\_t typeUidSize = \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{GetUleb128Size} (typeUid);
415   uint32\_t sizeSize = \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{GetUleb128Size} (item->size);
416   uint32\_t fragStartSize = \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{GetUleb128Size} (extraItem->fragmentStart);
417   uint32\_t fragEndSize = \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{GetUleb128Size} (extraItem->fragmentEnd);
418   uint32\_t \hyperlink{namespacesample-rng-plot_aeb5ee5c431e338ef39b7ac5431242e1d}{n} = 2 + 2 + typeUidSize + sizeSize + 2 + fragStartSize + fragEndSize + 4;
419 
420   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} + n > \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a1064e5617aec301dd4f28fb86c105848}{m\_size} ||
421       (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} != 0xffff &&
422        \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count} != 1 &&
423        \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} != \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ae98316cc438fb40663c2f848746d8935}{m\_dirtyEnd}))
424     \{
425       \hyperlink{classns3_1_1PacketMetadata_a18a4039a86f4c212742f6359849ddfd6}{ReserveCopy} (n);
426     \}
427 
428   uint8\_t *buffer = &\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}[\hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used}];
429 
430   \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (next, buffer);
431   buffer += 2;
432   \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (prev, buffer);
433   buffer += 2;
434   \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{AppendValue} (typeUid, buffer);
435   buffer += typeUidSize;
436   \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{AppendValue} (item->size, buffer);
437   buffer += sizeSize;
438   \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (item->chunkUid, buffer);
439   buffer += 2;
440   \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{AppendValue} (extraItem->fragmentStart, buffer);
441   buffer += fragStartSize;
442   \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{AppendValue} (extraItem->fragmentEnd, buffer);
443   buffer += fragEndSize;
444   \hyperlink{classns3_1_1PacketMetadata_a254b3766510c9b38a2ad0bec6d973f15}{Append32} (extraItem->packetUid, buffer);
445 
446   \textcolor{keywordflow}{return} \hyperlink{namespacesample-rng-plot_aeb5ee5c431e338ef39b7ac5431242e1d}{n};
447 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 5




Here is the caller graph for this function\+:
% FIG 6


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+Header@{Add\+Header}}
\index{Add\+Header@{Add\+Header}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+Header(\+Header const \&header, uint32\+\_\+t size)}{AddHeader(Header const &header, uint32_t size)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Add\+Header (
\begin{DoxyParamCaption}
\item[{{\bf Header} const \&}]{header, }
\item[{uint32\+\_\+t}]{size}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1PacketMetadata_abdce736c4c5f647242f0808c0d2f9249}{}\label{classns3_1_1PacketMetadata_abdce736c4c5f647242f0808c0d2f9249}


Add an header. 


\begin{DoxyParams}{Parameters}
{\em header} & header to add \\
\hline
{\em size} & header serialized size \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
655 \{
656   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << &header << size);
657   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
658   uint32\_t uid = header.GetInstanceTypeId ().GetUid () << 1;
659   \hyperlink{classns3_1_1PacketMetadata_ae5ad09674e28733405c49b2655c51a5a}{DoAddHeader} (uid, size);
660   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
661 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 7




Here is the caller graph for this function\+:
% FIG 8


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+Padding\+At\+End@{Add\+Padding\+At\+End}}
\index{Add\+Padding\+At\+End@{Add\+Padding\+At\+End}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+Padding\+At\+End(uint32\+\_\+t end)}{AddPaddingAtEnd(uint32_t end)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Add\+Padding\+At\+End (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{end}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1PacketMetadata_a9398445226b4df97e2d489cf0a431ace}{}\label{classns3_1_1PacketMetadata_a9398445226b4df97e2d489cf0a431ace}


Add some padding at the end. 


\begin{DoxyParams}{Parameters}
{\em end} & size of padding \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
880 \{
881   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << end);
882   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable})
883     \{
884       \hyperlink{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{m\_metadataSkipped} = \textcolor{keyword}{true};
885       \textcolor{keywordflow}{return};
886     \}
887 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 9


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+Small@{Add\+Small}}
\index{Add\+Small@{Add\+Small}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+Small(const Packet\+Metadata\+::\+Small\+Item $\ast$item)}{AddSmall(const PacketMetadata::SmallItem *item)}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t ns3\+::\+Packet\+Metadata\+::\+Add\+Small (
\begin{DoxyParamCaption}
\item[{const {\bf Packet\+Metadata\+::\+Small\+Item} $\ast$}]{item}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a9d74d684e6a7448a6790220c6c8e99f2}{}\label{classns3_1_1PacketMetadata_a9d74d684e6a7448a6790220c6c8e99f2}


Add a \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Small\+Item}. 


\begin{DoxyParams}{Parameters}
{\em item} & the \hyperlink{structns3_1_1PacketMetadata_1_1SmallItem}{Small\+Item} to add \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
added size 
\end{DoxyReturn}

\begin{DoxyCode}
375 \{
376   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << item->next << item->prev << item->typeUid << item->size << item->
      chunkUid);
377   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != 0);
378   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} != item->prev && \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} != item->next);
379   uint32\_t typeUidSize = \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{GetUleb128Size} (item->typeUid);
380   uint32\_t sizeSize = \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{GetUleb128Size} (item->size);
381   uint32\_t \hyperlink{namespacesample-rng-plot_aeb5ee5c431e338ef39b7ac5431242e1d}{n} =  2 + 2 + typeUidSize + sizeSize + 2;
382   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} + n > \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a1064e5617aec301dd4f28fb86c105848}{m\_size} ||
383       (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} != 0xffff &&
384        \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count} != 1 &&
385        \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} != \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ae98316cc438fb40663c2f848746d8935}{m\_dirtyEnd}))
386     \{
387       \hyperlink{classns3_1_1PacketMetadata_a18a4039a86f4c212742f6359849ddfd6}{ReserveCopy} (n);
388     \}
389   uint8\_t *buffer = &\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}[\hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used}];
390   \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (item->next, buffer);
391   buffer += 2;
392   \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (item->prev, buffer);
393   buffer += 2;
394   \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{AppendValue} (item->typeUid, buffer);
395   buffer += typeUidSize;
396   \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{AppendValue} (item->size, buffer);
397   buffer += sizeSize;
398   \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (item->chunkUid, buffer);
399   \textcolor{keywordflow}{return} \hyperlink{namespacesample-rng-plot_aeb5ee5c431e338ef39b7ac5431242e1d}{n};
400 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 10




Here is the caller graph for this function\+:
% FIG 11


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+To\+Raw@{Add\+To\+Raw}}
\index{Add\+To\+Raw@{Add\+To\+Raw}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+To\+Raw(const uint8\+\_\+t $\ast$data, uint32\+\_\+t data\+Size, uint8\+\_\+t $\ast$start, uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)}{AddToRaw(const uint8_t *data, uint32_t dataSize, uint8_t *start, uint8_t *current, uint32_t maxSize)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t $\ast$ ns3\+::\+Packet\+Metadata\+::\+Add\+To\+Raw (
\begin{DoxyParamCaption}
\item[{const uint8\+\_\+t $\ast$}]{data, }
\item[{uint32\+\_\+t}]{data\+Size, }
\item[{uint8\+\_\+t $\ast$}]{start, }
\item[{uint8\+\_\+t $\ast$}]{current, }
\item[{uint32\+\_\+t}]{max\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_add5d8a1457ffc3eb6f3453c2ec924726}{}\label{classns3_1_1PacketMetadata_add5d8a1457ffc3eb6f3453c2ec924726}


Helper for the raw serialization. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer to write to \\
\hline
{\em data\+Size} & the data size to write to \\
\hline
{\em start} & start index \\
\hline
{\em current} & current index \\
\hline
{\em max\+Size} & maximum size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
updated current index 
\end{DoxyReturn}

\begin{DoxyCode}
1409 \{ 
1410   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data} << dataSize << &\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} << &current << maxSize);
1411   \textcolor{comment}{// First check buffer overflow}
1412   \textcolor{keywordflow}{if} (static\_cast<uint32\_t> ((current + dataSize - \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start})) > maxSize) 
1413     \{
1414       \textcolor{keywordflow}{return} 0;
1415     \}
1416   memcpy (current, \hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, dataSize);
1417   \textcolor{keywordflow}{return} current + dataSize;
1418 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 12


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+To\+Raw\+U16@{Add\+To\+Raw\+U16}}
\index{Add\+To\+Raw\+U16@{Add\+To\+Raw\+U16}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+To\+Raw\+U16(const uint16\+\_\+t \&data, uint8\+\_\+t $\ast$start, uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)}{AddToRawU16(const uint16_t &data, uint8_t *start, uint8_t *current, uint32_t maxSize)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t $\ast$ ns3\+::\+Packet\+Metadata\+::\+Add\+To\+Raw\+U16 (
\begin{DoxyParamCaption}
\item[{const uint16\+\_\+t \&}]{data, }
\item[{uint8\+\_\+t $\ast$}]{start, }
\item[{uint8\+\_\+t $\ast$}]{current, }
\item[{uint32\+\_\+t}]{max\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_af48d704fec44aeedcfc257b6eb382e30}{}\label{classns3_1_1PacketMetadata_af48d704fec44aeedcfc257b6eb382e30}


Helper for the raw serialization. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer to write to \\
\hline
{\em start} & start index \\
\hline
{\em current} & current index \\
\hline
{\em max\+Size} & maximum size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
updated current index 
\end{DoxyReturn}

\begin{DoxyCode}
1360 \{
1361   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data} << &\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} << &current << maxSize);
1362   \textcolor{comment}{// First check buffer overflow}
1363   \textcolor{keywordflow}{if} (static\_cast<uint32\_t> ((current + \textcolor{keyword}{sizeof} (uint16\_t) - \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start})) > maxSize) 
1364     \{
1365       \textcolor{keywordflow}{return} 0;
1366     \}
1367   memcpy (current, &\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, \textcolor{keyword}{sizeof} (uint16\_t));
1368   \textcolor{keywordflow}{return} current + \textcolor{keyword}{sizeof} (uint16\_t);
1369 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 13


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+To\+Raw\+U32@{Add\+To\+Raw\+U32}}
\index{Add\+To\+Raw\+U32@{Add\+To\+Raw\+U32}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+To\+Raw\+U32(const uint32\+\_\+t \&data, uint8\+\_\+t $\ast$start, uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)}{AddToRawU32(const uint32_t &data, uint8_t *start, uint8_t *current, uint32_t maxSize)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t $\ast$ ns3\+::\+Packet\+Metadata\+::\+Add\+To\+Raw\+U32 (
\begin{DoxyParamCaption}
\item[{const uint32\+\_\+t \&}]{data, }
\item[{uint8\+\_\+t $\ast$}]{start, }
\item[{uint8\+\_\+t $\ast$}]{current, }
\item[{uint32\+\_\+t}]{max\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a5ae4821ac2aae1d62c02243cdd27572a}{}\label{classns3_1_1PacketMetadata_a5ae4821ac2aae1d62c02243cdd27572a}


Helper for the raw serialization. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer to write to \\
\hline
{\em start} & start index \\
\hline
{\em current} & current index \\
\hline
{\em max\+Size} & maximum size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
updated current index 
\end{DoxyReturn}

\begin{DoxyCode}
1376 \{
1377   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data} << &\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} << &current << maxSize);
1378   \textcolor{comment}{// First check buffer overflow}
1379   \textcolor{keywordflow}{if} (static\_cast<uint32\_t> ((current + \textcolor{keyword}{sizeof} (uint32\_t) - \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start})) > maxSize) 
1380     \{
1381       \textcolor{keywordflow}{return} 0;
1382     \}
1383   memcpy (current, &\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, \textcolor{keyword}{sizeof} (uint32\_t));
1384   \textcolor{keywordflow}{return} current + \textcolor{keyword}{sizeof} (uint32\_t);
1385 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 14


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+To\+Raw\+U64@{Add\+To\+Raw\+U64}}
\index{Add\+To\+Raw\+U64@{Add\+To\+Raw\+U64}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+To\+Raw\+U64(const uint64\+\_\+t \&data, uint8\+\_\+t $\ast$start, uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)}{AddToRawU64(const uint64_t &data, uint8_t *start, uint8_t *current, uint32_t maxSize)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t $\ast$ ns3\+::\+Packet\+Metadata\+::\+Add\+To\+Raw\+U64 (
\begin{DoxyParamCaption}
\item[{const uint64\+\_\+t \&}]{data, }
\item[{uint8\+\_\+t $\ast$}]{start, }
\item[{uint8\+\_\+t $\ast$}]{current, }
\item[{uint32\+\_\+t}]{max\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_af872909b61feca47e71738b83a125b86}{}\label{classns3_1_1PacketMetadata_af872909b61feca47e71738b83a125b86}


Helper for the raw serialization. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer to write to \\
\hline
{\em start} & start index \\
\hline
{\em current} & current index \\
\hline
{\em max\+Size} & maximum size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
updated current index 
\end{DoxyReturn}

\begin{DoxyCode}
1392 \{
1393   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data} << &\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} << &current << maxSize);
1394   \textcolor{comment}{// First check buffer overflow}
1395   \textcolor{keywordflow}{if} (static\_cast<uint32\_t> ((current + \textcolor{keyword}{sizeof} (uint64\_t) - \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start})) > maxSize) 
1396     \{
1397       \textcolor{keywordflow}{return} 0;
1398     \}
1399   memcpy (current, &\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, \textcolor{keyword}{sizeof} (uint64\_t));
1400   \textcolor{keywordflow}{return} current + \textcolor{keyword}{sizeof} (uint64\_t);
1401 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 15


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+To\+Raw\+U8@{Add\+To\+Raw\+U8}}
\index{Add\+To\+Raw\+U8@{Add\+To\+Raw\+U8}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+To\+Raw\+U8(const uint8\+\_\+t \&data, uint8\+\_\+t $\ast$start, uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)}{AddToRawU8(const uint8_t &data, uint8_t *start, uint8_t *current, uint32_t maxSize)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t $\ast$ ns3\+::\+Packet\+Metadata\+::\+Add\+To\+Raw\+U8 (
\begin{DoxyParamCaption}
\item[{const uint8\+\_\+t \&}]{data, }
\item[{uint8\+\_\+t $\ast$}]{start, }
\item[{uint8\+\_\+t $\ast$}]{current, }
\item[{uint32\+\_\+t}]{max\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_acf61c8b898fa059a3c3de4aa03c8c0c3}{}\label{classns3_1_1PacketMetadata_acf61c8b898fa059a3c3de4aa03c8c0c3}


Helper for the raw serialization. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer to write to \\
\hline
{\em start} & start index \\
\hline
{\em current} & current index \\
\hline
{\em max\+Size} & maximum size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
updated current index 
\end{DoxyReturn}

\begin{DoxyCode}
1344 \{
1345   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (static\_cast<uint32\_t> (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}) << &\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} << &current << maxSize);
1346   \textcolor{comment}{// First check buffer overflow}
1347   \textcolor{keywordflow}{if} (static\_cast<uint32\_t> ((current + \textcolor{keyword}{sizeof} (uint8\_t) - \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start})) > maxSize) 
1348     \{
1349       \textcolor{keywordflow}{return} 0;
1350     \}
1351   memcpy (current, &\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, \textcolor{keyword}{sizeof} (uint8\_t));
1352   \textcolor{keywordflow}{return} current + \textcolor{keyword}{sizeof} (uint8\_t);
1353 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 16


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Add\+Trailer@{Add\+Trailer}}
\index{Add\+Trailer@{Add\+Trailer}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Add\+Trailer(\+Trailer const \&trailer, uint32\+\_\+t size)}{AddTrailer(Trailer const &trailer, uint32_t size)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Add\+Trailer (
\begin{DoxyParamCaption}
\item[{{\bf Trailer} const \&}]{trailer, }
\item[{uint32\+\_\+t}]{size}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1PacketMetadata_afd698b5f0ce0e9f498fff8a6915837c5}{}\label{classns3_1_1PacketMetadata_afd698b5f0ce0e9f498fff8a6915837c5}
Add a trailer 
\begin{DoxyParams}{Parameters}
{\em trailer} & trailer to add \\
\hline
{\em size} & trailer serialized size \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
732 \{
733   uint32\_t uid = trailer.GetInstanceTypeId ().GetUid () << 1;
734   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << &trailer << size);
735   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
736   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable})
737     \{
738       \hyperlink{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{m\_metadataSkipped} = \textcolor{keyword}{true};
739       \textcolor{keywordflow}{return};
740     \}
741   \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
742   item.next = 0xffff;
743   item.prev = \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail};
744   item.typeUid = uid;
745   item.size = size;
746   item.chunkUid = \hyperlink{classns3_1_1PacketMetadata_a98e20e3da84be30e3ff4b1761f215cbd}{m\_chunkUid};
747   \hyperlink{classns3_1_1PacketMetadata_a98e20e3da84be30e3ff4b1761f215cbd}{m\_chunkUid}++;
748   uint16\_t written = \hyperlink{classns3_1_1PacketMetadata_a9d74d684e6a7448a6790220c6c8e99f2}{AddSmall} (&item);
749   \hyperlink{classns3_1_1PacketMetadata_ad975bb9c1c0a6875ccc2309f071c5b55}{UpdateTail} (written);
750   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
751 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 17




Here is the caller graph for this function\+:
% FIG 18


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Allocate@{Allocate}}
\index{Allocate@{Allocate}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Allocate(uint32\+\_\+t n)}{Allocate(uint32_t n)}}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf Packet\+Metadata\+::\+Data} $\ast$ ns3\+::\+Packet\+Metadata\+::\+Allocate (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{n}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a5cb8aff27ae7a4b60c0bc1a743e1cc8a}{}\label{classns3_1_1PacketMetadata_a5cb8aff27ae7a4b60c0bc1a743e1cc8a}


Allocate a buffer data storage. 


\begin{DoxyParams}{Parameters}
{\em n} & the storage size to create \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a pointer to the allocated buffer storage 
\end{DoxyReturn}

\begin{DoxyCode}
619 \{
620   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\hyperlink{namespacesample-rng-plot_aeb5ee5c431e338ef39b7ac5431242e1d}{n});
621   uint32\_t size = \textcolor{keyword}{sizeof} (\textcolor{keyword}{struct }Data);
622   \textcolor{keywordflow}{if} (\hyperlink{namespacesample-rng-plot_aeb5ee5c431e338ef39b7ac5431242e1d}{n} <= \hyperlink{packet-metadata_8h_a6e9dfb20738a271bc45a4c2929a9a500}{PACKET\_METADATA\_DATA\_M\_DATA\_SIZE})
623     \{
624       \hyperlink{namespacesample-rng-plot_aeb5ee5c431e338ef39b7ac5431242e1d}{n} = \hyperlink{packet-metadata_8h_a6e9dfb20738a271bc45a4c2929a9a500}{PACKET\_METADATA\_DATA\_M\_DATA\_SIZE};
625     \}
626   size += \hyperlink{namespacesample-rng-plot_aeb5ee5c431e338ef39b7ac5431242e1d}{n} - \hyperlink{packet-metadata_8h_a6e9dfb20738a271bc45a4c2929a9a500}{PACKET\_METADATA\_DATA\_M\_DATA\_SIZE};
627   uint8\_t *buf = \textcolor{keyword}{new} uint8\_t [size];
628   \textcolor{keyword}{struct }PacketMetadata::Data *\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data} = (\textcolor{keyword}{struct }PacketMetadata::Data *)buf;
629   data->m\_size = \hyperlink{namespacesample-rng-plot_aeb5ee5c431e338ef39b7ac5431242e1d}{n};
630   data->m\_count = 1;
631   data->m\_dirtyEnd = 0;
632   \textcolor{keywordflow}{return} \hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data};
633 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 19


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Append16@{Append16}}
\index{Append16@{Append16}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Append16(uint16\+\_\+t value, uint8\+\_\+t $\ast$buffer)}{Append16(uint16_t value, uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Append16 (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{value, }
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{}\label{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}


Append a 16-\/bit value to the buffer. 


\begin{DoxyParams}{Parameters}
{\em value} & the value to add \\
\hline
{\em buffer} & the buffer to write to \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
238 \{
239   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << value << &buffer);
240   buffer[0] = value & 0xff;
241   value >>= 8;
242   buffer[1] = value;
243 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 20


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Append32@{Append32}}
\index{Append32@{Append32}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Append32(uint32\+\_\+t value, uint8\+\_\+t $\ast$buffer)}{Append32(uint32_t value, uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Append32 (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{value, }
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a254b3766510c9b38a2ad0bec6d973f15}{}\label{classns3_1_1PacketMetadata_a254b3766510c9b38a2ad0bec6d973f15}


Append a 32-\/bit value to the buffer. 


\begin{DoxyParams}{Parameters}
{\em value} & the value to add \\
\hline
{\em buffer} & the buffer to write to \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
246 \{
247   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << value << &buffer);
248   buffer[0] = value & 0xff;
249   buffer[1] = (value >> 8) & 0xff;
250   buffer[2] = (value >> 16) & 0xff;
251   buffer[3] = (value >> 24) & 0xff;
252 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 21


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Append\+Value@{Append\+Value}}
\index{Append\+Value@{Append\+Value}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Append\+Value(uint32\+\_\+t value, uint8\+\_\+t $\ast$buffer)}{AppendValue(uint32_t value, uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Append\+Value (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{value, }
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{}\label{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}


Append a value to the buffer. 


\begin{DoxyParams}{Parameters}
{\em value} & the value to add \\
\hline
{\em buffer} & the buffer to write to \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
302 \{
303   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << value << &buffer);
304   \textcolor{keywordflow}{if} (value < 0x80)
305     \{
306       buffer[0] = value;
307       \textcolor{keywordflow}{return};
308     \}
309   \textcolor{keywordflow}{if} (value < 0x4000)
310     \{
311       uint8\_t byte = value & (~0x80);
312       buffer[0] = 0x80 | byte;
313       value >>= 7;
314       buffer[1] = value;
315       \textcolor{keywordflow}{return};
316     \}
317   \hyperlink{classns3_1_1PacketMetadata_a1cac4e4c0f975898b39dc0a8cd7fd4d0}{AppendValueExtra} (value, buffer);
318 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 22




Here is the caller graph for this function\+:
% FIG 23


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Append\+Value\+Extra@{Append\+Value\+Extra}}
\index{Append\+Value\+Extra@{Append\+Value\+Extra}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Append\+Value\+Extra(uint32\+\_\+t value, uint8\+\_\+t $\ast$buffer)}{AppendValueExtra(uint32_t value, uint8_t *buffer)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Append\+Value\+Extra (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{value, }
\item[{uint8\+\_\+t $\ast$}]{buffer}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a1cac4e4c0f975898b39dc0a8cd7fd4d0}{}\label{classns3_1_1PacketMetadata_a1cac4e4c0f975898b39dc0a8cd7fd4d0}


Append a value to the buffer -\/ extra. 

This function is called by Append\+Value


\begin{DoxyParams}{Parameters}
{\em value} & the value to add \\
\hline
{\em buffer} & the buffer to write to \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
256 \{
257   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << value << &buffer);
258   \textcolor{keywordflow}{if} (value < 0x200000)
259     \{
260       uint8\_t byte = value & (~0x80);
261       buffer[0] = 0x80 | byte;
262       value >>= 7;
263       byte = value & (~0x80);
264       buffer[1] = 0x80 | byte;
265       value >>= 7;
266       buffer[2] = value;
267       \textcolor{keywordflow}{return};
268     \}
269   \textcolor{keywordflow}{if} (value < 0x10000000)
270     \{
271       uint8\_t byte = value & (~0x80);
272       buffer[0] = 0x80 | byte;
273       value >>= 7;
274       byte = value & (~0x80);
275       buffer[1] = 0x80 | byte;
276       value >>= 7;
277       byte = value & (~0x80);
278       buffer[2] = 0x80 | byte;
279       value >>= 7;
280       buffer[3] = value;
281       \textcolor{keywordflow}{return};
282     \}
283   \{
284     uint8\_t byte = value & (~0x80);
285     buffer[0] = 0x80 | byte;
286     value >>= 7;
287     byte = value & (~0x80);
288     buffer[1] = 0x80 | byte;
289     value >>= 7;
290     byte = value & (~0x80);
291     buffer[2] = 0x80 | byte;
292     value >>= 7;
293     byte = value & (~0x80);
294     buffer[3] = 0x80 | byte;
295     value >>= 7;
296     buffer[4] = value;
297   \}
298 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 24


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Begin\+Item@{Begin\+Item}}
\index{Begin\+Item@{Begin\+Item}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Begin\+Item(\+Buffer buffer) const }{BeginItem(Buffer buffer) const }}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Packet\+Metadata\+::\+Item\+Iterator} ns3\+::\+Packet\+Metadata\+::\+Begin\+Item (
\begin{DoxyParamCaption}
\item[{{\bf Buffer}}]{buffer}
\end{DoxyParamCaption}
) const}\hypertarget{classns3_1_1PacketMetadata_aa574c0500da92d42d3cb53ae8a9fd0ad}{}\label{classns3_1_1PacketMetadata_aa574c0500da92d42d3cb53ae8a9fd0ad}


Initialize the item iterator to the buffer begin. 


\begin{DoxyCode}
1047 \{
1048   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << &buffer);
1049   \textcolor{keywordflow}{return} \hyperlink{classns3_1_1PacketMetadata_a32606143b9dd3fe0db01264200e27783}{ItemIterator} (\textcolor{keyword}{this}, buffer);
1050 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 25


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Create@{Create}}
\index{Create@{Create}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Create(uint32\+\_\+t size)}{Create(uint32_t size)}}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf Packet\+Metadata\+::\+Data} $\ast$ ns3\+::\+Packet\+Metadata\+::\+Create (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a94be0cf01bdfdf5dda7ae0afc475dc2a}{}\label{classns3_1_1PacketMetadata_a94be0cf01bdfdf5dda7ae0afc475dc2a}


Create a buffer data storage. 


\begin{DoxyParams}{Parameters}
{\em size} & the storage size to create \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a pointer to the created buffer storage 
\end{DoxyReturn}

\begin{DoxyCode}
571 \{
572   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (size);
573   \hyperlink{group__logging_ga88acd260151caf2db9c0fc84997f45ce}{NS\_LOG\_LOGIC} (\textcolor{stringliteral}{"create size="}<<size<<\textcolor{stringliteral}{", max="}<<\hyperlink{classns3_1_1PacketMetadata_a3816d0a0ab763831fd248b0b2693db1c}{m\_maxSize});
574   \textcolor{keywordflow}{if} (size > \hyperlink{classns3_1_1PacketMetadata_a3816d0a0ab763831fd248b0b2693db1c}{m\_maxSize})
575     \{
576       \hyperlink{classns3_1_1PacketMetadata_a3816d0a0ab763831fd248b0b2693db1c}{m\_maxSize} = size;
577     \}
578   \textcolor{keywordflow}{while} (!\hyperlink{classns3_1_1PacketMetadata_aa646ed601542eec6bb98e6219165a7c8}{m\_freeList}.empty ()) 
579     \{
580       \textcolor{keyword}{struct }PacketMetadata::Data *\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data} = \hyperlink{classns3_1_1PacketMetadata_aa646ed601542eec6bb98e6219165a7c8}{m\_freeList}.back ();
581       \hyperlink{classns3_1_1PacketMetadata_aa646ed601542eec6bb98e6219165a7c8}{m\_freeList}.pop\_back ();
582       \textcolor{keywordflow}{if} (data->m\_size >= size) 
583         \{
584           \hyperlink{group__logging_ga88acd260151caf2db9c0fc84997f45ce}{NS\_LOG\_LOGIC} (\textcolor{stringliteral}{"create found size="}<<data->m\_size);
585           data->m\_count = 1;
586           \textcolor{keywordflow}{return} \hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data};
587         \}
588       \hyperlink{group__logging_ga88acd260151caf2db9c0fc84997f45ce}{NS\_LOG\_LOGIC} (\textcolor{stringliteral}{"create dealloc size="}<<data->m\_size);
589       \hyperlink{classns3_1_1PacketMetadata_a5284ea0e3b7e0e272ca521cb976431b7}{PacketMetadata::Deallocate} (data);
590     \}
591   \hyperlink{group__logging_ga88acd260151caf2db9c0fc84997f45ce}{NS\_LOG\_LOGIC} (\textcolor{stringliteral}{"create alloc size="}<<\hyperlink{classns3_1_1PacketMetadata_a3816d0a0ab763831fd248b0b2693db1c}{m\_maxSize});
592   \textcolor{keywordflow}{return} \hyperlink{classns3_1_1PacketMetadata_a5cb8aff27ae7a4b60c0bc1a743e1cc8a}{PacketMetadata::Allocate} (\hyperlink{classns3_1_1PacketMetadata_a3816d0a0ab763831fd248b0b2693db1c}{m\_maxSize});
593 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 26




Here is the caller graph for this function\+:
% FIG 27


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Create\+Fragment@{Create\+Fragment}}
\index{Create\+Fragment@{Create\+Fragment}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Create\+Fragment(uint32\+\_\+t start, uint32\+\_\+t end) const }{CreateFragment(uint32_t start, uint32_t end) const }}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Packet\+Metadata} ns3\+::\+Packet\+Metadata\+::\+Create\+Fragment (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{start, }
\item[{uint32\+\_\+t}]{end}
\end{DoxyParamCaption}
) const}\hypertarget{classns3_1_1PacketMetadata_a0c4fe43ab63b49432451c37263826d67}{}\label{classns3_1_1PacketMetadata_a0c4fe43ab63b49432451c37263826d67}


Creates a fragment. 


\begin{DoxyParams}{Parameters}
{\em start} & the amount of stuff to remove from the start \\
\hline
{\em end} & the amount of stuff to remove from the end \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the fragment\textquotesingle{}s metadata
\end{DoxyReturn}
Calling this method is equivalent to calling Remove\+At\+Start (start) and then, Remove\+At\+End (end). 
\begin{DoxyCode}
645 \{
646   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} << end);
647   \hyperlink{classns3_1_1PacketMetadata_a78447d800a9c3b6c85a3f38a09682b00}{PacketMetadata} fragment = *\textcolor{keyword}{this};
648   fragment.RemoveAtStart (\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start});
649   fragment.RemoveAtEnd (end);
650   \textcolor{keywordflow}{return} fragment;
651 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 28




Here is the caller graph for this function\+:
% FIG 29


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Deallocate@{Deallocate}}
\index{Deallocate@{Deallocate}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Deallocate(struct Packet\+Metadata\+::\+Data $\ast$data)}{Deallocate(struct PacketMetadata::Data *data)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Deallocate (
\begin{DoxyParamCaption}
\item[{struct {\bf Packet\+Metadata\+::\+Data} $\ast$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a5284ea0e3b7e0e272ca521cb976431b7}{}\label{classns3_1_1PacketMetadata_a5284ea0e3b7e0e272ca521cb976431b7}


Deallocate the buffer memory. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer data storage \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
636 \{
637   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data});
638   uint8\_t *buf = (uint8\_t *)\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data};
639   \textcolor{keyword}{delete} [] buf;
640 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 30


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Deserialize@{Deserialize}}
\index{Deserialize@{Deserialize}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Deserialize(const uint8\+\_\+t $\ast$buffer, uint32\+\_\+t size)}{Deserialize(const uint8_t *buffer, uint32_t size)}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Packet\+Metadata\+::\+Deserialize (
\begin{DoxyParamCaption}
\item[{const uint8\+\_\+t $\ast$}]{buffer, }
\item[{uint32\+\_\+t}]{size}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1PacketMetadata_a88efb0a5ff0339b9430ded4e3452397d}{}\label{classns3_1_1PacketMetadata_a88efb0a5ff0339b9430ded4e3452397d}


Deserialization from raw uint8\+\_\+t$\ast$. 


\begin{DoxyParams}{Parameters}
{\em buffer} & the buffer to deserialize from \\
\hline
{\em size} & the size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success, 0 on failure 
\end{DoxyReturn}

\begin{DoxyCode}
1280 \{
1281   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << &buffer << size);
1282   \textcolor{keyword}{const} uint8\_t* \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} = buffer;
1283   uint32\_t desSize = size - 4;
1284 
1285   buffer = \hyperlink{classns3_1_1PacketMetadata_a069d077359e7d6dac6b575b12584a7ae}{ReadFromRawU64} (\hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\_packetUid}, start, buffer, size);
1286   desSize -= 8;
1287 
1288   \textcolor{keyword}{struct }PacketMetadata::SmallItem item = \{0\};
1289   \textcolor{keyword}{struct }PacketMetadata::ExtraItem extraItem = \{0\};
1290   \textcolor{keywordflow}{while} (desSize > 0)
1291     \{
1292       uint32\_t uidStringSize = 0;
1293       buffer = \hyperlink{classns3_1_1PacketMetadata_a5a055957d2f52aeee983871a358215a7}{ReadFromRawU32} (uidStringSize, start, buffer, size);
1294       desSize -= 4;
1295       uint32\_t uid;
1296       \textcolor{keywordflow}{if} (uidStringSize == 0)
1297         \{
1298           \textcolor{comment}{// uid zero for payload.}
1299           uid = 0;
1300         \}
1301       \textcolor{keywordflow}{else}
1302         \{
1303           std::string uidString;
1304           \textcolor{keywordflow}{for} (uint32\_t j = 0; j < uidStringSize; j++)
1305             \{
1306               uint8\_t ch = 0;
1307               buffer = \hyperlink{classns3_1_1PacketMetadata_aeab158c490a41b3776aab0b26092ff50}{ReadFromRawU8} (ch, start, buffer, size);
1308               uidString.push\_back (ch);
1309               desSize--;
1310             \}
1311           TypeId tid = \hyperlink{classns3_1_1TypeId_a119cf99c20931fdc294602cd360b180e}{TypeId::LookupByName} (uidString);
1312           uid = tid.GetUid ();
1313         \}
1314       uint8\_t isBig = 0;
1315       buffer = \hyperlink{classns3_1_1PacketMetadata_aeab158c490a41b3776aab0b26092ff50}{ReadFromRawU8} (isBig, start, buffer, size);
1316       desSize--;
1317       item.typeUid = (uid << 1) | isBig;
1318       buffer = \hyperlink{classns3_1_1PacketMetadata_a5a055957d2f52aeee983871a358215a7}{ReadFromRawU32} (item.size, start, buffer, size);
1319       desSize -= 4;
1320       buffer = \hyperlink{classns3_1_1PacketMetadata_a9466105641875317279a17991707e308}{ReadFromRawU16} (item.chunkUid, start, buffer, size);
1321       desSize -= 2;
1322       buffer = \hyperlink{classns3_1_1PacketMetadata_a5a055957d2f52aeee983871a358215a7}{ReadFromRawU32} (extraItem.fragmentStart, start, buffer, size);
1323       desSize -= 4;
1324       buffer = \hyperlink{classns3_1_1PacketMetadata_a5a055957d2f52aeee983871a358215a7}{ReadFromRawU32} (extraItem.fragmentEnd, start, buffer, size);
1325       desSize -= 4;
1326       buffer = \hyperlink{classns3_1_1PacketMetadata_a069d077359e7d6dac6b575b12584a7ae}{ReadFromRawU64} (extraItem.packetUid, start, buffer, size);
1327       desSize -= 8;
1328       \hyperlink{group__logging_ga88acd260151caf2db9c0fc84997f45ce}{NS\_LOG\_LOGIC} (\textcolor{stringliteral}{"size="} << size << \textcolor{stringliteral}{", typeUid="}<<item.typeUid <<
1329                     \textcolor{stringliteral}{", size="}<<item.size<<\textcolor{stringliteral}{", chunkUid="}<<item.chunkUid<<
1330                     \textcolor{stringliteral}{", fragmentStart="}<<extraItem.fragmentStart<<\textcolor{stringliteral}{", fragmentEnd="}<<
1331                     extraItem.fragmentEnd<< \textcolor{stringliteral}{", packetUid="}<<extraItem.packetUid);
1332       uint32\_t tmp = \hyperlink{classns3_1_1PacketMetadata_ae89a0bf5e3dcd624bd37bc8ca67544da}{AddBig} (0xffff, \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail}, &item, &extraItem);
1333       \hyperlink{classns3_1_1PacketMetadata_ad975bb9c1c0a6875ccc2309f071c5b55}{UpdateTail} (tmp);
1334     \}
1335   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (desSize == 0);
1336   \textcolor{keywordflow}{return} (desSize !=0) ? 0 : 1;
1337 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 31




Here is the caller graph for this function\+:
% FIG 32


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Do\+Add\+Header@{Do\+Add\+Header}}
\index{Do\+Add\+Header@{Do\+Add\+Header}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Do\+Add\+Header(uint32\+\_\+t uid, uint32\+\_\+t size)}{DoAddHeader(uint32_t uid, uint32_t size)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Do\+Add\+Header (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{uid, }
\item[{uint32\+\_\+t}]{size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_ae5ad09674e28733405c49b2655c51a5a}{}\label{classns3_1_1PacketMetadata_ae5ad09674e28733405c49b2655c51a5a}


Add an header. 


\begin{DoxyParams}{Parameters}
{\em uid} & header\textquotesingle{}s uid to add \\
\hline
{\em size} & header serialized size \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
664 \{
665   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << uid << size);
666   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable})
667     \{
668       \hyperlink{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{m\_metadataSkipped} = \textcolor{keyword}{true};
669       \textcolor{keywordflow}{return};
670     \}
671 
672   \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
673   item.next = \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head};
674   item.prev = 0xffff;
675   item.typeUid = uid;
676   item.size = size;
677   item.chunkUid = \hyperlink{classns3_1_1PacketMetadata_a98e20e3da84be30e3ff4b1761f215cbd}{m\_chunkUid};
678   \hyperlink{classns3_1_1PacketMetadata_a98e20e3da84be30e3ff4b1761f215cbd}{m\_chunkUid}++;
679   uint16\_t written = \hyperlink{classns3_1_1PacketMetadata_a9d74d684e6a7448a6790220c6c8e99f2}{AddSmall} (&item);
680   \hyperlink{classns3_1_1PacketMetadata_a3baa0c324423e6fd600b31858aa4ade9}{UpdateHead} (written);
681 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 33




Here is the caller graph for this function\+:
% FIG 34


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Enable@{Enable}}
\index{Enable@{Enable}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Enable(void)}{Enable(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Enable (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{classns3_1_1PacketMetadata_addee67896039c1a356ee47698b04e953}{}\label{classns3_1_1PacketMetadata_addee67896039c1a356ee47698b04e953}


Enable the packet metadata. 


\begin{DoxyCode}
53 \{
54   \hyperlink{log-macros-disabled_8h_a8f7e4afc291c9d29a65c18ac1f79197b}{NS\_LOG\_FUNCTION\_NOARGS} ();
55   \hyperlink{assert_8h_aff5ece9066c74e681e74999856f08539}{NS\_ASSERT\_MSG} (!\hyperlink{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{m\_metadataSkipped},
56                  \textcolor{stringliteral}{"Error: attempting to enable the packet metadata "}
57                  \textcolor{stringliteral}{"subsystem too late in the simulation, which is not allowed.\(\backslash\)n"}
58                  \textcolor{stringliteral}{"A common cause for this problem is to enable ASCII tracing "}
59                  \textcolor{stringliteral}{"after sending any packets.  One way to fix this problem is "}
60                  \textcolor{stringliteral}{"to call ns3::PacketMetadata::Enable () near the beginning of"}
61                  \textcolor{stringliteral}{" the program, before any packets are sent."});
62   \hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable} = \textcolor{keyword}{true};
63 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 35


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Enable\+Checking@{Enable\+Checking}}
\index{Enable\+Checking@{Enable\+Checking}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Enable\+Checking(void)}{EnableChecking(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Enable\+Checking (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{classns3_1_1PacketMetadata_a5bb19e2208a6a0573cdc79c3959ac6b4}{}\label{classns3_1_1PacketMetadata_a5bb19e2208a6a0573cdc79c3959ac6b4}


Enable the packet metadata checking. 


\begin{DoxyCode}
67 \{
68   \hyperlink{log-macros-disabled_8h_a8f7e4afc291c9d29a65c18ac1f79197b}{NS\_LOG\_FUNCTION\_NOARGS} ();
69   \hyperlink{classns3_1_1PacketMetadata_addee67896039c1a356ee47698b04e953}{Enable} ();
70   \hyperlink{classns3_1_1PacketMetadata_a3b4333cb8df79817e7ca74de1a090d89}{m\_enableChecking} = \textcolor{keyword}{true};
71 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 36




Here is the caller graph for this function\+:
% FIG 37


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Get\+Serialized\+Size@{Get\+Serialized\+Size}}
\index{Get\+Serialized\+Size@{Get\+Serialized\+Size}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Get\+Serialized\+Size(void) const }{GetSerializedSize(void) const }}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Packet\+Metadata\+::\+Get\+Serialized\+Size (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
) const}\hypertarget{classns3_1_1PacketMetadata_a8d399798f5b18fc287a772914bfd9386}{}\label{classns3_1_1PacketMetadata_a8d399798f5b18fc287a772914bfd9386}


Get the metadata serialized size. 

\begin{DoxyReturn}{Returns}
the seralized size 
\end{DoxyReturn}

\begin{DoxyCode}
1134 \{
1135   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
1136   uint32\_t totalSize = 0;
1137 
1138   \textcolor{comment}{// add 8 bytes for the packet uid}
1139   totalSize += 8;
1140 
1141   \textcolor{comment}{// if packet-metadata not enabled, total size}
1142   \textcolor{comment}{// is simply 4-bytes for itself plus 8-bytes }
1143   \textcolor{comment}{// for packet uid}
1144   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable})
1145     \{
1146       \textcolor{keywordflow}{return} totalSize;
1147     \}
1148 
1149   \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
1150   \textcolor{keyword}{struct }PacketMetadata::ExtraItem extraItem;
1151   uint32\_t current = \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head};
1152   \textcolor{keywordflow}{while} (current != 0xffff)
1153     \{
1154       \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (current, &item, &extraItem);
1155       uint32\_t uid = (item.typeUid & 0xfffffffe) >> 1;
1156       \textcolor{keywordflow}{if} (uid == 0)
1157         \{
1158           totalSize += 4;
1159         \}
1160       \textcolor{keywordflow}{else}
1161         \{
1162           TypeId tid;
1163           tid.SetUid (uid);
1164           totalSize += 4 + tid.GetName ().size ();
1165         \}
1166       totalSize += 1 + 4 + 2 + 4 + 4 + 8;
1167       \textcolor{keywordflow}{if} (current == \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
1168         \{
1169           \textcolor{keywordflow}{break};
1170         \}
1171       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (current != item.next);
1172       current = item.next;
1173     \}
1174   \textcolor{keywordflow}{return} totalSize;
1175 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 38




Here is the caller graph for this function\+:
% FIG 39


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Get\+Total\+Size@{Get\+Total\+Size}}
\index{Get\+Total\+Size@{Get\+Total\+Size}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Get\+Total\+Size(void) const }{GetTotalSize(void) const }}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Packet\+Metadata\+::\+Get\+Total\+Size (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_abb9dbf67e16dd56f9ad8b2bc29bbeb3b}{}\label{classns3_1_1PacketMetadata_abb9dbf67e16dd56f9ad8b2bc29bbeb3b}


Get the total size used by the metadata. 


\begin{DoxyCode}
1018 \{
1019   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
1020   uint32\_t totalSize = 0;
1021   uint16\_t current = \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head};
1022   uint16\_t tail = \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail};
1023   \textcolor{keywordflow}{while} (current != 0xffff)
1024     \{
1025       \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
1026       PacketMetadata::ExtraItem extraItem;
1027       \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (current, &item, &extraItem);
1028       totalSize += extraItem.fragmentEnd - extraItem.fragmentStart;
1029       \textcolor{keywordflow}{if} (current == tail)
1030         \{
1031           \textcolor{keywordflow}{break};
1032         \}
1033       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (current != item.next);
1034       current = item.next;
1035     \}
1036   \textcolor{keywordflow}{return} totalSize;
1037 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 40


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Get\+Uid@{Get\+Uid}}
\index{Get\+Uid@{Get\+Uid}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Get\+Uid(void) const }{GetUid(void) const }}]{\setlength{\rightskip}{0pt plus 5cm}uint64\+\_\+t ns3\+::\+Packet\+Metadata\+::\+Get\+Uid (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
) const}\hypertarget{classns3_1_1PacketMetadata_a08284bf2d5d0690d16a2eee813122ede}{}\label{classns3_1_1PacketMetadata_a08284bf2d5d0690d16a2eee813122ede}


Get the packet Uid. 

\begin{DoxyReturn}{Returns}
the packet Uid 
\end{DoxyReturn}

\begin{DoxyCode}
1041 \{
1042   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
1043   \textcolor{keywordflow}{return} \hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\_packetUid};
1044 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 41


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Get\+Uleb128\+Size@{Get\+Uleb128\+Size}}
\index{Get\+Uleb128\+Size@{Get\+Uleb128\+Size}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Get\+Uleb128\+Size(uint32\+\_\+t value) const }{GetUleb128Size(uint32_t value) const }}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Packet\+Metadata\+::\+Get\+Uleb128\+Size (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{value}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{}\label{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}


Get the U\+L\+E\+B128 (Unsigned Little Endian Base 128) size. 


\begin{DoxyParams}{Parameters}
{\em value} & the value \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the value\textquotesingle{}s U\+L\+E\+B128 size 
\end{DoxyReturn}

\begin{DoxyCode}
166 \{
167   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << value);
168   \textcolor{keywordflow}{if} (value < 0x80)
169     \{
170       \textcolor{keywordflow}{return} 1;
171     \}
172   \textcolor{keywordflow}{if} (value < 0x4000)
173     \{
174       \textcolor{keywordflow}{return} 2;
175     \}
176   \textcolor{keywordflow}{if} (value < 0x200000)
177     \{
178       \textcolor{keywordflow}{return} 3;
179     \}
180   \textcolor{keywordflow}{if} (value < 0x10000000)
181     \{
182       \textcolor{keywordflow}{return} 4;
183     \}
184   \textcolor{keywordflow}{return} 5;
185 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 42


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Is\+Pointer\+Ok@{Is\+Pointer\+Ok}}
\index{Is\+Pointer\+Ok@{Is\+Pointer\+Ok}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Is\+Pointer\+Ok(uint16\+\_\+t pointer) const }{IsPointerOk(uint16_t pointer) const }}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Packet\+Metadata\+::\+Is\+Pointer\+Ok (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{pointer}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_acf15fba7d020ebd77591619b5ad273c5}{}\label{classns3_1_1PacketMetadata_acf15fba7d020ebd77591619b5ad273c5}


Check if the position is valid. 


\begin{DoxyParams}{Parameters}
{\em pointer} & the position to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if the position is valid 
\end{DoxyReturn}

\begin{DoxyCode}
126 \{
127   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << pointer);
128   \textcolor{keywordtype}{bool} ok = pointer == 0xffff || pointer <= \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
129   \textcolor{keywordflow}{return} ok;
130 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 43


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Is\+Shared\+Pointer\+Ok@{Is\+Shared\+Pointer\+Ok}}
\index{Is\+Shared\+Pointer\+Ok@{Is\+Shared\+Pointer\+Ok}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Is\+Shared\+Pointer\+Ok(uint16\+\_\+t pointer) const }{IsSharedPointerOk(uint16_t pointer) const }}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Packet\+Metadata\+::\+Is\+Shared\+Pointer\+Ok (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{pointer}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_ae62c5bb3dce611a0f8c5e9ba3ba8e26e}{}\label{classns3_1_1PacketMetadata_ae62c5bb3dce611a0f8c5e9ba3ba8e26e}


Check if the position is valid. 


\begin{DoxyParams}{Parameters}
{\em pointer} & the position to check \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
true if the position is valid 
\end{DoxyReturn}

\begin{DoxyCode}
119 \{
120   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << pointer);
121   \textcolor{keywordtype}{bool} ok = pointer == 0xffff || pointer <= \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a1064e5617aec301dd4f28fb86c105848}{m\_size};
122   \textcolor{keywordflow}{return} ok;
123 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 44


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Is\+State\+Ok@{Is\+State\+Ok}}
\index{Is\+State\+Ok@{Is\+State\+Ok}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Is\+State\+Ok(void) const }{IsStateOk(void) const }}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Packet\+Metadata\+::\+Is\+State\+Ok (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{}\label{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}


Check if the metadata state is ok. 

\begin{DoxyReturn}{Returns}
true if the internal state is ok 
\end{DoxyReturn}

\begin{DoxyCode}
134 \{
135   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
136   \textcolor{keywordtype}{bool} ok = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} <= \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a1064e5617aec301dd4f28fb86c105848}{m\_size};
137   ok &= \hyperlink{classns3_1_1PacketMetadata_acf15fba7d020ebd77591619b5ad273c5}{IsPointerOk} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head});
138   ok &= \hyperlink{classns3_1_1PacketMetadata_acf15fba7d020ebd77591619b5ad273c5}{IsPointerOk} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail});
139   uint16\_t current = \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head};
140   \textcolor{keywordflow}{while} (ok && current != 0xffff)
141     \{
142       \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
143       PacketMetadata::ExtraItem extraItem;
144       \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (current, &item, &extraItem);
145       ok &= \hyperlink{classns3_1_1PacketMetadata_ae62c5bb3dce611a0f8c5e9ba3ba8e26e}{IsSharedPointerOk} (item.next);
146       ok &= \hyperlink{classns3_1_1PacketMetadata_ae62c5bb3dce611a0f8c5e9ba3ba8e26e}{IsSharedPointerOk} (item.prev);
147       \textcolor{keywordflow}{if} (current != \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head})
148         \{
149           ok &= \hyperlink{classns3_1_1PacketMetadata_acf15fba7d020ebd77591619b5ad273c5}{IsPointerOk} (item.prev);
150         \}
151       \textcolor{keywordflow}{if} (current != \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
152         \{
153           ok &= \hyperlink{classns3_1_1PacketMetadata_acf15fba7d020ebd77591619b5ad273c5}{IsPointerOk} (item.next);
154         \}
155       \textcolor{keywordflow}{if} (current == \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
156         \{
157           \textcolor{keywordflow}{break};
158         \}
159       current = item.next;
160     \}
161   \textcolor{keywordflow}{return} ok;
162 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 45




Here is the caller graph for this function\+:
% FIG 46


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!operator=@{operator=}}
\index{operator=@{operator=}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{operator=(\+Packet\+Metadata const \&o)}{operator=(PacketMetadata const &o)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Packet\+Metadata} \& ns3\+::\+Packet\+Metadata\+::operator= (
\begin{DoxyParamCaption}
\item[{{\bf Packet\+Metadata} const \&}]{o}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}\hypertarget{classns3_1_1PacketMetadata_a808cc741d74271cce313d5a0691de5b7}{}\label{classns3_1_1PacketMetadata_a808cc741d74271cce313d5a0691de5b7}


Basic assignment. 


\begin{DoxyParams}{Parameters}
{\em o} & the object to copy \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
a copied object 
\end{DoxyReturn}

\begin{DoxyCode}
715 \{
716   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != o.\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}) 
717     \{
718       \textcolor{comment}{// not self assignment}
719       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != 0);
720       \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count}--;
721       \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count} == 0) 
722         \{
723           \hyperlink{classns3_1_1PacketMetadata_ae4bff0e3145f955d12e75531b0be6b7f}{PacketMetadata::Recycle} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data});
724         \}
725       \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} = o.\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data};
726       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != 0);
727       \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count}++;
728     \}
729   \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} = o.m\_head;
730   \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} = o.m\_tail;
731   \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} = o.m\_used;
732   \hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\_packetUid} = o.m\_packetUid;
733   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
734 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 47


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Read\+From\+Raw\+U16@{Read\+From\+Raw\+U16}}
\index{Read\+From\+Raw\+U16@{Read\+From\+Raw\+U16}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Read\+From\+Raw\+U16(uint16\+\_\+t \&data, const uint8\+\_\+t $\ast$start, const uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)}{ReadFromRawU16(uint16_t &data, const uint8_t *start, const uint8_t *current, uint32_t maxSize)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t $\ast$ ns3\+::\+Packet\+Metadata\+::\+Read\+From\+Raw\+U16 (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t \&}]{data, }
\item[{const uint8\+\_\+t $\ast$}]{start, }
\item[{const uint8\+\_\+t $\ast$}]{current, }
\item[{uint32\+\_\+t}]{max\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a9466105641875317279a17991707e308}{}\label{classns3_1_1PacketMetadata_a9466105641875317279a17991707e308}


Helper for the raw deserialization. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer to read from \\
\hline
{\em start} & start index \\
\hline
{\em current} & current index \\
\hline
{\em max\+Size} & maximum size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
updated current index 
\end{DoxyReturn}

\begin{DoxyCode}
1441 \{ 
1442   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data} << &\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} << &current << maxSize);
1443   \textcolor{comment}{// First check buffer underflow}
1444   \textcolor{keywordflow}{if} (static\_cast<uint32\_t> ((current + \textcolor{keyword}{sizeof} (uint16\_t) - \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start})) > maxSize) 
1445     \{
1446       \textcolor{keywordflow}{return} 0;
1447     \}
1448   memcpy (&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, current, \textcolor{keyword}{sizeof} (uint16\_t));
1449   \textcolor{keywordflow}{return} \textcolor{keyword}{const\_cast<}uint8\_t *\textcolor{keyword}{>} (current) + \textcolor{keyword}{sizeof} (uint16\_t);
1450 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 48


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Read\+From\+Raw\+U32@{Read\+From\+Raw\+U32}}
\index{Read\+From\+Raw\+U32@{Read\+From\+Raw\+U32}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Read\+From\+Raw\+U32(uint32\+\_\+t \&data, const uint8\+\_\+t $\ast$start, const uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)}{ReadFromRawU32(uint32_t &data, const uint8_t *start, const uint8_t *current, uint32_t maxSize)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t $\ast$ ns3\+::\+Packet\+Metadata\+::\+Read\+From\+Raw\+U32 (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t \&}]{data, }
\item[{const uint8\+\_\+t $\ast$}]{start, }
\item[{const uint8\+\_\+t $\ast$}]{current, }
\item[{uint32\+\_\+t}]{max\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a5a055957d2f52aeee983871a358215a7}{}\label{classns3_1_1PacketMetadata_a5a055957d2f52aeee983871a358215a7}


Helper for the raw deserialization. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer to read from \\
\hline
{\em start} & start index \\
\hline
{\em current} & current index \\
\hline
{\em max\+Size} & maximum size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
updated current index 
\end{DoxyReturn}

\begin{DoxyCode}
1457 \{ 
1458   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data} << &\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} << &current << maxSize);
1459   \textcolor{comment}{// First check buffer underflow}
1460   \textcolor{keywordflow}{if} (static\_cast<uint32\_t> ((current + \textcolor{keyword}{sizeof} (uint32\_t) - \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start})) > maxSize) 
1461     \{
1462       \textcolor{keywordflow}{return} 0;
1463     \}
1464   memcpy (&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, current, \textcolor{keyword}{sizeof} (uint32\_t));
1465   \textcolor{keywordflow}{return} \textcolor{keyword}{const\_cast<}uint8\_t *\textcolor{keyword}{>} (current) + \textcolor{keyword}{sizeof} (uint32\_t);
1466 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 49


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Read\+From\+Raw\+U64@{Read\+From\+Raw\+U64}}
\index{Read\+From\+Raw\+U64@{Read\+From\+Raw\+U64}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Read\+From\+Raw\+U64(uint64\+\_\+t \&data, const uint8\+\_\+t $\ast$start, const uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)}{ReadFromRawU64(uint64_t &data, const uint8_t *start, const uint8_t *current, uint32_t maxSize)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t $\ast$ ns3\+::\+Packet\+Metadata\+::\+Read\+From\+Raw\+U64 (
\begin{DoxyParamCaption}
\item[{uint64\+\_\+t \&}]{data, }
\item[{const uint8\+\_\+t $\ast$}]{start, }
\item[{const uint8\+\_\+t $\ast$}]{current, }
\item[{uint32\+\_\+t}]{max\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a069d077359e7d6dac6b575b12584a7ae}{}\label{classns3_1_1PacketMetadata_a069d077359e7d6dac6b575b12584a7ae}


Helper for the raw deserialization. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer to read from \\
\hline
{\em start} & start index \\
\hline
{\em current} & current index \\
\hline
{\em max\+Size} & maximum size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
updated current index 
\end{DoxyReturn}

\begin{DoxyCode}
1473 \{ 
1474   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data} << &\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} << &current << maxSize);
1475   \textcolor{comment}{// First check buffer underflow}
1476   \textcolor{keywordflow}{if} ((uint32\_t)((current + \textcolor{keyword}{sizeof} (uint64\_t) - \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start})) > maxSize) 
1477     \{
1478       \textcolor{keywordflow}{return} 0;
1479     \}
1480   memcpy (&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, current, \textcolor{keyword}{sizeof} (uint64\_t));
1481   \textcolor{keywordflow}{return} \textcolor{keyword}{const\_cast<}uint8\_t *\textcolor{keyword}{>} (current) + \textcolor{keyword}{sizeof} (uint64\_t);
1482 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 50


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Read\+From\+Raw\+U8@{Read\+From\+Raw\+U8}}
\index{Read\+From\+Raw\+U8@{Read\+From\+Raw\+U8}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Read\+From\+Raw\+U8(uint8\+\_\+t \&data, const uint8\+\_\+t $\ast$start, const uint8\+\_\+t $\ast$current, uint32\+\_\+t max\+Size)}{ReadFromRawU8(uint8_t &data, const uint8_t *start, const uint8_t *current, uint32_t maxSize)}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t $\ast$ ns3\+::\+Packet\+Metadata\+::\+Read\+From\+Raw\+U8 (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t \&}]{data, }
\item[{const uint8\+\_\+t $\ast$}]{start, }
\item[{const uint8\+\_\+t $\ast$}]{current, }
\item[{uint32\+\_\+t}]{max\+Size}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_aeab158c490a41b3776aab0b26092ff50}{}\label{classns3_1_1PacketMetadata_aeab158c490a41b3776aab0b26092ff50}


Helper for the raw deserialization. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer to read from \\
\hline
{\em start} & start index \\
\hline
{\em current} & current index \\
\hline
{\em max\+Size} & maximum size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
updated current index 
\end{DoxyReturn}

\begin{DoxyCode}
1425 \{ 
1426   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (static\_cast<uint32\_t> (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}) << &\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} << &current << maxSize);
1427   \textcolor{comment}{// First check buffer underflow}
1428   \textcolor{keywordflow}{if} (static\_cast<uint32\_t> ((current + \textcolor{keyword}{sizeof} (uint8\_t) - \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start})) > maxSize) 
1429     \{
1430       \textcolor{keywordflow}{return} 0;
1431     \}
1432   memcpy (&\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}, current, \textcolor{keyword}{sizeof} (uint8\_t));
1433   \textcolor{keywordflow}{return} \textcolor{keyword}{const\_cast<}uint8\_t *\textcolor{keyword}{>} (current) + \textcolor{keyword}{sizeof} (uint8\_t);
1434 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 51


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Read\+Items@{Read\+Items}}
\index{Read\+Items@{Read\+Items}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Read\+Items(uint16\+\_\+t current, struct Packet\+Metadata\+::\+Small\+Item $\ast$item, struct Packet\+Metadata\+::\+Extra\+Item $\ast$extra\+Item) const }{ReadItems(uint16_t current, struct PacketMetadata::SmallItem *item, struct PacketMetadata::ExtraItem *extraItem) const }}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Packet\+Metadata\+::\+Read\+Items (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{current, }
\item[{struct {\bf Packet\+Metadata\+::\+Small\+Item} $\ast$}]{item, }
\item[{struct {\bf Packet\+Metadata\+::\+Extra\+Item} $\ast$}]{extra\+Item}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{}\label{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}


Read items. 


\begin{DoxyParams}{Parameters}
{\em current} & the offset we should start reading the data from \\
\hline
{\em item} & pointer to where we should store the data to return to the caller \\
\hline
{\em extra\+Item} & pointer to where we should store the data to return to the caller \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number of bytes read. 
\end{DoxyReturn}

\begin{DoxyCode}
531 \{
532   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << current << item->chunkUid << item->prev << item->next << item->
      size <<
533                         item->typeUid << extraItem->fragmentEnd << extraItem->fragmentStart <<
534                         extraItem->packetUid);
535   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (current <= m\_data->m\_size);
536   \textcolor{keyword}{const} uint8\_t *buffer = &\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}[current];
537   item->next = buffer[0];
538   item->next |= (buffer[1]) << 8;
539   item->prev = buffer[2];
540   item->prev |= (buffer[3]) << 8;
541   buffer += 4;
542   item->typeUid = \hyperlink{classns3_1_1PacketMetadata_a7ae75db766a843dbee8960ae8cbf23ee}{ReadUleb128} (&buffer);
543   item->size = \hyperlink{classns3_1_1PacketMetadata_a7ae75db766a843dbee8960ae8cbf23ee}{ReadUleb128} (&buffer);
544   item->chunkUid = buffer[0];
545   item->chunkUid |= (buffer[1]) << 8;
546   buffer += 2;
547 
548   \textcolor{keywordtype}{bool} isExtra = (item->typeUid & 0x1) == 0x1;
549   \textcolor{keywordflow}{if} (isExtra)
550     \{
551       extraItem->fragmentStart = \hyperlink{classns3_1_1PacketMetadata_a7ae75db766a843dbee8960ae8cbf23ee}{ReadUleb128} (&buffer);
552       extraItem->fragmentEnd = \hyperlink{classns3_1_1PacketMetadata_a7ae75db766a843dbee8960ae8cbf23ee}{ReadUleb128} (&buffer);
553       extraItem->packetUid = buffer[0];
554       extraItem->packetUid |= buffer[1] << 8;
555       extraItem->packetUid |= buffer[2] << 16;
556       extraItem->packetUid |= buffer[3] << 24;
557       buffer += 4;
558     \}
559   \textcolor{keywordflow}{else}
560     \{
561       extraItem->fragmentStart = 0;
562       extraItem->fragmentEnd = item->size;
563       extraItem->packetUid = \hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\_packetUid};
564     \}
565   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (buffer <= &m\_data->\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}[\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a1064e5617aec301dd4f28fb86c105848}{m\_size}]);
566   \textcolor{keywordflow}{return} buffer - &\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}[current];
567 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 52




Here is the caller graph for this function\+:
% FIG 53


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Read\+Uleb128@{Read\+Uleb128}}
\index{Read\+Uleb128@{Read\+Uleb128}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Read\+Uleb128(const uint8\+\_\+t $\ast$$\ast$p\+Buffer) const }{ReadUleb128(const uint8_t **pBuffer) const }}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Packet\+Metadata\+::\+Read\+Uleb128 (
\begin{DoxyParamCaption}
\item[{const uint8\+\_\+t $\ast$$\ast$}]{p\+Buffer}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a7ae75db766a843dbee8960ae8cbf23ee}{}\label{classns3_1_1PacketMetadata_a7ae75db766a843dbee8960ae8cbf23ee}


Read a U\+L\+E\+B128 (Unsigned Little Endian Base 128) coded number. 


\begin{DoxyParams}{Parameters}
{\em p\+Buffer} & the buffer to read from \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
the value 
\end{DoxyReturn}

\begin{DoxyCode}
188 \{
189   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << &pBuffer);
190   \textcolor{keyword}{const} uint8\_t *buffer = *pBuffer;
191   uint32\_t result;
192   uint8\_t byte;
193 
194   byte = buffer[0];
195   result = (byte & (~0x80));
196   \textcolor{keywordflow}{if} (!(byte & 0x80))
197     \{
198       *pBuffer = buffer + 1;
199       \textcolor{keywordflow}{return} result;
200     \}
201   byte = buffer[1];
202   result |= (byte & (~0x80)) << 7;
203   \textcolor{keywordflow}{if} (!(byte & 0x80))
204     \{
205       *pBuffer = buffer + 2;
206       \textcolor{keywordflow}{return} result;
207     \}
208   byte = buffer[2];
209   result |= (byte & (~0x80)) << 14;
210   \textcolor{keywordflow}{if} (!(byte & 0x80))
211     \{
212       *pBuffer = buffer + 3;
213       \textcolor{keywordflow}{return} result;
214     \}
215   byte = buffer[3];
216   result |= (byte & (~0x80)) << 21;
217   \textcolor{keywordflow}{if} (!(byte & 0x80))
218     \{
219       *pBuffer = buffer + 4;
220       \textcolor{keywordflow}{return} result;
221     \}
222   byte = buffer[4];
223   result |= (byte & (~0x80)) << 28;
224   \textcolor{keywordflow}{if} (!(byte & 0x80))
225     \{
226       *pBuffer = buffer + 5;
227       \textcolor{keywordflow}{return} result;
228     \}
229   \textcolor{comment}{/* This means that the LEB128 number was not valid.}
230 \textcolor{comment}{   * ie: the last (5th) byte did not have the high-order bit zeroed.}
231 \textcolor{comment}{   */}
232   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\textcolor{keyword}{false});
233   \textcolor{keywordflow}{return} 0;
234 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 54


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Recycle@{Recycle}}
\index{Recycle@{Recycle}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Recycle(struct Packet\+Metadata\+::\+Data $\ast$data)}{Recycle(struct PacketMetadata::Data *data)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Recycle (
\begin{DoxyParamCaption}
\item[{struct {\bf Packet\+Metadata\+::\+Data} $\ast$}]{data}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_ae4bff0e3145f955d12e75531b0be6b7f}{}\label{classns3_1_1PacketMetadata_ae4bff0e3145f955d12e75531b0be6b7f}


Recycle the buffer memory. 


\begin{DoxyParams}{Parameters}
{\em data} & the buffer data storage \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
597 \{
598   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data});
599   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable})
600     \{
601       \hyperlink{classns3_1_1PacketMetadata_a5284ea0e3b7e0e272ca521cb976431b7}{PacketMetadata::Deallocate} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data});
602       \textcolor{keywordflow}{return};
603     \} 
604   \hyperlink{group__logging_ga88acd260151caf2db9c0fc84997f45ce}{NS\_LOG\_LOGIC} (\textcolor{stringliteral}{"recycle size="}<<\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}->m\_size<<\textcolor{stringliteral}{", list="}<<
      \hyperlink{classns3_1_1PacketMetadata_aa646ed601542eec6bb98e6219165a7c8}{m\_freeList}.size ());
605   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}->m\_count == 0);
606   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_aa646ed601542eec6bb98e6219165a7c8}{m\_freeList}.size () > 1000 ||
607       \hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data}->m\_size < \hyperlink{classns3_1_1PacketMetadata_a3816d0a0ab763831fd248b0b2693db1c}{m\_maxSize}) 
608     \{
609       \hyperlink{classns3_1_1PacketMetadata_a5284ea0e3b7e0e272ca521cb976431b7}{PacketMetadata::Deallocate} (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data});
610     \} 
611   \textcolor{keywordflow}{else} 
612     \{
613       \hyperlink{classns3_1_1PacketMetadata_aa646ed601542eec6bb98e6219165a7c8}{m\_freeList}.push\_back (\hyperlink{topology-example-sim_8cc_a26c65296e316af77b787dc77469bb2a4}{data});
614     \}
615 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 55




Here is the caller graph for this function\+:
% FIG 56


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Remove\+At\+End@{Remove\+At\+End}}
\index{Remove\+At\+End@{Remove\+At\+End}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Remove\+At\+End(uint32\+\_\+t end)}{RemoveAtEnd(uint32_t end)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Remove\+At\+End (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{end}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1PacketMetadata_a7c76154f5302bd55a68406f0103d50c6}{}\label{classns3_1_1PacketMetadata_a7c76154f5302bd55a68406f0103d50c6}


Remove a chunk of metadata at the metadata end. 


\begin{DoxyParams}{Parameters}
{\em end} & the size of metadata to remove \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
953 \{
954   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << end);
955   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
956   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable}) 
957     \{
958       \hyperlink{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{m\_metadataSkipped} = \textcolor{keyword}{true};
959       \textcolor{keywordflow}{return};
960     \}
961   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != 0);
962 
963   uint32\_t leftToRemove = end;
964   uint16\_t current = \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail};
965   \textcolor{keywordflow}{while} (current != 0xffff && leftToRemove > 0)
966     \{
967       \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
968       PacketMetadata::ExtraItem extraItem;
969       \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (current, &item, &extraItem);
970       uint32\_t itemRealSize = extraItem.fragmentEnd - extraItem.fragmentStart;
971       \textcolor{keywordflow}{if} (itemRealSize <= leftToRemove)
972         \{
973           \textcolor{comment}{// remove from list.}
974           \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} == \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
975             \{
976               \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} = 0xffff;
977               \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} = 0xffff;
978             \}
979           \textcolor{keywordflow}{else}
980             \{
981               \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} = item.prev;
982             \}
983           leftToRemove -= itemRealSize;
984         \}
985       \textcolor{keywordflow}{else}
986         \{
987           \textcolor{comment}{// fragment the list item.}
988           \hyperlink{classns3_1_1PacketMetadata_a78447d800a9c3b6c85a3f38a09682b00}{PacketMetadata} fragment (\hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\_packetUid}, 0);
989           \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (extraItem.fragmentEnd > leftToRemove);
990           extraItem.fragmentEnd -= leftToRemove;
991           leftToRemove = 0;
992           uint16\_t written = fragment.AddBig (fragment.m\_head, 0xffff,
993                                               &item, &extraItem);
994           fragment.UpdateHead (written);
995           \textcolor{keywordflow}{while} (current != 0xffff && current != \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head})
996             \{
997               current = item.prev;
998               \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (current, &item, &extraItem);
999               written = fragment.AddBig (fragment.m\_head, 0xffff,
1000                                          &item, &extraItem);
1001               fragment.UpdateHead (written);
1002             \}
1003           *\textcolor{keyword}{this} = fragment;
1004         \}
1005       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (item.size >= extraItem.fragmentEnd - extraItem.fragmentStart &&
1006                  extraItem.fragmentStart <= extraItem.fragmentEnd);
1007       \textcolor{keywordflow}{if} (current == \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head})
1008         \{
1009           \textcolor{keywordflow}{break};
1010         \}
1011       current = item.prev;
1012     \}
1013   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (leftToRemove == 0);
1014   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
1015 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 57




Here is the caller graph for this function\+:
% FIG 58


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Remove\+At\+Start@{Remove\+At\+Start}}
\index{Remove\+At\+Start@{Remove\+At\+Start}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Remove\+At\+Start(uint32\+\_\+t start)}{RemoveAtStart(uint32_t start)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Remove\+At\+Start (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{start}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1PacketMetadata_a9a0300e7ae709f269d59b6733e590d56}{}\label{classns3_1_1PacketMetadata_a9a0300e7ae709f269d59b6733e590d56}


Remove a chunk of metadata at the metadata start. 


\begin{DoxyParams}{Parameters}
{\em start} & the size of metadata to remove \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
890 \{
891   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start});
892   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
893   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable}) 
894     \{
895       \hyperlink{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{m\_metadataSkipped} = \textcolor{keyword}{true};
896       \textcolor{keywordflow}{return};
897     \}
898   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != 0);
899   uint32\_t leftToRemove = \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start};
900   uint16\_t current = \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head};
901   \textcolor{keywordflow}{while} (current != 0xffff && leftToRemove > 0)
902     \{
903       \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
904       PacketMetadata::ExtraItem extraItem;
905       \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (current, &item, &extraItem);
906       uint32\_t itemRealSize = extraItem.fragmentEnd - extraItem.fragmentStart;
907       \textcolor{keywordflow}{if} (itemRealSize <= leftToRemove)
908         \{
909           \textcolor{comment}{// remove from list.}
910           \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} == \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
911             \{
912               \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} = 0xffff;
913               \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} = 0xffff;
914             \}
915           \textcolor{keywordflow}{else}
916             \{
917               \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} = item.next;
918             \}
919           leftToRemove -= itemRealSize;
920         \}
921       \textcolor{keywordflow}{else}
922         \{
923           \textcolor{comment}{// fragment the list item.}
924           \hyperlink{classns3_1_1PacketMetadata_a78447d800a9c3b6c85a3f38a09682b00}{PacketMetadata} fragment (\hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\_packetUid}, 0);
925           extraItem.fragmentStart += leftToRemove;
926           leftToRemove = 0;
927           uint16\_t written = fragment.AddBig (0xffff, fragment.m\_tail,
928                                               &item, &extraItem);
929           fragment.UpdateTail (written);
930           \textcolor{keywordflow}{while} (current != 0xffff && current != \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
931             \{
932               current = item.next;
933               \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (current, &item, &extraItem);
934               written = fragment.AddBig (0xffff, fragment.m\_tail,
935                                          &item, &extraItem);
936               fragment.UpdateTail (written);
937             \}
938           *\textcolor{keyword}{this} = fragment;
939         \}
940       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (item.size >= extraItem.fragmentEnd - extraItem.fragmentStart &&
941                  extraItem.fragmentStart <= extraItem.fragmentEnd);
942       \textcolor{keywordflow}{if} (current == \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
943         \{
944           \textcolor{keywordflow}{break};
945         \}
946       current = item.next;
947     \}
948   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (leftToRemove == 0);
949   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
950 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 59




Here is the caller graph for this function\+:
% FIG 60


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Remove\+Header@{Remove\+Header}}
\index{Remove\+Header@{Remove\+Header}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Remove\+Header(\+Header const \&header, uint32\+\_\+t size)}{RemoveHeader(Header const &header, uint32_t size)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Remove\+Header (
\begin{DoxyParamCaption}
\item[{{\bf Header} const \&}]{header, }
\item[{uint32\+\_\+t}]{size}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1PacketMetadata_afa8a589ec783d4998516d7f39f21242d}{}\label{classns3_1_1PacketMetadata_afa8a589ec783d4998516d7f39f21242d}


Remove an header. 


\begin{DoxyParams}{Parameters}
{\em header} & header to remove \\
\hline
{\em size} & header serialized size \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
684 \{
685   uint32\_t uid = header.GetInstanceTypeId ().GetUid () << 1;
686   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << &header << size);
687   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
688   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable}) 
689     \{
690       \hyperlink{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{m\_metadataSkipped} = \textcolor{keyword}{true};
691       \textcolor{keywordflow}{return};
692     \}
693   \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
694   \textcolor{keyword}{struct }PacketMetadata::ExtraItem extraItem;
695   uint32\_t read = \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head}, &item, &extraItem);
696   \textcolor{keywordflow}{if} ((item.typeUid & 0xfffffffe) != uid ||
697       item.size != size)
698     \{
699       \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a3b4333cb8df79817e7ca74de1a090d89}{m\_enableChecking})
700         \{
701           \hyperlink{group__fatal_ga5131d5e3f75d7d4cbfd706ac456fdc85}{NS\_FATAL\_ERROR} (\textcolor{stringliteral}{"Removing unexpected header."});
702         \}
703       \textcolor{keywordflow}{return};
704     \}
705   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (item.typeUid != uid &&
706            (extraItem.fragmentStart != 0 ||
707             extraItem.fragmentEnd != size))
708     \{
709       \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a3b4333cb8df79817e7ca74de1a090d89}{m\_enableChecking})
710         \{
711           \hyperlink{group__fatal_ga5131d5e3f75d7d4cbfd706ac456fdc85}{NS\_FATAL\_ERROR} (\textcolor{stringliteral}{"Removing incomplete header."});
712         \}
713       \textcolor{keywordflow}{return};
714     \}
715   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} + read == \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used})
716     \{
717       \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} = \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head};
718     \}
719   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} == \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
720     \{
721       \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} = 0xffff;
722       \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} = 0xffff;
723     \}
724   \textcolor{keywordflow}{else}
725     \{
726       \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} = item.next;
727     \}
728   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
729 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 61




Here is the caller graph for this function\+:
% FIG 62


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Remove\+Trailer@{Remove\+Trailer}}
\index{Remove\+Trailer@{Remove\+Trailer}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Remove\+Trailer(\+Trailer const \&trailer, uint32\+\_\+t size)}{RemoveTrailer(Trailer const &trailer, uint32_t size)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Remove\+Trailer (
\begin{DoxyParamCaption}
\item[{{\bf Trailer} const \&}]{trailer, }
\item[{uint32\+\_\+t}]{size}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1PacketMetadata_a2eaa46d9f7c88a5aef121521b196753c}{}\label{classns3_1_1PacketMetadata_a2eaa46d9f7c88a5aef121521b196753c}
Remove a trailer 
\begin{DoxyParams}{Parameters}
{\em trailer} & trailer to remove \\
\hline
{\em size} & trailer serialized size \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
754 \{
755   uint32\_t uid = trailer.GetInstanceTypeId ().GetUid () << 1;
756   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << &trailer << size);
757   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
758   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{m\_enable}) 
759     \{
760       \hyperlink{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{m\_metadataSkipped} = \textcolor{keyword}{true};
761       \textcolor{keywordflow}{return};
762     \}
763   \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
764   \textcolor{keyword}{struct }PacketMetadata::ExtraItem extraItem;
765   uint32\_t read = \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail}, &item, &extraItem);
766   \textcolor{keywordflow}{if} ((item.typeUid & 0xfffffffe) != uid ||
767       item.size != size)
768     \{
769       \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a3b4333cb8df79817e7ca74de1a090d89}{m\_enableChecking})
770         \{
771           \hyperlink{group__fatal_ga5131d5e3f75d7d4cbfd706ac456fdc85}{NS\_FATAL\_ERROR} (\textcolor{stringliteral}{"Removing unexpected trailer."});
772         \}
773       \textcolor{keywordflow}{return};
774     \}
775   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (item.typeUid != uid &&
776            (extraItem.fragmentStart != 0 ||
777             extraItem.fragmentEnd != size))
778     \{
779       \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a3b4333cb8df79817e7ca74de1a090d89}{m\_enableChecking})
780         \{
781           \hyperlink{group__fatal_ga5131d5e3f75d7d4cbfd706ac456fdc85}{NS\_FATAL\_ERROR} (\textcolor{stringliteral}{"Removing incomplete trailer."});
782         \}
783       \textcolor{keywordflow}{return};
784     \}
785   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} + read == \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used})
786     \{
787       \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} = \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail};
788     \}
789   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} == \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
790     \{
791       \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} = 0xffff;
792       \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} = 0xffff;
793     \}
794   \textcolor{keywordflow}{else}
795     \{
796       \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} = item.prev;
797     \}
798   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a208d3163e28704438cdd4d30318e489c}{IsStateOk} ());
799 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 63




Here is the caller graph for this function\+:
% FIG 64


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Replace\+Tail@{Replace\+Tail}}
\index{Replace\+Tail@{Replace\+Tail}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Replace\+Tail(\+Packet\+Metadata\+::\+Small\+Item $\ast$item, Packet\+Metadata\+::\+Extra\+Item $\ast$extra\+Item, uint32\+\_\+t available)}{ReplaceTail(PacketMetadata::SmallItem *item, PacketMetadata::ExtraItem *extraItem, uint32_t available)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Replace\+Tail (
\begin{DoxyParamCaption}
\item[{{\bf Packet\+Metadata\+::\+Small\+Item} $\ast$}]{item, }
\item[{{\bf Packet\+Metadata\+::\+Extra\+Item} $\ast$}]{extra\+Item, }
\item[{uint32\+\_\+t}]{available}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a0ad8fd1e4af8eaafca676b4cc3d9749b}{}\label{classns3_1_1PacketMetadata_a0ad8fd1e4af8eaafca676b4cc3d9749b}


Replace the tail. 


\begin{DoxyParams}{Parameters}
{\em item} & the item data to write \\
\hline
{\em extra\+Item} & the extra item data to write \\
\hline
{\em available} & the number of bytes which can be written without having to rewrite the buffer entirely. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
453 \{
454   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} <<
455                    item->next << item->prev << item->typeUid << item->size << item->chunkUid <<
456                    extraItem->fragmentStart << extraItem->fragmentEnd << extraItem->packetUid <<
457                    available);
458 
459   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != 0);
460   \textcolor{comment}{/* If the tail we want to replace is located at the end of the data array,}
461 \textcolor{comment}{   * and if there is extra room at the end of this array, then, }
462 \textcolor{comment}{   * we can try to use that extra space to avoid falling in the slow}
463 \textcolor{comment}{   * path below.}
464 \textcolor{comment}{   */}
465   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} + available == \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} &&
466       \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} == \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ae98316cc438fb40663c2f848746d8935}{m\_dirtyEnd})
467     \{
468       available = \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a1064e5617aec301dd4f28fb86c105848}{m\_size} - \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail};
469     \}
470 
471   uint32\_t typeUid = ((item->typeUid & 0x1) == 0x1) ? item->typeUid : item->typeUid+1;
472   uint32\_t typeUidSize = \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{GetUleb128Size} (typeUid);
473   uint32\_t sizeSize = \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{GetUleb128Size} (item->size);
474   uint32\_t fragStartSize = \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{GetUleb128Size} (extraItem->fragmentStart);
475   uint32\_t fragEndSize = \hyperlink{classns3_1_1PacketMetadata_a4ea634655d1780a2b4dd9a3ac54c3501}{GetUleb128Size} (extraItem->fragmentEnd);
476   uint32\_t \hyperlink{namespacesample-rng-plot_aeb5ee5c431e338ef39b7ac5431242e1d}{n} = 2 + 2 + typeUidSize + sizeSize + 2 + fragStartSize + fragEndSize + 4;
477 
478   \textcolor{keywordflow}{if} (available >= n &&
479       \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count} == 1)
480     \{
481       uint8\_t *buffer = &\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}[\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail}];
482       \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (item->next, buffer);
483       buffer += 2;
484       \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (item->prev, buffer);
485       buffer += 2;
486       \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{AppendValue} (typeUid, buffer);
487       buffer += typeUidSize;
488       \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{AppendValue} (item->size, buffer);
489       buffer += sizeSize;
490       \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (item->chunkUid, buffer);
491       buffer += 2;
492       \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{AppendValue} (extraItem->fragmentStart, buffer);
493       buffer += fragStartSize;
494       \hyperlink{classns3_1_1PacketMetadata_a48151488856a00fc7325c3e761b19b97}{AppendValue} (extraItem->fragmentEnd, buffer);
495       buffer += fragEndSize;
496       \hyperlink{classns3_1_1PacketMetadata_a254b3766510c9b38a2ad0bec6d973f15}{Append32} (extraItem->packetUid, buffer);
497       \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} = \hyperlink{80211b_8c_affe776513b24d84b39af8ab0930fef7f}{std::max} (\hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used}, (uint16\_t)(buffer - &\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->
      \hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}[0]));
498       \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ae98316cc438fb40663c2f848746d8935}{m\_dirtyEnd} = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
499       \textcolor{keywordflow}{return};
500     \}
501 
502   \textcolor{comment}{/* Below is the slow path which is hit if the new tail we want }
503 \textcolor{comment}{   * to append is bigger than the previous tail.}
504 \textcolor{comment}{   */}
505 
506   \textcolor{comment}{// create a copy of the packet without its tail.}
507   \hyperlink{classns3_1_1PacketMetadata_a78447d800a9c3b6c85a3f38a09682b00}{PacketMetadata} h (\hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\_packetUid}, 0);
508   uint16\_t current = \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head};
509   \textcolor{keywordflow}{while} (current != 0xffff && current != \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
510     \{
511       \textcolor{keyword}{struct }PacketMetadata::SmallItem tmpItem;
512       PacketMetadata::ExtraItem tmpExtraItem;
513       \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (current, &tmpItem, &tmpExtraItem);
514       uint16\_t written = h.AddBig (0xffff, h.m\_tail, 
515                                    &tmpItem, &tmpExtraItem);
516       h.UpdateTail (written);
517       current = tmpItem.next;
518     \}
519   \textcolor{comment}{// append new tail.}
520   uint16\_t written = h.AddBig (0xffff, h.m\_tail, item, extraItem);
521   h.UpdateTail (written);
522 
523   *\textcolor{keyword}{this} = h;
524 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 65




Here is the caller graph for this function\+:
% FIG 66


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Reserve@{Reserve}}
\index{Reserve@{Reserve}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Reserve(uint32\+\_\+t n)}{Reserve(uint32_t n)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Reserve (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{n}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a6c58b1e40fee94cdae50c0bf6571bf85}{}\label{classns3_1_1PacketMetadata_a6c58b1e40fee94cdae50c0bf6571bf85}


Reserve space. 


\begin{DoxyParams}{Parameters}
{\em n} & space to reserve \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
100 \{
101   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << size);
102   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} != 0);
103   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a1064e5617aec301dd4f28fb86c105848}{m\_size} >= \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} + size &&
104       (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} == 0xffff ||
105        \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count} == 1 ||
106        \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ae98316cc438fb40663c2f848746d8935}{m\_dirtyEnd} == \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used}))
107     \{
108       \textcolor{comment}{/* enough room, not dirty. */}
109     \}
110   \textcolor{keywordflow}{else} 
111     \{
112       \textcolor{comment}{/* (enough room and dirty) or (not enough room) */}
113       \hyperlink{classns3_1_1PacketMetadata_a18a4039a86f4c212742f6359849ddfd6}{ReserveCopy} (size);
114     \}
115 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 67


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Reserve\+Copy@{Reserve\+Copy}}
\index{Reserve\+Copy@{Reserve\+Copy}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Reserve\+Copy(uint32\+\_\+t n)}{ReserveCopy(uint32_t n)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Reserve\+Copy (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{n}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a18a4039a86f4c212742f6359849ddfd6}{}\label{classns3_1_1PacketMetadata_a18a4039a86f4c212742f6359849ddfd6}


Reserve space and make a metadata copy. 


\begin{DoxyParams}{Parameters}
{\em n} & space to reserve \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
75 \{
76   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << size);
77   \textcolor{keyword}{struct }PacketMetadata::Data *newData = \hyperlink{classns3_1_1PacketMetadata_a94be0cf01bdfdf5dda7ae0afc475dc2a}{PacketMetadata::Create} (
      \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} + size);
78   memcpy (newData->m\_data, \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}, \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used});
79   newData->m\_dirtyEnd = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
80   \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count}--;
81   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ab1fff6472c58d4cbef74f8d78f64f95a}{m\_count} == 0) 
82     \{
83       \hyperlink{classns3_1_1PacketMetadata_ae4bff0e3145f955d12e75531b0be6b7f}{PacketMetadata::Recycle} (\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data});
84     \}
85   \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data} = newData;
86   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} != 0xffff)
87     \{
88       uint8\_t *\hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start};
89       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} != 0xffff);
90       \textcolor{comment}{// clear the next field of the tail}
91       start = &\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}[\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail}];
92       \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (0xffff, start);
93       \textcolor{comment}{// clear the prev field of the head}
94       start = &\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}[\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head}] + 2;
95       \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (0xffff, start);
96     \}
97 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 68




Here is the caller graph for this function\+:
% FIG 69


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Serialize@{Serialize}}
\index{Serialize@{Serialize}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Serialize(uint8\+\_\+t $\ast$buffer, uint32\+\_\+t max\+Size) const }{Serialize(uint8_t *buffer, uint32_t maxSize) const }}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Packet\+Metadata\+::\+Serialize (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{buffer, }
\item[{uint32\+\_\+t}]{max\+Size}
\end{DoxyParamCaption}
) const}\hypertarget{classns3_1_1PacketMetadata_aae036ce6844106a8a3ce88e0e095a7eb}{}\label{classns3_1_1PacketMetadata_aae036ce6844106a8a3ce88e0e095a7eb}


Serialization to raw uint8\+\_\+t$\ast$. 


\begin{DoxyParams}{Parameters}
{\em buffer} & the buffer to serialize to \\
\hline
{\em max\+Size} & the maximum serialization size \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 on success, 0 on failure 
\end{DoxyReturn}

\begin{DoxyCode}
1179 \{
1180   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << &buffer << maxSize);
1181   uint8\_t* \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} = buffer;
1182 
1183   buffer = \hyperlink{classns3_1_1PacketMetadata_af872909b61feca47e71738b83a125b86}{AddToRawU64} (\hyperlink{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{m\_packetUid}, start, buffer, maxSize);
1184   \textcolor{keywordflow}{if} (buffer == 0) 
1185     \{
1186       \textcolor{keywordflow}{return} 0;
1187     \}
1188 
1189   \textcolor{keyword}{struct }PacketMetadata::SmallItem item;
1190   \textcolor{keyword}{struct }PacketMetadata::ExtraItem extraItem;
1191   uint32\_t current = \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head};
1192   \textcolor{keywordflow}{while} (current != 0xffff)
1193     \{
1194       \hyperlink{classns3_1_1PacketMetadata_a3719ad2c32313a9a1c74462322e8b517}{ReadItems} (current, &item, &extraItem);
1195       \hyperlink{group__logging_ga88acd260151caf2db9c0fc84997f45ce}{NS\_LOG\_LOGIC} (\textcolor{stringliteral}{"bytesWritten="} << static\_cast<uint32\_t> (buffer - start) << \textcolor{stringliteral}{", typeUid="}<<
1196                     item.typeUid << \textcolor{stringliteral}{", size="}<<item.size<<\textcolor{stringliteral}{", chunkUid="}<<item.chunkUid<<
1197                     \textcolor{stringliteral}{", fragmentStart="}<<extraItem.fragmentStart<<\textcolor{stringliteral}{", fragmentEnd="}<<
1198                     extraItem.fragmentEnd<< \textcolor{stringliteral}{", packetUid="}<<extraItem.packetUid);
1199 
1200       uint32\_t uid = (item.typeUid & 0xfffffffe) >> 1;
1201       \textcolor{keywordflow}{if} (uid != 0)
1202         \{
1203           TypeId tid;
1204           tid.SetUid (uid);
1205           std::string uidString = tid.GetName ();
1206           uint32\_t uidStringSize = uidString.size ();
1207           buffer = \hyperlink{classns3_1_1PacketMetadata_a5ae4821ac2aae1d62c02243cdd27572a}{AddToRawU32} (uidStringSize, start, buffer, maxSize);
1208           \textcolor{keywordflow}{if} (buffer == 0) 
1209             \{
1210               \textcolor{keywordflow}{return} 0;
1211             \}
1212           buffer = \hyperlink{classns3_1_1PacketMetadata_add5d8a1457ffc3eb6f3453c2ec924726}{AddToRaw} (reinterpret\_cast<const uint8\_t *> (uidString.c\_str ()), 
1213                              uidStringSize, start, buffer, maxSize);
1214           \textcolor{keywordflow}{if} (buffer == 0) 
1215             \{
1216               \textcolor{keywordflow}{return} 0;
1217             \}
1218         \}
1219       \textcolor{keywordflow}{else}
1220         \{
1221           buffer = \hyperlink{classns3_1_1PacketMetadata_a5ae4821ac2aae1d62c02243cdd27572a}{AddToRawU32} (0, start, buffer, maxSize);
1222           \textcolor{keywordflow}{if} (buffer == 0) 
1223             \{
1224               \textcolor{keywordflow}{return} 0;
1225             \}
1226         \}
1227 
1228       uint8\_t isBig = item.typeUid & 0x1;
1229       buffer = \hyperlink{classns3_1_1PacketMetadata_acf61c8b898fa059a3c3de4aa03c8c0c3}{AddToRawU8} (isBig, start, buffer, maxSize);
1230       \textcolor{keywordflow}{if} (buffer == 0) 
1231         \{
1232           \textcolor{keywordflow}{return} 0;
1233         \}
1234 
1235       buffer = \hyperlink{classns3_1_1PacketMetadata_a5ae4821ac2aae1d62c02243cdd27572a}{AddToRawU32} (item.size, start, buffer, maxSize);
1236       \textcolor{keywordflow}{if} (buffer == 0) 
1237         \{
1238           \textcolor{keywordflow}{return} 0;
1239         \}
1240 
1241       buffer = \hyperlink{classns3_1_1PacketMetadata_af48d704fec44aeedcfc257b6eb382e30}{AddToRawU16} (item.chunkUid, start, buffer, maxSize);
1242       \textcolor{keywordflow}{if} (buffer == 0) 
1243         \{
1244           \textcolor{keywordflow}{return} 0;
1245         \}
1246 
1247       buffer = \hyperlink{classns3_1_1PacketMetadata_a5ae4821ac2aae1d62c02243cdd27572a}{AddToRawU32} (extraItem.fragmentStart, start, buffer, maxSize);
1248       \textcolor{keywordflow}{if} (buffer == 0) 
1249         \{
1250           \textcolor{keywordflow}{return} 0;
1251         \}
1252 
1253       buffer = \hyperlink{classns3_1_1PacketMetadata_a5ae4821ac2aae1d62c02243cdd27572a}{AddToRawU32} (extraItem.fragmentEnd, start, buffer, maxSize);
1254       \textcolor{keywordflow}{if} (buffer == 0) 
1255         \{
1256           \textcolor{keywordflow}{return} 0;
1257         \}
1258 
1259       buffer = \hyperlink{classns3_1_1PacketMetadata_af872909b61feca47e71738b83a125b86}{AddToRawU64} (extraItem.packetUid, start, buffer, maxSize);
1260       \textcolor{keywordflow}{if} (buffer == 0) 
1261         \{
1262           \textcolor{keywordflow}{return} 0;
1263         \}
1264 
1265       \textcolor{keywordflow}{if} (current == \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail})
1266         \{
1267           \textcolor{keywordflow}{break};
1268         \}
1269 
1270       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (current != item.next);
1271       current = item.next;
1272     \}
1273 
1274   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (static\_cast<uint32\_t> (buffer - start) == maxSize);
1275   \textcolor{keywordflow}{return} 1;
1276 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 70




Here is the caller graph for this function\+:
% FIG 71


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Update\+Head@{Update\+Head}}
\index{Update\+Head@{Update\+Head}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Update\+Head(uint16\+\_\+t written)}{UpdateHead(uint16_t written)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Update\+Head (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{written}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a3baa0c324423e6fd600b31858aa4ade9}{}\label{classns3_1_1PacketMetadata_a3baa0c324423e6fd600b31858aa4ade9}


Update the head. 


\begin{DoxyParams}{Parameters}
{\em written} & the used bytes \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
349 \{
350   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << written);
351   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} == 0xffff)
352     \{
353       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} == 0xffff);
354       \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
355       \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
356     \} 
357   \textcolor{keywordflow}{else}
358     \{
359       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} != 0xffff);
360       \textcolor{comment}{// overwrite the prev field of the previous head of the list.}
361       uint8\_t *previousHead = &\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}[\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} + 2];
362       \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (\hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used}, previousHead);
363       \textcolor{comment}{// update the head of list to the new node.}
364       \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
365     \}
366   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} != 0xffff);
367   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} != 0xffff);
368   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (written >= 8);
369   \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} += written;
370   \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ae98316cc438fb40663c2f848746d8935}{m\_dirtyEnd} = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
371 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 72




Here is the caller graph for this function\+:
% FIG 73


\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Update\+Tail@{Update\+Tail}}
\index{Update\+Tail@{Update\+Tail}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Update\+Tail(uint16\+\_\+t written)}{UpdateTail(uint16_t written)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Packet\+Metadata\+::\+Update\+Tail (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{written}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_ad975bb9c1c0a6875ccc2309f071c5b55}{}\label{classns3_1_1PacketMetadata_ad975bb9c1c0a6875ccc2309f071c5b55}


Update the tail. 


\begin{DoxyParams}{Parameters}
{\em written} & the used bytes \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
322 \{
323   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << written);
324   \textcolor{keywordflow}{if} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} == 0xffff)
325     \{
326       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} == 0xffff);
327       \hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
328       \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
329     \} 
330   \textcolor{keywordflow}{else}
331     \{
332       \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} != 0xffff);
333       \textcolor{comment}{// overwrite the next field of the previous tail of the list.}
334       uint8\_t *previousTail = &\hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_a98540e1e160a9c59048d4cf615b8e2a2}{m\_data}[\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail}];
335       \hyperlink{classns3_1_1PacketMetadata_ab80adc9c544b0f087715acf15e255707}{Append16} (\hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used}, previousTail);
336       \textcolor{comment}{// update the tail of the list to the new node.}
337       \hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
338     \}
339   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{m\_tail} != 0xffff);
340   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{m\_head} != 0xffff);
341   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (written >= 8);
342   \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used} += written;
343   \hyperlink{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{m\_data}->\hyperlink{structns3_1_1PacketMetadata_1_1Data_ae98316cc438fb40663c2f848746d8935}{m\_dirtyEnd} = \hyperlink{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{m\_used};
344 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 74




Here is the caller graph for this function\+:
% FIG 75




\subsection{Friends And Related Function Documentation}
\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!Item\+Iterator@{Item\+Iterator}}
\index{Item\+Iterator@{Item\+Iterator}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{Item\+Iterator}{ItemIterator}}]{\setlength{\rightskip}{0pt plus 5cm}friend class {\bf Item\+Iterator}\hspace{0.3cm}{\ttfamily [friend]}}\hypertarget{classns3_1_1PacketMetadata_a32606143b9dd3fe0db01264200e27783}{}\label{classns3_1_1PacketMetadata_a32606143b9dd3fe0db01264200e27783}


\subsection{Member Data Documentation}
\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+chunk\+Uid@{m\+\_\+chunk\+Uid}}
\index{m\+\_\+chunk\+Uid@{m\+\_\+chunk\+Uid}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+chunk\+Uid}{m_chunkUid}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t ns3\+::\+Packet\+Metadata\+::m\+\_\+chunk\+Uid = 0\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a98e20e3da84be30e3ff4b1761f215cbd}{}\label{classns3_1_1PacketMetadata_a98e20e3da84be30e3ff4b1761f215cbd}


\hyperlink{classns3_1_1Chunk}{Chunk} Uid. 

\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+data@{m\+\_\+data}}
\index{m\+\_\+data@{m\+\_\+data}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+data}{m_data}}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf Data}$\ast$ ns3\+::\+Packet\+Metadata\+::m\+\_\+data\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}{}\label{classns3_1_1PacketMetadata_a6a7206086aec2a73a094fe072650b9ee}


Metadata storage. 

\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+enable@{m\+\_\+enable}}
\index{m\+\_\+enable@{m\+\_\+enable}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+enable}{m_enable}}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Packet\+Metadata\+::m\+\_\+enable = {\bf false}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}{}\label{classns3_1_1PacketMetadata_a666ea556ffbd8f2226195cde1abe7ae7}


Enable the packet metadata. 

\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+enable\+Checking@{m\+\_\+enable\+Checking}}
\index{m\+\_\+enable\+Checking@{m\+\_\+enable\+Checking}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+enable\+Checking}{m_enableChecking}}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Packet\+Metadata\+::m\+\_\+enable\+Checking = {\bf false}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a3b4333cb8df79817e7ca74de1a090d89}{}\label{classns3_1_1PacketMetadata_a3b4333cb8df79817e7ca74de1a090d89}


Enable the packet metadata checking. 

\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+free\+List@{m\+\_\+free\+List}}
\index{m\+\_\+free\+List@{m\+\_\+free\+List}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+free\+List}{m_freeList}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Packet\+Metadata\+::\+Data\+Free\+List} ns3\+::\+Packet\+Metadata\+::m\+\_\+free\+List\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_aa646ed601542eec6bb98e6219165a7c8}{}\label{classns3_1_1PacketMetadata_aa646ed601542eec6bb98e6219165a7c8}


the metadata data storage 

\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+head@{m\+\_\+head}}
\index{m\+\_\+head@{m\+\_\+head}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+head}{m_head}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t ns3\+::\+Packet\+Metadata\+::m\+\_\+head\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}{}\label{classns3_1_1PacketMetadata_a46b3ef0a9a80a798ad1e81b5694a5658}


list head 

\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+max\+Size@{m\+\_\+max\+Size}}
\index{m\+\_\+max\+Size@{m\+\_\+max\+Size}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+max\+Size}{m_maxSize}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Packet\+Metadata\+::m\+\_\+max\+Size = 0\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_a3816d0a0ab763831fd248b0b2693db1c}{}\label{classns3_1_1PacketMetadata_a3816d0a0ab763831fd248b0b2693db1c}


maximum metadata size 

\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+metadata\+Skipped@{m\+\_\+metadata\+Skipped}}
\index{m\+\_\+metadata\+Skipped@{m\+\_\+metadata\+Skipped}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+metadata\+Skipped}{m_metadataSkipped}}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Packet\+Metadata\+::m\+\_\+metadata\+Skipped = {\bf false}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}{}\label{classns3_1_1PacketMetadata_ac370960e8881e5a7280122e9dc5f7ace}
Set to true when adding metadata to a packet is skipped because m\+\_\+enable is false; used to detect enabling of metadata in the middle of a simulation, which isn\textquotesingle{}t allowed. \index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+packet\+Uid@{m\+\_\+packet\+Uid}}
\index{m\+\_\+packet\+Uid@{m\+\_\+packet\+Uid}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+packet\+Uid}{m_packetUid}}]{\setlength{\rightskip}{0pt plus 5cm}uint64\+\_\+t ns3\+::\+Packet\+Metadata\+::m\+\_\+packet\+Uid\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}{}\label{classns3_1_1PacketMetadata_ad97fbc08482c155bc4c11fdff820be86}


packet Uid 

\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+tail@{m\+\_\+tail}}
\index{m\+\_\+tail@{m\+\_\+tail}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+tail}{m_tail}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t ns3\+::\+Packet\+Metadata\+::m\+\_\+tail\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}{}\label{classns3_1_1PacketMetadata_ad24a659e236af7b98c475c97c4f60db9}


list tail 

\index{ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}!m\+\_\+used@{m\+\_\+used}}
\index{m\+\_\+used@{m\+\_\+used}!ns3\+::\+Packet\+Metadata@{ns3\+::\+Packet\+Metadata}}
\subsubsection[{\texorpdfstring{m\+\_\+used}{m_used}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t ns3\+::\+Packet\+Metadata\+::m\+\_\+used\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}{}\label{classns3_1_1PacketMetadata_afeecb22fe6f3368f3c56bda755892df9}


used portion 



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
network/model/\hyperlink{packet-metadata_8h}{packet-\/metadata.\+h}\item 
network/model/\hyperlink{packet-metadata_8cc}{packet-\/metadata.\+cc}\end{DoxyCompactItemize}
