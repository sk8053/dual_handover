\hypertarget{classLrWpanCollisionTestCase}{}\section{Lr\+Wpan\+Collision\+Test\+Case Class Reference}
\label{classLrWpanCollisionTestCase}\index{Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}}


Lr\+Wpan Collision Test.  




Inheritance diagram for Lr\+Wpan\+Collision\+Test\+Case\+:
% FIG 0


Collaboration diagram for Lr\+Wpan\+Collision\+Test\+Case\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classLrWpanCollisionTestCase_afdc895dfc51296ffae23be652b1e4413}{Lr\+Wpan\+Collision\+Test\+Case} ()
\item 
virtual \hyperlink{classLrWpanCollisionTestCase_a812c9386727c845d84c959f3cc19c04f}{$\sim$\+Lr\+Wpan\+Collision\+Test\+Case} ()
\item 
void \hyperlink{classLrWpanCollisionTestCase_ab8b8d230a2bad7026b0b48a011f7c049}{Data\+Indication} (\hyperlink{structns3_1_1McpsDataIndicationParams}{Mcps\+Data\+Indication\+Params} params, \hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{lte__link__budget__x2__handover__measures_8m_ac9de518908a968428863f829398a4e62}{p})
\begin{DoxyCompactList}\small\item\em Function called when Data\+Indication is hit. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classLrWpanCollisionTestCase_adc8f2378868d9eb3aba9b538897d85d2}{Do\+Run} (void)
\begin{DoxyCompactList}\small\item\em Implementation to actually run this Test\+Case. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\+\_\+rx\+Packets}
\begin{DoxyCompactList}\small\item\em Rx packets counter. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
Lr\+Wpan Collision Test. 

\subsection{Constructor \& Destructor Documentation}
\index{Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}!Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}}
\index{Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}!Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}}
\subsubsection[{\texorpdfstring{Lr\+Wpan\+Collision\+Test\+Case()}{LrWpanCollisionTestCase()}}]{\setlength{\rightskip}{0pt plus 5cm}Lr\+Wpan\+Collision\+Test\+Case\+::\+Lr\+Wpan\+Collision\+Test\+Case (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classLrWpanCollisionTestCase_afdc895dfc51296ffae23be652b1e4413}{}\label{classLrWpanCollisionTestCase_afdc895dfc51296ffae23be652b1e4413}

\begin{DoxyCode}
61   : \hyperlink{classns3_1_1TestCase_a3b0b91a96aac1933e8d146e019b9e207}{TestCase} (\textcolor{stringliteral}{"Test the 802.15.4 collision handling"})
62 \{
63   \hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets} = 0;
64 \}
\end{DoxyCode}
\index{Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}!````~Lr\+Wpan\+Collision\+Test\+Case@{$\sim$\+Lr\+Wpan\+Collision\+Test\+Case}}
\index{````~Lr\+Wpan\+Collision\+Test\+Case@{$\sim$\+Lr\+Wpan\+Collision\+Test\+Case}!Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}}
\subsubsection[{\texorpdfstring{$\sim$\+Lr\+Wpan\+Collision\+Test\+Case()}{~LrWpanCollisionTestCase()}}]{\setlength{\rightskip}{0pt plus 5cm}Lr\+Wpan\+Collision\+Test\+Case\+::$\sim$\+Lr\+Wpan\+Collision\+Test\+Case (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLrWpanCollisionTestCase_a812c9386727c845d84c959f3cc19c04f}{}\label{classLrWpanCollisionTestCase_a812c9386727c845d84c959f3cc19c04f}

\begin{DoxyCode}
67 \{
68 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}!Data\+Indication@{Data\+Indication}}
\index{Data\+Indication@{Data\+Indication}!Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}}
\subsubsection[{\texorpdfstring{Data\+Indication(\+Mcps\+Data\+Indication\+Params params, Ptr$<$ Packet $>$ p)}{DataIndication(McpsDataIndicationParams params, Ptr< Packet > p)}}]{\setlength{\rightskip}{0pt plus 5cm}void Lr\+Wpan\+Collision\+Test\+Case\+::\+Data\+Indication (
\begin{DoxyParamCaption}
\item[{{\bf Mcps\+Data\+Indication\+Params}}]{params, }
\item[{{\bf Ptr}$<$ {\bf Packet} $>$}]{p}
\end{DoxyParamCaption}
)}\hypertarget{classLrWpanCollisionTestCase_ab8b8d230a2bad7026b0b48a011f7c049}{}\label{classLrWpanCollisionTestCase_ab8b8d230a2bad7026b0b48a011f7c049}


Function called when Data\+Indication is hit. 


\begin{DoxyParams}{Parameters}
{\em params} & The M\+C\+PS params. \\
\hline
{\em p} & The packet. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
71 \{
72   \hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets}++;
73 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 2


\index{Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}!Do\+Run@{Do\+Run}}
\index{Do\+Run@{Do\+Run}!Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}}
\subsubsection[{\texorpdfstring{Do\+Run(void)}{DoRun(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void Lr\+Wpan\+Collision\+Test\+Case\+::\+Do\+Run (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [virtual]}}\hypertarget{classLrWpanCollisionTestCase_adc8f2378868d9eb3aba9b538897d85d2}{}\label{classLrWpanCollisionTestCase_adc8f2378868d9eb3aba9b538897d85d2}


Implementation to actually run this Test\+Case. 

Subclasses should override this method to conduct their tests. 

Implements \hyperlink{classns3_1_1TestCase_a8ff74680cf017ed42011e4be51917a24}{ns3\+::\+Test\+Case}.


\begin{DoxyCode}
78 \{
79 
80   \textcolor{comment}{// Create 3 nodes, and a NetDevice for each one}
81   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} n0 = CreateObject <Node> ();
82   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} n1 = CreateObject <Node> ();
83   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} n2 = CreateObject <Node> ();
84 
85   \hyperlink{classns3_1_1Ptr}{Ptr<LrWpanNetDevice>} dev0 = CreateObject<LrWpanNetDevice> ();
86   \hyperlink{classns3_1_1Ptr}{Ptr<LrWpanNetDevice>} dev1 = CreateObject<LrWpanNetDevice> ();
87   \hyperlink{classns3_1_1Ptr}{Ptr<LrWpanNetDevice>} dev2 = CreateObject<LrWpanNetDevice> ();
88 
89   dev0->SetAddress (\hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:01"}));
90   dev1->SetAddress (\hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:02"}));
91   dev2->SetAddress (\hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:03"}));
92 
93   \textcolor{comment}{// Each device must be attached to the same channel}
94   \hyperlink{classns3_1_1Ptr}{Ptr<SingleModelSpectrumChannel>} channel = 
      CreateObject<SingleModelSpectrumChannel> ();
95   \hyperlink{classns3_1_1Ptr}{Ptr<LogDistancePropagationLossModel>} propModel = 
      CreateObject<LogDistancePropagationLossModel> ();
96   \hyperlink{classns3_1_1Ptr}{Ptr<ConstantSpeedPropagationDelayModel>} delayModel = 
      CreateObject<ConstantSpeedPropagationDelayModel> ();
97   channel->\hyperlink{classns3_1_1SingleModelSpectrumChannel_a3d8c68e54e0e7659fdf715260d5613ac}{AddPropagationLossModel} (propModel);
98   channel->\hyperlink{classns3_1_1SingleModelSpectrumChannel_afd757c085623596ebf3da8264cfbaa45}{SetPropagationDelayModel} (delayModel);
99 
100   dev0->SetChannel (channel);
101   dev1->SetChannel (channel);
102   dev2->SetChannel (channel);
103 
104   \textcolor{comment}{// To complete configuration, a LrWpanNetDevice must be added to a node}
105   n0->\hyperlink{classns3_1_1Node_a42ff83ee1d5d1649c770d3f5b62375de}{AddDevice} (dev0);
106   n1->AddDevice (dev1);
107   n2->AddDevice (dev2);
108 
109   \hyperlink{classns3_1_1Ptr}{Ptr<ConstantPositionMobilityModel>} sender0Mobility = 
      CreateObject<ConstantPositionMobilityModel> ();
110   sender0Mobility->\hyperlink{classns3_1_1MobilityModel_ac584b3d5a309709d2f13ed6ada1e7640}{SetPosition} (Vector (0,0,0));
111   dev0->GetPhy ()->SetMobility (sender0Mobility);
112   n0->\hyperlink{classns3_1_1Object_a79dd435d300f3deca814553f561a2922}{AggregateObject} (sender0Mobility);
113 
114   \hyperlink{classns3_1_1Ptr}{Ptr<ConstantPositionMobilityModel>} sender1Mobility = 
      CreateObject<ConstantPositionMobilityModel> ();
115   \textcolor{comment}{// Configure position 10 m distance}
116   sender1Mobility->\hyperlink{classns3_1_1MobilityModel_ac584b3d5a309709d2f13ed6ada1e7640}{SetPosition} (Vector (0,1,0));
117   dev1->GetPhy ()->SetMobility (sender1Mobility);
118   n1->AggregateObject (sender1Mobility);
119 
120   \hyperlink{classns3_1_1Ptr}{Ptr<ConstantPositionMobilityModel>} sender2Mobility = 
      CreateObject<ConstantPositionMobilityModel> ();
121   \textcolor{comment}{// Configure position 10 m distance}
122   sender2Mobility->\hyperlink{classns3_1_1MobilityModel_ac584b3d5a309709d2f13ed6ada1e7640}{SetPosition} (Vector (30,0,0));
123   dev2->GetPhy ()->SetMobility (sender2Mobility);
124   n2->AggregateObject (sender2Mobility);
125 
126   dev0->GetMac ()->SetMcpsDataIndicationCallback (\hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&
      \hyperlink{classLrWpanCollisionTestCase_ab8b8d230a2bad7026b0b48a011f7c049}{LrWpanCollisionTestCase::DataIndication}, \textcolor{keyword}{this}));
127 
128   \textcolor{comment}{// Disable first backoff}
129   dev0->GetCsmaCa ()->SetMacMinBE (0);
130   dev1->GetCsmaCa ()->SetMacMinBE (0);
131   dev2->GetCsmaCa ()->SetMacMinBE (0);
132 
133   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} p0 = Create<Packet> (20);
134   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} p1 = Create<Packet> (60);
135   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} p2 = Create<Packet> (100);
136 
137   \hyperlink{structns3_1_1McpsDataRequestParams}{McpsDataRequestParams} params;
138   params.\hyperlink{structns3_1_1McpsDataRequestParams_a31f4c281d07cf3b5992d45416bd71309}{m\_srcAddrMode} = \hyperlink{group__lr-wpan_gga9ea4702ab11d5329e1593afebce06bbba7bf58267dde39bdabfeeb5793450c5e3}{SHORT\_ADDR};
139   params.m\_dstAddrMode = \hyperlink{group__lr-wpan_gga9ea4702ab11d5329e1593afebce06bbba7bf58267dde39bdabfeeb5793450c5e3}{SHORT\_ADDR};
140   params.m\_dstPanId = 0;
141   params.m\_msduHandle = 0;
142   \textcolor{comment}{// params.m\_txOptions = TX\_OPTION\_ACK;}
143 
144   \textcolor{comment}{// First case: concurrent tx and no ACKs}
145   std::cout << \textcolor{stringliteral}{"*** First test "} << std::endl;
146   \hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets} = 0;
147   params.m\_dstAddr = \hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:02"});
148   Simulator::Schedule (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.1),
149                        &LrWpanMac::McpsDataRequest,
150                        dev0->GetMac (), params, p0);
151 
152   params.m\_dstAddr = \hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:01"});
153   Simulator::Schedule (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.1),
154                        &LrWpanMac::McpsDataRequest,
155                        dev1->GetMac (), params, p1);
156 
157   Simulator::Run ();
158 
159   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (\hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets}, 0, \textcolor{stringliteral}{"Not received a packet (as
       expected)"});
160 
161   \textcolor{comment}{// Second case: concurrent tx and ACKs}
162   std::cout << \textcolor{stringliteral}{"*** Second test "} << std::endl;
163   \hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets} = 0;
164   params.m\_txOptions = \hyperlink{group__lr-wpan_gga74ea891230ebf45d80d69a67266930a4a270a37d12b62bb8b5e92d646456244cf}{TX\_OPTION\_ACK};
165 
166   params.m\_dstAddr = \hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:02"});
167   Simulator::Schedule (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.1),
168                        &LrWpanMac::McpsDataRequest,
169                        dev0->GetMac (), params, p0);
170 
171   params.m\_dstAddr = \hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:01"});
172   Simulator::Schedule (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.1),
173                        &LrWpanMac::McpsDataRequest,
174                        dev1->GetMac (), params, p1);
175 
176   Simulator::Run ();
177 
178   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (\hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets}, 1, \textcolor{stringliteral}{"Received a packet (as expected)"})
      ;
179 
180   \textcolor{comment}{// Third case: two concurrent tx and no ACKs}
181   std::cout << \textcolor{stringliteral}{"*** Third test "} << std::endl;
182   \hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets} = 0;
183   params.m\_txOptions = 0;
184 
185 \textcolor{comment}{//  LogComponentEnable("LrWpanMac",LOG\_LEVEL\_ALL);}
186 \textcolor{comment}{//  LogComponentEnable("LrWpanPhy",LOG\_LEVEL\_ALL);}
187 \textcolor{comment}{//  LogComponentEnableAll (LOG\_PREFIX\_TIME);}
188 
189   params.m\_dstAddr = \hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:01"});
190   Simulator::Schedule (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.0001),
191                        &LrWpanMac::McpsDataRequest,
192                        dev2->GetMac (), params, p2);
193 
194   params.m\_dstAddr = \hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:01"});
195   Simulator::Schedule (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.0002),
196                        &LrWpanMac::McpsDataRequest,
197                        dev1->GetMac (), params, p0);
198 
199   Simulator::Run ();
200 
201   std::cout << \textcolor{stringliteral}{"m\_rxPackets = "} << int(\hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets}) << std::endl;
202   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (\hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets}, 1, \textcolor{stringliteral}{"Received a packet (as expected)"})
      ;
203 
204   \textcolor{comment}{// Fourth case: two concurrent tx and ACKs}
205   std::cout << \textcolor{stringliteral}{"*** Fourth test "} << std::endl;
206   \hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets} = 0;
207   params.m\_txOptions = \hyperlink{group__lr-wpan_gga74ea891230ebf45d80d69a67266930a4a270a37d12b62bb8b5e92d646456244cf}{TX\_OPTION\_ACK};
208 
209   params.m\_dstAddr = \hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:01"});
210   Simulator::Schedule (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.1),
211                        &LrWpanMac::McpsDataRequest,
212                        dev1->GetMac (), params, p0);
213 
214   params.m\_dstAddr = \hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:01"});
215   Simulator::Schedule (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.1),
216                        &LrWpanMac::McpsDataRequest,
217                        dev2->GetMac (), params, p1);
218 
219   Simulator::Run ();
220 
221   std::cout << \textcolor{stringliteral}{"m\_rxPackets = "} << int(\hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets}) << std::endl;
222   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (\hyperlink{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{m\_rxPackets}, 2, \textcolor{stringliteral}{"Received two packets (as
       expected)"});
223 
224   Simulator::Destroy ();
225 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 3




\subsection{Member Data Documentation}
\index{Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}!m\+\_\+rx\+Packets@{m\+\_\+rx\+Packets}}
\index{m\+\_\+rx\+Packets@{m\+\_\+rx\+Packets}!Lr\+Wpan\+Collision\+Test\+Case@{Lr\+Wpan\+Collision\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+rx\+Packets}{m_rxPackets}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t Lr\+Wpan\+Collision\+Test\+Case\+::m\+\_\+rx\+Packets\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}{}\label{classLrWpanCollisionTestCase_a99c5c25759f67c884349444a74a86186}


Rx packets counter. 



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
lr-\/wpan/test/\hyperlink{lr-wpan-collision-test_8cc}{lr-\/wpan-\/collision-\/test.\+cc}\end{DoxyCompactItemize}
