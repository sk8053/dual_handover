\hypertarget{classTcpBytesInFlightTest}{}\section{Tcp\+Bytes\+In\+Flight\+Test Class Reference}
\label{classTcpBytesInFlightTest}\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}


Check the value of Bytes\+In\+Flight against a home-\/made guess.  




Inheritance diagram for Tcp\+Bytes\+In\+Flight\+Test\+:
% FIG 0


Collaboration diagram for Tcp\+Bytes\+In\+Flight\+Test\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classTcpBytesInFlightTest_a99631410cdfe9e356ca02d382e88ad95}{Tcp\+Bytes\+In\+Flight\+Test} (const std\+::string \&desc, std\+::vector$<$ uint32\+\_\+t $>$ \&to\+Drop)
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual \hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1ErrorModel}{Error\+Model} $>$ \hyperlink{classTcpBytesInFlightTest_a1942203532d11a2136fe0369fd7385fc}{Create\+Receiver\+Error\+Model} ()
\begin{DoxyCompactList}\small\item\em Create a receiver error model. \end{DoxyCompactList}\item 
virtual void \hyperlink{classTcpBytesInFlightTest_acad5e29de044d21893d2184584600ae5}{Rx} (const \hyperlink{classns3_1_1Ptr}{Ptr}$<$ const \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{lte__link__budget__x2__handover__measures_8m_ac9de518908a968428863f829398a4e62}{p}, const \hyperlink{classns3_1_1TcpHeader}{Tcp\+Header} \&h, \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6ee}{Socket\+Who} who)
\begin{DoxyCompactList}\small\item\em Receive a packet. \end{DoxyCompactList}\item 
virtual void \hyperlink{classTcpBytesInFlightTest_a37c2f7368197bb44614a58e577929f3b}{Tx} (const \hyperlink{classns3_1_1Ptr}{Ptr}$<$ const \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{lte__link__budget__x2__handover__measures_8m_ac9de518908a968428863f829398a4e62}{p}, const \hyperlink{classns3_1_1TcpHeader}{Tcp\+Header} \&h, \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6ee}{Socket\+Who} who)
\begin{DoxyCompactList}\small\item\em Transmit a packet. \end{DoxyCompactList}\item 
virtual void \hyperlink{classTcpBytesInFlightTest_a916289d6366ede554cc78f9c706c6e56}{Bytes\+In\+Flight\+Trace} (uint32\+\_\+t old\+Value, uint32\+\_\+t new\+Value)
\begin{DoxyCompactList}\small\item\em Track the bytes in flight. \end{DoxyCompactList}\item 
void \hyperlink{classTcpBytesInFlightTest_a8f1210443f618fcb98db05c47b992b4d}{Pkt\+Dropped} (const \hyperlink{classns3_1_1Ipv4Header}{Ipv4\+Header} \&ipH, const \hyperlink{classns3_1_1TcpHeader}{Tcp\+Header} \&tcpH, \hyperlink{classns3_1_1Ptr}{Ptr}$<$ const \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{lte__link__budget__x2__handover__measures_8m_ac9de518908a968428863f829398a4e62}{p})
\begin{DoxyCompactList}\small\item\em Called when a packet is dropped. \end{DoxyCompactList}\item 
void \hyperlink{classTcpBytesInFlightTest_a09c98c951bad56eff605cffc7f52081d}{Configure\+Environment} ()
\begin{DoxyCompactList}\small\item\em Configure the test. \end{DoxyCompactList}\item 
void \hyperlink{classTcpBytesInFlightTest_a7e615ecdc1d3f989ab19dbaaa7752637}{Before\+R\+T\+O\+Expired} (const \hyperlink{classns3_1_1Ptr}{Ptr}$<$ const \hyperlink{classns3_1_1TcpSocketState}{Tcp\+Socket\+State} $>$ tcb, \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6ee}{Socket\+Who} who)
\begin{DoxyCompactList}\small\item\em Do the checks before the R\+TO expires. \end{DoxyCompactList}\item 
void \hyperlink{classTcpBytesInFlightTest_a7396d525e35a495f132c89cc77735fec}{Final\+Checks} ()
\begin{DoxyCompactList}\small\item\em Do the final checks. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
uint32\+\_\+t \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\+\_\+guessed\+Bytes\+In\+Flight}
\begin{DoxyCompactList}\small\item\em Guessed bytes in flight. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{classTcpBytesInFlightTest_ab641cde492bd6498f83d5b54e0210554}{m\+\_\+dup\+Ack\+Recv}
\begin{DoxyCompactList}\small\item\em Number of Dup\+A\+C\+Ks received. \end{DoxyCompactList}\item 
\hyperlink{group__network_gacb2070e4e98d2d5135c9bede58f07a03}{Sequence\+Number32} \hyperlink{classTcpBytesInFlightTest_a69ac0a58e163339be5082e44e0e74abe}{m\+\_\+last\+Ack\+Recv}
\begin{DoxyCompactList}\small\item\em Last A\+CK received. \end{DoxyCompactList}\item 
\hyperlink{group__network_gacb2070e4e98d2d5135c9bede58f07a03}{Sequence\+Number32} \hyperlink{classTcpBytesInFlightTest_afc1cef29d8e27173973250647069060c}{m\+\_\+greatest\+Seq\+Sent}
\begin{DoxyCompactList}\small\item\em greatest sequence number sent. \end{DoxyCompactList}\item 
std\+::vector$<$ uint32\+\_\+t $>$ \hyperlink{classTcpBytesInFlightTest_a07a49022311b5cede6d01eef26ba3f33}{m\+\_\+to\+Drop}
\begin{DoxyCompactList}\small\item\em List of Sequence\+Number to drop. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
Check the value of Bytes\+In\+Flight against a home-\/made guess. 

The guess is made wrt to segments that travel the network; we have, in theory, the possibility to know the real amount of bytes in flight. However this value is useless, since the sender bases its guess on the received A\+CK.

\begin{DoxySeeAlso}{See also}
\hyperlink{classTcpBytesInFlightTest_a37c2f7368197bb44614a58e577929f3b}{Tx} 

\hyperlink{classTcpBytesInFlightTest_a916289d6366ede554cc78f9c706c6e56}{Bytes\+In\+Flight\+Trace} 
\end{DoxySeeAlso}


\subsection{Constructor \& Destructor Documentation}
\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{Tcp\+Bytes\+In\+Flight\+Test(const std\+::string \&desc, std\+::vector$<$ uint32\+\_\+t $>$ \&to\+Drop)}{TcpBytesInFlightTest(const std::string &desc, std::vector< uint32_t > &toDrop)}}]{\setlength{\rightskip}{0pt plus 5cm}Tcp\+Bytes\+In\+Flight\+Test\+::\+Tcp\+Bytes\+In\+Flight\+Test (
\begin{DoxyParamCaption}
\item[{const std\+::string \&}]{desc, }
\item[{std\+::vector$<$ uint32\+\_\+t $>$ \&}]{to\+Drop}
\end{DoxyParamCaption}
)}\hypertarget{classTcpBytesInFlightTest_a99631410cdfe9e356ca02d382e88ad95}{}\label{classTcpBytesInFlightTest_a99631410cdfe9e356ca02d382e88ad95}


Constructor. 


\begin{DoxyParams}{Parameters}
{\em desc} & Description. \\
\hline
{\em to\+Drop} & Packets to drop. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
115   : \hyperlink{classns3_1_1TcpGeneralTest_aed700e733bc50b1e736cb52c0b71f3f8}{TcpGeneralTest} (desc),
116     \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight} (0),
117     \hyperlink{classTcpBytesInFlightTest_ab641cde492bd6498f83d5b54e0210554}{m\_dupAckRecv} (0),
118     \hyperlink{classTcpBytesInFlightTest_a69ac0a58e163339be5082e44e0e74abe}{m\_lastAckRecv} (1),
119     \hyperlink{classTcpBytesInFlightTest_afc1cef29d8e27173973250647069060c}{m\_greatestSeqSent} (0),
120     \hyperlink{classTcpBytesInFlightTest_a07a49022311b5cede6d01eef26ba3f33}{m\_toDrop} (toDrop)
121 \{
122 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!Before\+R\+T\+O\+Expired@{Before\+R\+T\+O\+Expired}}
\index{Before\+R\+T\+O\+Expired@{Before\+R\+T\+O\+Expired}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{Before\+R\+T\+O\+Expired(const Ptr$<$ const Tcp\+Socket\+State $>$ tcb, Socket\+Who who)}{BeforeRTOExpired(const Ptr< const TcpSocketState > tcb, SocketWho who)}}]{\setlength{\rightskip}{0pt plus 5cm}void Tcp\+Bytes\+In\+Flight\+Test\+::\+Before\+R\+T\+O\+Expired (
\begin{DoxyParamCaption}
\item[{const {\bf Ptr}$<$ const {\bf Tcp\+Socket\+State} $>$}]{tcb, }
\item[{{\bf Socket\+Who}}]{who}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\hypertarget{classTcpBytesInFlightTest_a7e615ecdc1d3f989ab19dbaaa7752637}{}\label{classTcpBytesInFlightTest_a7e615ecdc1d3f989ab19dbaaa7752637}


Do the checks before the R\+TO expires. 


\begin{DoxyParams}{Parameters}
{\em tcb} & The Tcp\+Socket\+State. \\
\hline
{\em who} & The socket. \\
\hline
\end{DoxyParams}


Reimplemented from \hyperlink{classns3_1_1TcpGeneralTest_a55d17115937d7461d2ec28cea2513e0d}{ns3\+::\+Tcp\+General\+Test}.


\begin{DoxyCode}
151 \{
152   \hyperlink{group__logging_ga413f1886406d49f59a6a0a89b77b4d0a}{NS\_LOG\_DEBUG} (\textcolor{stringliteral}{"RTO for "} << who);
153 
154   \textcolor{comment}{// Reset the bytes in flight}
155   \textcolor{comment}{// NB: If in the future informations about SACK is maintained, this should be}
156   \textcolor{comment}{// rewritten}
157 
158   \textcolor{keywordflow}{if} (who == \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6eea5400e3d6b26928cf9e67ebb026462256}{SENDER})
159     \{
160       \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight} = 0;
161     \}
162 \}
\end{DoxyCode}
\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!Bytes\+In\+Flight\+Trace@{Bytes\+In\+Flight\+Trace}}
\index{Bytes\+In\+Flight\+Trace@{Bytes\+In\+Flight\+Trace}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{Bytes\+In\+Flight\+Trace(uint32\+\_\+t old\+Value, uint32\+\_\+t new\+Value)}{BytesInFlightTrace(uint32_t oldValue, uint32_t newValue)}}]{\setlength{\rightskip}{0pt plus 5cm}void Tcp\+Bytes\+In\+Flight\+Test\+::\+Bytes\+In\+Flight\+Trace (
\begin{DoxyParamCaption}
\item[{uint32\+\_\+t}]{old\+Value, }
\item[{uint32\+\_\+t}]{new\+Value}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\hypertarget{classTcpBytesInFlightTest_a916289d6366ede554cc78f9c706c6e56}{}\label{classTcpBytesInFlightTest_a916289d6366ede554cc78f9c706c6e56}


Track the bytes in flight. 


\begin{DoxyParams}{Parameters}
{\em old\+Value} & previous value. \\
\hline
{\em new\+Value} & actual value. \\
\hline
\end{DoxyParams}


Reimplemented from \hyperlink{classns3_1_1TcpGeneralTest_a5783fc6fc5d13a826554e91986927efc}{ns3\+::\+Tcp\+General\+Test}.


\begin{DoxyCode}
270 \{
271   \hyperlink{group__logging_ga413f1886406d49f59a6a0a89b77b4d0a}{NS\_LOG\_DEBUG} (\textcolor{stringliteral}{"Socket BytesInFlight="} << newValue <<
272                 \textcolor{stringliteral}{" mine is="} << \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight});
273   \hyperlink{group__testing_ga2a9d78cffb3db8e867c35fff0b698cf5}{NS\_TEST\_ASSERT\_MSG\_EQ} (\hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight}, newValue,
274                          \textcolor{stringliteral}{"Guessed and measured bytes in flight differs"});
275 \}
\end{DoxyCode}
\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!Configure\+Environment@{Configure\+Environment}}
\index{Configure\+Environment@{Configure\+Environment}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{Configure\+Environment()}{ConfigureEnvironment()}}]{\setlength{\rightskip}{0pt plus 5cm}void Tcp\+Bytes\+In\+Flight\+Test\+::\+Configure\+Environment (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\hypertarget{classTcpBytesInFlightTest_a09c98c951bad56eff605cffc7f52081d}{}\label{classTcpBytesInFlightTest_a09c98c951bad56eff605cffc7f52081d}


Configure the test. 



Reimplemented from \hyperlink{classns3_1_1TcpGeneralTest_abd4e42807a8d2b13dcd207131af12c3b}{ns3\+::\+Tcp\+General\+Test}.


\begin{DoxyCode}
126 \{
127   TcpGeneralTest::ConfigureEnvironment ();
128   \hyperlink{classns3_1_1TcpGeneralTest_a256c8df5966f89ed0acfc966cd5d3898}{SetAppPktCount} (30);
129   \hyperlink{classns3_1_1TcpGeneralTest_a167056795264e377b425cdac2441b263}{SetPropagationDelay} (\hyperlink{group__timecivil_gaf26127cf4571146b83a92ee18679c7a9}{MilliSeconds} (50));
130   \hyperlink{classns3_1_1TcpGeneralTest_af8d94d931bd7377ff0267a7ce1edc74d}{SetTransmitStart} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (2.0));
131 
132   \hyperlink{group__config_ga2e7882df849d8ba4aaad31c934c40c06}{Config::SetDefault} (\textcolor{stringliteral}{"ns3::TcpSocketBase::Sack"}, \hyperlink{classns3_1_1BooleanValue}{BooleanValue} (\textcolor{keyword}{false}));
133 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2


\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!Create\+Receiver\+Error\+Model@{Create\+Receiver\+Error\+Model}}
\index{Create\+Receiver\+Error\+Model@{Create\+Receiver\+Error\+Model}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{Create\+Receiver\+Error\+Model()}{CreateReceiverErrorModel()}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<$ {\bf Error\+Model} $>$ Tcp\+Bytes\+In\+Flight\+Test\+::\+Create\+Receiver\+Error\+Model (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\hypertarget{classTcpBytesInFlightTest_a1942203532d11a2136fe0369fd7385fc}{}\label{classTcpBytesInFlightTest_a1942203532d11a2136fe0369fd7385fc}


Create a receiver error model. 

\begin{DoxyReturn}{Returns}
The receiver error model. 
\end{DoxyReturn}


Reimplemented from \hyperlink{classns3_1_1TcpGeneralTest_a256082023d4a67738c946d66c175a6d9}{ns3\+::\+Tcp\+General\+Test}.


\begin{DoxyCode}
137 \{
138   \hyperlink{classns3_1_1Ptr}{Ptr<TcpSeqErrorModel>} m\_errorModel = CreateObject<TcpSeqErrorModel> ();
139   \textcolor{keywordflow}{for} (std::vector<uint32\_t>::iterator it = \hyperlink{classTcpBytesInFlightTest_a07a49022311b5cede6d01eef26ba3f33}{m\_toDrop}.begin (); it != 
      \hyperlink{classTcpBytesInFlightTest_a07a49022311b5cede6d01eef26ba3f33}{m\_toDrop}.end (); ++it)
140     \{
141       m\_errorModel->\hyperlink{classns3_1_1TcpSeqErrorModel_a5c414ce6277ae9ff84decb83a0847386}{AddSeqToKill} (\hyperlink{classns3_1_1SequenceNumber}{SequenceNumber32} (*it));
142     \}
143 
144   m\_errorModel->\hyperlink{classns3_1_1TcpGeneralErrorModel_a812f8d0b0eaf4508efd44be00028673f}{SetDropCallback} (\hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&
      \hyperlink{classTcpBytesInFlightTest_a8f1210443f618fcb98db05c47b992b4d}{TcpBytesInFlightTest::PktDropped}, \textcolor{keyword}{this}));
145 
146   \textcolor{keywordflow}{return} m\_errorModel;
147 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 3


\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!Final\+Checks@{Final\+Checks}}
\index{Final\+Checks@{Final\+Checks}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{Final\+Checks()}{FinalChecks()}}]{\setlength{\rightskip}{0pt plus 5cm}void Tcp\+Bytes\+In\+Flight\+Test\+::\+Final\+Checks (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\hypertarget{classTcpBytesInFlightTest_a7396d525e35a495f132c89cc77735fec}{}\label{classTcpBytesInFlightTest_a7396d525e35a495f132c89cc77735fec}


Do the final checks. 



Reimplemented from \hyperlink{classns3_1_1TcpGeneralTest_ada871cedd37de404288f163b6f8dea39}{ns3\+::\+Tcp\+General\+Test}.


\begin{DoxyCode}
279 \{
280   \hyperlink{group__testing_ga2a9d78cffb3db8e867c35fff0b698cf5}{NS\_TEST\_ASSERT\_MSG\_EQ} (\hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight}, 0,
281                          \textcolor{stringliteral}{"Still present bytes in flight at the end of the transmission"});
282 \}
\end{DoxyCode}
\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!Pkt\+Dropped@{Pkt\+Dropped}}
\index{Pkt\+Dropped@{Pkt\+Dropped}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{Pkt\+Dropped(const Ipv4\+Header \&ip\+H, const Tcp\+Header \&tcp\+H, Ptr$<$ const Packet $>$ p)}{PktDropped(const Ipv4Header &ipH, const TcpHeader &tcpH, Ptr< const Packet > p)}}]{\setlength{\rightskip}{0pt plus 5cm}void Tcp\+Bytes\+In\+Flight\+Test\+::\+Pkt\+Dropped (
\begin{DoxyParamCaption}
\item[{const {\bf Ipv4\+Header} \&}]{ipH, }
\item[{const {\bf Tcp\+Header} \&}]{tcpH, }
\item[{{\bf Ptr}$<$ const {\bf Packet} $>$}]{p}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}}\hypertarget{classTcpBytesInFlightTest_a8f1210443f618fcb98db05c47b992b4d}{}\label{classTcpBytesInFlightTest_a8f1210443f618fcb98db05c47b992b4d}


Called when a packet is dropped. 


\begin{DoxyParams}{Parameters}
{\em ipH} & The IP header. \\
\hline
{\em tcpH} & The T\+CP header. \\
\hline
{\em p} & The packet. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
167 \{
168   \hyperlink{group__logging_ga413f1886406d49f59a6a0a89b77b4d0a}{NS\_LOG\_DEBUG} (\textcolor{stringliteral}{"Drop seq= "} << tcpH.\hyperlink{classns3_1_1TcpHeader_a1081077eaf9bc64e9af909cebd128ae5}{GetSequenceNumber} () << \textcolor{stringliteral}{" size "} << p->
      \hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} ());
169 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 4




Here is the caller graph for this function\+:
% FIG 5


\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!Rx@{Rx}}
\index{Rx@{Rx}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{Rx(const Ptr$<$ const Packet $>$ p, const Tcp\+Header \&h, Socket\+Who who)}{Rx(const Ptr< const Packet > p, const TcpHeader &h, SocketWho who)}}]{\setlength{\rightskip}{0pt plus 5cm}void Tcp\+Bytes\+In\+Flight\+Test\+::\+Rx (
\begin{DoxyParamCaption}
\item[{const {\bf Ptr}$<$ const {\bf Packet} $>$}]{p, }
\item[{const {\bf Tcp\+Header} \&}]{h, }
\item[{{\bf Socket\+Who}}]{who}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\hypertarget{classTcpBytesInFlightTest_acad5e29de044d21893d2184584600ae5}{}\label{classTcpBytesInFlightTest_acad5e29de044d21893d2184584600ae5}


Receive a packet. 


\begin{DoxyParams}{Parameters}
{\em p} & The packet. \\
\hline
{\em h} & The T\+CP header. \\
\hline
{\em who} & Who the socket belongs to (sender or receiver). \\
\hline
\end{DoxyParams}


Reimplemented from \hyperlink{classns3_1_1TcpGeneralTest_ab4744fb3cbeb09405e2debc943c01c3a}{ns3\+::\+Tcp\+General\+Test}.


\begin{DoxyCode}
173 \{
174   \textcolor{keywordflow}{if} (who == \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6eea2a9a39a8fe1edd25b643a48956b8ecff}{RECEIVER})
175     \{
176     \}
177   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (who == \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6eea5400e3d6b26928cf9e67ebb026462256}{SENDER})
178     \{
179       \textcolor{keywordflow}{if} (h.\hyperlink{classns3_1_1TcpHeader_a76e832a86b88ffd2f23c2e246b8fa0f3}{GetAckNumber} () > \hyperlink{classTcpBytesInFlightTest_a69ac0a58e163339be5082e44e0e74abe}{m\_lastAckRecv})
180         \{ \textcolor{comment}{// New ack}
181           uint32\_t diff = h.\hyperlink{classns3_1_1TcpHeader_a76e832a86b88ffd2f23c2e246b8fa0f3}{GetAckNumber} () - \hyperlink{classTcpBytesInFlightTest_a69ac0a58e163339be5082e44e0e74abe}{m\_lastAckRecv};
182           \hyperlink{group__logging_ga413f1886406d49f59a6a0a89b77b4d0a}{NS\_LOG\_DEBUG} (\textcolor{stringliteral}{"Recv ACK="} << h.\hyperlink{classns3_1_1TcpHeader_a76e832a86b88ffd2f23c2e246b8fa0f3}{GetAckNumber} ());
183 
184           \textcolor{keywordflow}{if} (\hyperlink{classTcpBytesInFlightTest_ab641cde492bd6498f83d5b54e0210554}{m\_dupAckRecv} > 0)
185             \{ \textcolor{comment}{// Previously we got some ACKs}
186               \textcolor{keywordflow}{if} (h.\hyperlink{classns3_1_1TcpHeader_a76e832a86b88ffd2f23c2e246b8fa0f3}{GetAckNumber} () >= \hyperlink{classTcpBytesInFlightTest_afc1cef29d8e27173973250647069060c}{m\_greatestSeqSent})
187                 \{ \textcolor{comment}{// This an ACK which acknowledge all the window}
188                   diff -= (\hyperlink{classTcpBytesInFlightTest_ab641cde492bd6498f83d5b54e0210554}{m\_dupAckRecv} * \hyperlink{classns3_1_1TcpGeneralTest_aa582b6345d877750962fc34012c9e20a}{GetSegSize} (
      \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6eea5400e3d6b26928cf9e67ebb026462256}{SENDER}));
189 
190                   \textcolor{keywordflow}{if} (diff > \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight})
191                     \{
192                       \textcolor{comment}{// Our home-made guess is influenced also by retransmission}
193                       \textcolor{comment}{// so make sure that this does not overflow}
194                       diff = \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight};
195                     \}
196 
197                   \hyperlink{classTcpBytesInFlightTest_ab641cde492bd6498f83d5b54e0210554}{m\_dupAckRecv} = 0;
198                 \}
199               \textcolor{keywordflow}{else}
200                 \{
201                   \textcolor{comment}{// Partial ACK: Update the dupAck received count}
202                   \hyperlink{classTcpBytesInFlightTest_ab641cde492bd6498f83d5b54e0210554}{m\_dupAckRecv} -= diff / \hyperlink{classns3_1_1TcpGeneralTest_aa582b6345d877750962fc34012c9e20a}{GetSegSize} (
      \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6eea5400e3d6b26928cf9e67ebb026462256}{SENDER});
203                 \}
204             \}
205 
206           \textcolor{keywordflow}{if} ((h.\hyperlink{classns3_1_1TcpHeader_a0d04c5620ee147d4e01d56b9530e8db1}{GetFlags} () & TcpHeader::FIN) != 0
207               || \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight} + 1 == diff)
208             \{ \textcolor{comment}{// received the ACK for the FIN (which includes 1 spurious byte)}
209               diff -= 1;
210             \}
211           \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight} -= diff;
212           \hyperlink{classTcpBytesInFlightTest_a69ac0a58e163339be5082e44e0e74abe}{m\_lastAckRecv} = h.\hyperlink{classns3_1_1TcpHeader_a76e832a86b88ffd2f23c2e246b8fa0f3}{GetAckNumber} ();
213           \hyperlink{group__logging_ga413f1886406d49f59a6a0a89b77b4d0a}{NS\_LOG\_DEBUG} (\textcolor{stringliteral}{"Update m\_guessedBytesInFlight to "} <<
214                         \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight});
215         \}
216       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (h.\hyperlink{classns3_1_1TcpHeader_a76e832a86b88ffd2f23c2e246b8fa0f3}{GetAckNumber} () == \hyperlink{classTcpBytesInFlightTest_a69ac0a58e163339be5082e44e0e74abe}{m\_lastAckRecv}
217                && \hyperlink{classTcpBytesInFlightTest_a69ac0a58e163339be5082e44e0e74abe}{m\_lastAckRecv} != \hyperlink{group__network_gacb2070e4e98d2d5135c9bede58f07a03}{SequenceNumber32} (1)
218                && (h.\hyperlink{classns3_1_1TcpHeader_a0d04c5620ee147d4e01d56b9530e8db1}{GetFlags} () & TcpHeader::FIN) == 0)
219         \{
220           \textcolor{comment}{// For each dupack I should guess that a segment has been received}
221           \textcolor{comment}{// Please do not count FIN and SYN/ACK as dupacks}
222           \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight} -= \hyperlink{classns3_1_1TcpGeneralTest_aa582b6345d877750962fc34012c9e20a}{GetSegSize} (
      \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6eea5400e3d6b26928cf9e67ebb026462256}{SENDER});
223           \hyperlink{classTcpBytesInFlightTest_ab641cde492bd6498f83d5b54e0210554}{m\_dupAckRecv}++;
224           \textcolor{comment}{// RFC 6675 says after two dupacks, the segment is considered lost}
225           \textcolor{keywordflow}{if} (\hyperlink{classTcpBytesInFlightTest_ab641cde492bd6498f83d5b54e0210554}{m\_dupAckRecv} == 3)
226             \{
227               \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight} -= \hyperlink{classns3_1_1TcpGeneralTest_aa582b6345d877750962fc34012c9e20a}{GetSegSize} (
      \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6eea5400e3d6b26928cf9e67ebb026462256}{SENDER});
228               \hyperlink{group__logging_ga413f1886406d49f59a6a0a89b77b4d0a}{NS\_LOG\_DEBUG} (\textcolor{stringliteral}{"Loss of a segment detected"});
229             \}
230           \hyperlink{group__logging_ga413f1886406d49f59a6a0a89b77b4d0a}{NS\_LOG\_DEBUG} (\textcolor{stringliteral}{"Dupack received, Update m\_guessedBytesInFlight to "} <<
231                         \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight});
232         \}
233 
234     \}
235 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 6


\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!Tx@{Tx}}
\index{Tx@{Tx}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{Tx(const Ptr$<$ const Packet $>$ p, const Tcp\+Header \&h, Socket\+Who who)}{Tx(const Ptr< const Packet > p, const TcpHeader &h, SocketWho who)}}]{\setlength{\rightskip}{0pt plus 5cm}void Tcp\+Bytes\+In\+Flight\+Test\+::\+Tx (
\begin{DoxyParamCaption}
\item[{const {\bf Ptr}$<$ const {\bf Packet} $>$}]{p, }
\item[{const {\bf Tcp\+Header} \&}]{h, }
\item[{{\bf Socket\+Who}}]{who}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [protected]}, {\ttfamily [virtual]}}\hypertarget{classTcpBytesInFlightTest_a37c2f7368197bb44614a58e577929f3b}{}\label{classTcpBytesInFlightTest_a37c2f7368197bb44614a58e577929f3b}


Transmit a packet. 


\begin{DoxyParams}{Parameters}
{\em p} & The packet. \\
\hline
{\em h} & The T\+CP header. \\
\hline
{\em who} & Who the socket belongs to (sender or receiver). \\
\hline
\end{DoxyParams}


Reimplemented from \hyperlink{classns3_1_1TcpGeneralTest_ae3ae1d4a08bd0337cf66ef34d4771d89}{ns3\+::\+Tcp\+General\+Test}.


\begin{DoxyCode}
239 \{
240   \textcolor{keywordflow}{if} (who == \hyperlink{classns3_1_1TcpGeneralTest_a29338e6b7137cad650c2ff835713f6eea5400e3d6b26928cf9e67ebb026462256}{SENDER})
241     \{
242       \textcolor{keyword}{static} \hyperlink{classns3_1_1SequenceNumber}{SequenceNumber32} retr = \hyperlink{group__network_gacb2070e4e98d2d5135c9bede58f07a03}{SequenceNumber32} (0);
243       \textcolor{keyword}{static} uint32\_t times = 0;
244 
245       \textcolor{keywordflow}{if} (\hyperlink{classTcpBytesInFlightTest_afc1cef29d8e27173973250647069060c}{m\_greatestSeqSent} <= h.\hyperlink{classns3_1_1TcpHeader_a1081077eaf9bc64e9af909cebd128ae5}{GetSequenceNumber} ())
246         \{ \textcolor{comment}{// This is not a retransmission}
247           \hyperlink{classTcpBytesInFlightTest_afc1cef29d8e27173973250647069060c}{m\_greatestSeqSent} = h.\hyperlink{classns3_1_1TcpHeader_a1081077eaf9bc64e9af909cebd128ae5}{GetSequenceNumber} ();
248           times = 0;
249         \}
250 
251       \textcolor{keywordflow}{if} (retr == h.\hyperlink{classns3_1_1TcpHeader_a1081077eaf9bc64e9af909cebd128ae5}{GetSequenceNumber} ())
252         \{
253           ++times;
254         \}
255 
256       \textcolor{keywordflow}{if} (times < 2)
257         \{
258           \textcolor{comment}{// count retransmission only one time}
259           \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight} += p->\hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} ();
260         \}
261        retr = h.\hyperlink{classns3_1_1TcpHeader_a1081077eaf9bc64e9af909cebd128ae5}{GetSequenceNumber} ();
262 
263       \hyperlink{group__logging_ga413f1886406d49f59a6a0a89b77b4d0a}{NS\_LOG\_DEBUG} (\textcolor{stringliteral}{"TX size="} << p->\hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} () << \textcolor{stringliteral}{" seq="} << h.
      \hyperlink{classns3_1_1TcpHeader_a1081077eaf9bc64e9af909cebd128ae5}{GetSequenceNumber} () <<
264                     \textcolor{stringliteral}{" m\_guessedBytesInFlight="} << \hyperlink{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{m\_guessedBytesInFlight});
265     \}
266 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 7




\subsection{Member Data Documentation}
\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!m\+\_\+dup\+Ack\+Recv@{m\+\_\+dup\+Ack\+Recv}}
\index{m\+\_\+dup\+Ack\+Recv@{m\+\_\+dup\+Ack\+Recv}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+dup\+Ack\+Recv}{m_dupAckRecv}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t Tcp\+Bytes\+In\+Flight\+Test\+::m\+\_\+dup\+Ack\+Recv\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classTcpBytesInFlightTest_ab641cde492bd6498f83d5b54e0210554}{}\label{classTcpBytesInFlightTest_ab641cde492bd6498f83d5b54e0210554}


Number of Dup\+A\+C\+Ks received. 

\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!m\+\_\+greatest\+Seq\+Sent@{m\+\_\+greatest\+Seq\+Sent}}
\index{m\+\_\+greatest\+Seq\+Sent@{m\+\_\+greatest\+Seq\+Sent}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+greatest\+Seq\+Sent}{m_greatestSeqSent}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Sequence\+Number32} Tcp\+Bytes\+In\+Flight\+Test\+::m\+\_\+greatest\+Seq\+Sent\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classTcpBytesInFlightTest_afc1cef29d8e27173973250647069060c}{}\label{classTcpBytesInFlightTest_afc1cef29d8e27173973250647069060c}


greatest sequence number sent. 

\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!m\+\_\+guessed\+Bytes\+In\+Flight@{m\+\_\+guessed\+Bytes\+In\+Flight}}
\index{m\+\_\+guessed\+Bytes\+In\+Flight@{m\+\_\+guessed\+Bytes\+In\+Flight}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+guessed\+Bytes\+In\+Flight}{m_guessedBytesInFlight}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t Tcp\+Bytes\+In\+Flight\+Test\+::m\+\_\+guessed\+Bytes\+In\+Flight\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}{}\label{classTcpBytesInFlightTest_a746a64e877ab18748c5e84e6b48f9105}


Guessed bytes in flight. 

\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!m\+\_\+last\+Ack\+Recv@{m\+\_\+last\+Ack\+Recv}}
\index{m\+\_\+last\+Ack\+Recv@{m\+\_\+last\+Ack\+Recv}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+last\+Ack\+Recv}{m_lastAckRecv}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Sequence\+Number32} Tcp\+Bytes\+In\+Flight\+Test\+::m\+\_\+last\+Ack\+Recv\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classTcpBytesInFlightTest_a69ac0a58e163339be5082e44e0e74abe}{}\label{classTcpBytesInFlightTest_a69ac0a58e163339be5082e44e0e74abe}


Last A\+CK received. 

\index{Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}!m\+\_\+to\+Drop@{m\+\_\+to\+Drop}}
\index{m\+\_\+to\+Drop@{m\+\_\+to\+Drop}!Tcp\+Bytes\+In\+Flight\+Test@{Tcp\+Bytes\+In\+Flight\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+to\+Drop}{m_toDrop}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<$uint32\+\_\+t$>$ Tcp\+Bytes\+In\+Flight\+Test\+::m\+\_\+to\+Drop\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classTcpBytesInFlightTest_a07a49022311b5cede6d01eef26ba3f33}{}\label{classTcpBytesInFlightTest_a07a49022311b5cede6d01eef26ba3f33}


List of Sequence\+Number to drop. 



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
internet/test/\hyperlink{tcp-bytes-in-flight-test_8cc}{tcp-\/bytes-\/in-\/flight-\/test.\+cc}\end{DoxyCompactItemize}
