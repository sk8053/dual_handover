\hypertarget{classIpv4PacketInfoTagTest}{}\section{Ipv4\+Packet\+Info\+Tag\+Test Class Reference}
\label{classIpv4PacketInfoTagTest}\index{Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}}


I\+Pv4 Packet\+Info\+Tag Test.  




Inheritance diagram for Ipv4\+Packet\+Info\+Tag\+Test\+:
% FIG 0


Collaboration diagram for Ipv4\+Packet\+Info\+Tag\+Test\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classIpv4PacketInfoTagTest_aad133aba023c62f3aca9e29f2d8bf201}{Ipv4\+Packet\+Info\+Tag\+Test} ()
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classIpv4PacketInfoTagTest_a76ce4d3cfa6dc21bd2a982ba2e5d4386}{Do\+Run} (void)
\begin{DoxyCompactList}\small\item\em Implementation to actually run this Test\+Case. \end{DoxyCompactList}\item 
void \hyperlink{classIpv4PacketInfoTagTest_ac528deb0c346c973c2e5391540a53bc3}{Rx\+Cb} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Socket}{Socket} $>$ socket)
\begin{DoxyCompactList}\small\item\em Receive callback. \end{DoxyCompactList}\item 
void \hyperlink{classIpv4PacketInfoTagTest_a5cba94d15d8c0921a95a3769c06221b7}{Do\+Send\+Data} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Socket}{Socket} $>$ socket, std\+::string to)
\begin{DoxyCompactList}\small\item\em Send data. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
I\+Pv4 Packet\+Info\+Tag Test. 

\subsection{Constructor \& Destructor Documentation}
\index{Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}!Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}}
\index{Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}!Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}}
\subsubsection[{\texorpdfstring{Ipv4\+Packet\+Info\+Tag\+Test()}{Ipv4PacketInfoTagTest()}}]{\setlength{\rightskip}{0pt plus 5cm}Ipv4\+Packet\+Info\+Tag\+Test\+::\+Ipv4\+Packet\+Info\+Tag\+Test (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classIpv4PacketInfoTagTest_aad133aba023c62f3aca9e29f2d8bf201}{}\label{classIpv4PacketInfoTagTest_aad133aba023c62f3aca9e29f2d8bf201}

\begin{DoxyCode}
83   : \hyperlink{classns3_1_1TestCase_a3b0b91a96aac1933e8d146e019b9e207}{TestCase} (\textcolor{stringliteral}{"Ipv4PacketInfoTagTest"})
84 \{
85 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}!Do\+Run@{Do\+Run}}
\index{Do\+Run@{Do\+Run}!Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}}
\subsubsection[{\texorpdfstring{Do\+Run(void)}{DoRun(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv4\+Packet\+Info\+Tag\+Test\+::\+Do\+Run (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [virtual]}}\hypertarget{classIpv4PacketInfoTagTest_a76ce4d3cfa6dc21bd2a982ba2e5d4386}{}\label{classIpv4PacketInfoTagTest_a76ce4d3cfa6dc21bd2a982ba2e5d4386}


Implementation to actually run this Test\+Case. 

Subclasses should override this method to conduct their tests. 

Implements \hyperlink{classns3_1_1TestCase_a8ff74680cf017ed42011e4be51917a24}{ns3\+::\+Test\+Case}.


\begin{DoxyCode}
121 \{
122   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} node0 = CreateObject<Node> ();
123   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} node1 = CreateObject<Node> ();
124 
125   \hyperlink{classns3_1_1SimpleNetDeviceHelper}{SimpleNetDeviceHelper} simpleNetDevHelper;
126   \hyperlink{classns3_1_1NetDeviceContainer}{NetDeviceContainer} devs = simpleNetDevHelper.Install (
      \hyperlink{classns3_1_1NodeContainer}{NodeContainer} (node0, node1));
127   \hyperlink{classns3_1_1Ptr}{Ptr<SimpleNetDevice>} device = DynamicCast<SimpleNetDevice> (devs.
      \hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (0));
128   \hyperlink{classns3_1_1Ptr}{Ptr<SimpleNetDevice>} device2 = DynamicCast<SimpleNetDevice> (devs.
      \hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (1));
129 
130   \hyperlink{classns3_1_1InternetStackHelper}{InternetStackHelper} internet;
131   internet.\hyperlink{classns3_1_1InternetStackHelper_a5fa8d34e5834305b6aa1b0fe43e1132b}{SetIpv6StackInstall} (\textcolor{keyword}{false});
132 
133   \textcolor{comment}{// For Node 0}
134   node0->\hyperlink{classns3_1_1Node_a42ff83ee1d5d1649c770d3f5b62375de}{AddDevice} (device);
135   internet.Install (node0);
136   \hyperlink{classns3_1_1Ptr}{Ptr<Ipv4>} ipv4 = node0->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1Ipv4}{Ipv4}> ();
137 
138   uint32\_t index = ipv4->\hyperlink{classns3_1_1Ipv4_a637354128b71bc587ea5a6eeaef42469}{AddInterface} (device);
139   \hyperlink{classns3_1_1Ipv4InterfaceAddress}{Ipv4InterfaceAddress} ifaceAddr1 = \hyperlink{classns3_1_1Ipv4InterfaceAddress}{Ipv4InterfaceAddress} (\textcolor{stringliteral}{"10.1.1.1
      "},
140                                                           \textcolor{stringliteral}{"255.255.255.0"});
141   ipv4->\hyperlink{classns3_1_1Ipv4_ad203526cae6a4b86f1bb89e44d2b62f7}{AddAddress} (index, ifaceAddr1);
142   ipv4->\hyperlink{classns3_1_1Ipv4_a2b5632573b67957fabe2dfea248a57a3}{SetMetric} (index, 1);
143   ipv4->\hyperlink{classns3_1_1Ipv4_a71b2f8acca4923aef907b50b3196bf23}{SetUp} (index);
144 
145   \textcolor{comment}{// For Node 1}
146   node1->AddDevice (device2);
147   internet.Install (node1);
148   ipv4 = node1->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1Ipv4}{Ipv4}> ();
149 
150   index = ipv4->\hyperlink{classns3_1_1Ipv4_a637354128b71bc587ea5a6eeaef42469}{AddInterface} (device2);
151   \hyperlink{classns3_1_1Ipv4InterfaceAddress}{Ipv4InterfaceAddress} ifaceAddr2 = \hyperlink{classns3_1_1Ipv4InterfaceAddress}{Ipv4InterfaceAddress} (\textcolor{stringliteral}{"10.1.1.2
      "},
152                                                           \textcolor{stringliteral}{"255.255.255.0"});
153   ipv4->\hyperlink{classns3_1_1Ipv4_ad203526cae6a4b86f1bb89e44d2b62f7}{AddAddress} (index, ifaceAddr2);
154   ipv4->\hyperlink{classns3_1_1Ipv4_a2b5632573b67957fabe2dfea248a57a3}{SetMetric} (index, 1);
155   ipv4->\hyperlink{classns3_1_1Ipv4_a71b2f8acca4923aef907b50b3196bf23}{SetUp} (index);
156 
157   \textcolor{comment}{// IPv4 test}
158   \hyperlink{classns3_1_1Ptr}{Ptr<SocketFactory>} factory = node0->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<
      \hyperlink{classns3_1_1SocketFactory}{SocketFactory}> (UdpSocketFactory::GetTypeId ());
159   \hyperlink{classns3_1_1Ptr}{Ptr<Socket>} socket = factory->\hyperlink{classns3_1_1SocketFactory_a97351e6e7860503a4912042530449f62}{CreateSocket} ();
160   \hyperlink{classns3_1_1InetSocketAddress}{InetSocketAddress} local =  \hyperlink{classns3_1_1InetSocketAddress}{InetSocketAddress} (Ipv4Address::GetAny (), 2
      00);
161   socket->Bind (local);
162   socket->SetRecvPktInfo (\textcolor{keyword}{true});
163   socket->SetRecvCallback (\hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&
      \hyperlink{classIpv4PacketInfoTagTest_ac528deb0c346c973c2e5391540a53bc3}{Ipv4PacketInfoTagTest::RxCb}, \textcolor{keyword}{this}));
164 
165   \textcolor{comment}{// receive on loopback}
166   Simulator::ScheduleWithContext (socket->GetNode ()->GetId (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
167                                   &\hyperlink{classIpv4PacketInfoTagTest_a5cba94d15d8c0921a95a3769c06221b7}{Ipv4PacketInfoTagTest::DoSendData}, \textcolor{keyword}{this}
      , socket, \textcolor{stringliteral}{"127.0.0.1"});
168   Simulator::Run ();
169 
170   \hyperlink{classns3_1_1Ptr}{Ptr<SocketFactory>} factory2 = node1->GetObject<\hyperlink{classns3_1_1SocketFactory}{SocketFactory}> (
      UdpSocketFactory::GetTypeId ());
171   \hyperlink{classns3_1_1Ptr}{Ptr<Socket>} socket2 = factory2->\hyperlink{classns3_1_1SocketFactory_a97351e6e7860503a4912042530449f62}{CreateSocket} ();
172   Simulator::ScheduleWithContext (socket2->GetNode ()->GetId (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
173                                   &\hyperlink{classIpv4PacketInfoTagTest_a5cba94d15d8c0921a95a3769c06221b7}{Ipv4PacketInfoTagTest::DoSendData}, \textcolor{keyword}{this}
      , socket, \textcolor{stringliteral}{"10.1.1.1"});
174   Simulator::Run ();
175 
176   \textcolor{comment}{// ipv4 w rawsocket}
177   factory = node0->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1SocketFactory}{SocketFactory}> (Ipv4RawSocketFactory::GetTypeId ());
178   socket = factory->\hyperlink{classns3_1_1SocketFactory_a97351e6e7860503a4912042530449f62}{CreateSocket} ();
179   local =  \hyperlink{classns3_1_1InetSocketAddress}{InetSocketAddress} (Ipv4Address::GetAny (), 0);
180   socket->Bind (local);
181   socket->SetRecvPktInfo (\textcolor{keyword}{true});
182   socket->SetRecvCallback (\hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&
      \hyperlink{classIpv4PacketInfoTagTest_ac528deb0c346c973c2e5391540a53bc3}{Ipv4PacketInfoTagTest::RxCb}, \textcolor{keyword}{this}));
183 
184   \textcolor{comment}{// receive on loopback}
185   Simulator::ScheduleWithContext (socket->GetNode ()->GetId (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
186                                   &\hyperlink{classIpv4PacketInfoTagTest_a5cba94d15d8c0921a95a3769c06221b7}{Ipv4PacketInfoTagTest::DoSendData}, \textcolor{keyword}{this}
      , socket, \textcolor{stringliteral}{"127.0.0.1"});
187   Simulator::Run ();
188 
189   factory2 = node1->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1SocketFactory}{SocketFactory}> (Ipv4RawSocketFactory::GetTypeId ());
190   socket2 = factory2->\hyperlink{classns3_1_1SocketFactory_a97351e6e7860503a4912042530449f62}{CreateSocket} ();
191   Simulator::ScheduleWithContext (socket2->GetNode ()->GetId (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
192                                   &\hyperlink{classIpv4PacketInfoTagTest_a5cba94d15d8c0921a95a3769c06221b7}{Ipv4PacketInfoTagTest::DoSendData}, \textcolor{keyword}{this}
      , socket, \textcolor{stringliteral}{"10.1.1.1"});
193   Simulator::Run ();
194   Simulator::Destroy ();
195 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2


\index{Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}!Do\+Send\+Data@{Do\+Send\+Data}}
\index{Do\+Send\+Data@{Do\+Send\+Data}!Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}}
\subsubsection[{\texorpdfstring{Do\+Send\+Data(\+Ptr$<$ Socket $>$ socket, std\+::string to)}{DoSendData(Ptr< Socket > socket, std::string to)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv4\+Packet\+Info\+Tag\+Test\+::\+Do\+Send\+Data (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Socket} $>$}]{socket, }
\item[{std\+::string}]{to}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4PacketInfoTagTest_a5cba94d15d8c0921a95a3769c06221b7}{}\label{classIpv4PacketInfoTagTest_a5cba94d15d8c0921a95a3769c06221b7}


Send data. 


\begin{DoxyParams}{Parameters}
{\em socket} & Sending socket. \\
\hline
{\em to} & Destination address. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
105 \{
106   \hyperlink{classns3_1_1Address}{Address} realTo = \hyperlink{classns3_1_1InetSocketAddress}{InetSocketAddress} (\hyperlink{classns3_1_1Ipv4Address}{Ipv4Address} (to.c\_str ()), 200);
107   \textcolor{keywordflow}{if} (DynamicCast<UdpSocket> (socket) != 0)
108     \{
109       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (socket->\hyperlink{classns3_1_1Socket_af898fce6a58e0dbba23c1c6de1d4220e}{SendTo} (Create<Packet> (123), 0, realTo),
110                              123, \textcolor{stringliteral}{"100"});
111     \}
112   \textcolor{comment}{// Should only Ipv4RawSock}
113   \textcolor{keywordflow}{else}
114     \{
115       socket->\hyperlink{classns3_1_1Socket_af898fce6a58e0dbba23c1c6de1d4220e}{SendTo} (Create<Packet> (123), 0, realTo);
116     \}
117 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 3




Here is the caller graph for this function\+:
% FIG 4


\index{Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}!Rx\+Cb@{Rx\+Cb}}
\index{Rx\+Cb@{Rx\+Cb}!Ipv4\+Packet\+Info\+Tag\+Test@{Ipv4\+Packet\+Info\+Tag\+Test}}
\subsubsection[{\texorpdfstring{Rx\+Cb(\+Ptr$<$ Socket $>$ socket)}{RxCb(Ptr< Socket > socket)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv4\+Packet\+Info\+Tag\+Test\+::\+Rx\+Cb (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Socket} $>$}]{socket}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4PacketInfoTagTest_ac528deb0c346c973c2e5391540a53bc3}{}\label{classIpv4PacketInfoTagTest_ac528deb0c346c973c2e5391540a53bc3}


Receive callback. 


\begin{DoxyParams}{Parameters}
{\em socket} & Receiving socket. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
89 \{
90   uint32\_t availableData;
91   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} m\_receivedPacket;
92 
93   availableData = socket->\hyperlink{classns3_1_1Socket_ad35d8931e53ae0754ee864acb1cecd0e}{GetRxAvailable} ();
94   m\_receivedPacket = socket->\hyperlink{classns3_1_1Socket_a8949b1f844aae563446f2f4c5be8827a}{Recv} (\hyperlink{80211b_8c_affe776513b24d84b39af8ab0930fef7f}{std::numeric\_limits<uint32\_t>::max}
       (), 0);
95   \hyperlink{group__testing_ga2a9d78cffb3db8e867c35fff0b698cf5}{NS\_TEST\_ASSERT\_MSG\_EQ} (availableData, m\_receivedPacket->
      \hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} (), \textcolor{stringliteral}{"Did not read expected data"});
96 
97   \hyperlink{classns3_1_1Ipv4PacketInfoTag}{Ipv4PacketInfoTag} tag;
98   \textcolor{keywordtype}{bool} found;
99   found = m\_receivedPacket->\hyperlink{classns3_1_1Packet_a078fe922d976a417ab25ba2f3c2fd667}{RemovePacketTag} (tag);
100   \hyperlink{group__testing_ga2a9d78cffb3db8e867c35fff0b698cf5}{NS\_TEST\_ASSERT\_MSG\_EQ} (found, \textcolor{keyword}{true}, \textcolor{stringliteral}{"Could not find tag"});
101 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 5




Here is the caller graph for this function\+:
% FIG 6




The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
internet/test/\hyperlink{ipv4-packet-info-tag-test-suite_8cc}{ipv4-\/packet-\/info-\/tag-\/test-\/suite.\+cc}\end{DoxyCompactItemize}
