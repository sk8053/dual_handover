\hypertarget{classns3_1_1NullMessageMpiInterface}{}\section{ns3\+:\+:Null\+Message\+Mpi\+Interface Class Reference}
\label{classns3_1_1NullMessageMpiInterface}\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}


Interface between ns-\/3 and M\+PI for the Null Message distributed simulation implementation.  




{\ttfamily \#include $<$null-\/message-\/mpi-\/interface.\+h$>$}



Inheritance diagram for ns3\+:\+:Null\+Message\+Mpi\+Interface\+:
% FIG 0


Collaboration diagram for ns3\+:\+:Null\+Message\+Mpi\+Interface\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classns3_1_1NullMessageMpiInterface_a888a1dfbb86df5c281e78d07587cd768}{Null\+Message\+Mpi\+Interface} ()
\item 
\hyperlink{classns3_1_1NullMessageMpiInterface_a7dc0735c9fd7d02449d9c72283db3d5b}{$\sim$\+Null\+Message\+Mpi\+Interface} ()
\item 
virtual void \hyperlink{classns3_1_1NullMessageMpiInterface_a06dfa62339e8e66771e871f3ac539be6}{Destroy} ()
\item 
virtual uint32\+\_\+t \hyperlink{classns3_1_1NullMessageMpiInterface_acae7c11672daaac25e6819b76337ae48}{Get\+System\+Id} ()
\item 
virtual uint32\+\_\+t \hyperlink{classns3_1_1NullMessageMpiInterface_acf20c96eac19fb2e5f082e83523a2df7}{Get\+Size} ()
\item 
virtual bool \hyperlink{classns3_1_1NullMessageMpiInterface_a7f7b4f199007ebd7ea75ff111a43e831}{Is\+Enabled} ()
\item 
virtual void \hyperlink{classns3_1_1NullMessageMpiInterface_afa4ce22542772a893e234c7c9c58cf5f}{Enable} (int $\ast$pargc, char $\ast$$\ast$$\ast$pargv)
\item 
virtual void \hyperlink{classns3_1_1NullMessageMpiInterface_a00ad9d086e977d0c3698961d44f15631}{Disable} ()
\item 
virtual void \hyperlink{classns3_1_1NullMessageMpiInterface_a5bef503661f681b69f0c69abda3ed25a}{Send\+Packet} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{lte__link__budget__x2__handover__measures_8m_ac9de518908a968428863f829398a4e62}{p}, const \hyperlink{classns3_1_1Time}{Time} \&rx\+Time, uint32\+\_\+t node, uint32\+\_\+t dev)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{classns3_1_1NullMessageMpiInterface_a92aad3a1cd808f9434cb231887f830de}{Send\+Null\+Message} (const \hyperlink{classns3_1_1Time}{Time} \&guarantee\+Update, \hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1RemoteChannelBundle}{Remote\+Channel\+Bundle} $>$ bundle)
\begin{DoxyCompactList}\small\item\em Send a Null Message to across the specified bundle. \end{DoxyCompactList}\item 
static void \hyperlink{classns3_1_1NullMessageMpiInterface_a72b804a0df5b1a3b5f992c04e62e63c5}{Receive\+Messages\+Non\+Blocking} ()
\item 
static void \hyperlink{classns3_1_1NullMessageMpiInterface_a1fa1c0d0803d3aad54f54e05b361ac6f}{Receive\+Messages\+Blocking} ()
\item 
static void \hyperlink{classns3_1_1NullMessageMpiInterface_a97d3958578fd342a456baf86d8f956ab}{Test\+Send\+Complete} ()
\item 
static void \hyperlink{classns3_1_1NullMessageMpiInterface_ab678abc12a3e689d5eeeaee743b51c11}{Initialize\+Send\+Receive\+Buffers} (void)
\begin{DoxyCompactList}\small\item\em Initialize send and receive buffers. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{classns3_1_1NullMessageMpiInterface_a9ca96f3f6dc2df5f955505c441499430}{Receive\+Messages} (bool blocking=\hyperlink{lte__cqi__generation_8m_ab1bef239d413c4da139c4bac92cd657a}{false})
\end{DoxyCompactItemize}
\subsection*{Static Private Attributes}
\begin{DoxyCompactItemize}
\item 
static uint32\+\_\+t \hyperlink{classns3_1_1NullMessageMpiInterface_aba703fa18812299f38a533175e84789d}{g\+\_\+sid} = 0
\item 
static uint32\+\_\+t \hyperlink{classns3_1_1NullMessageMpiInterface_acbc2b4d714259601b86e1bc1bc13e26a}{g\+\_\+size} = 1
\item 
static uint32\+\_\+t \hyperlink{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}{g\+\_\+num\+Neighbors} = 0
\item 
static bool \hyperlink{classns3_1_1NullMessageMpiInterface_a4f593d0bc0562f63fe183d3351d68c80}{g\+\_\+initialized} = \hyperlink{lte__cqi__generation_8m_ab1bef239d413c4da139c4bac92cd657a}{false}
\item 
static bool \hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\+\_\+enabled} = \hyperlink{lte__cqi__generation_8m_ab1bef239d413c4da139c4bac92cd657a}{false}
\item 
static \hyperlink{granted-time-window-mpi-interface_8h_a31b372fd1cca939295900acb2a4961dd}{M\+P\+I\+\_\+\+Request} $\ast$ \hyperlink{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}{g\+\_\+requests}
\item 
static char $\ast$$\ast$ \hyperlink{classns3_1_1NullMessageMpiInterface_ab6aaed51bb851d090273d5c44fe2aec0}{g\+\_\+p\+Rx\+Buffers}
\item 
static \hyperlink{openflow-interface_8h_afd9bcfa176617760671b67580f536fa7}{std\+::list}$<$ \hyperlink{classns3_1_1NullMessageSentBuffer}{Null\+Message\+Sent\+Buffer} $>$ \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\+\_\+pending\+Tx}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Interface between ns-\/3 and M\+PI for the Null Message distributed simulation implementation. 

\subsection{Constructor \& Destructor Documentation}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Null\+Message\+Mpi\+Interface@{Null\+Message\+Mpi\+Interface}}
\index{Null\+Message\+Mpi\+Interface@{Null\+Message\+Mpi\+Interface}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Null\+Message\+Mpi\+Interface()}{NullMessageMpiInterface()}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Null\+Message\+Mpi\+Interface (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1NullMessageMpiInterface_a888a1dfbb86df5c281e78d07587cd768}{}\label{classns3_1_1NullMessageMpiInterface_a888a1dfbb86df5c281e78d07587cd768}

\begin{DoxyCode}
96 \{
97   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
98 
99 \textcolor{preprocessor}{#ifndef NS3\_MPI}
100   \textcolor{comment}{/*}
101 \textcolor{comment}{   * This class can only be constructed if MPI is available.  Fail if an }
102 \textcolor{comment}{   * attempt is made to instantiate this class without MPI.}
103 \textcolor{comment}{   */}
104   \hyperlink{group__fatal_ga5131d5e3f75d7d4cbfd706ac456fdc85}{NS\_FATAL\_ERROR} (\textcolor{stringliteral}{"Must compile with MPI if Null Message simulator is used, see --enable-mpi
       option for waf"});
105 \textcolor{preprocessor}{#endif}
106 \}
\end{DoxyCode}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!````~Null\+Message\+Mpi\+Interface@{$\sim$\+Null\+Message\+Mpi\+Interface}}
\index{````~Null\+Message\+Mpi\+Interface@{$\sim$\+Null\+Message\+Mpi\+Interface}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{$\sim$\+Null\+Message\+Mpi\+Interface()}{~NullMessageMpiInterface()}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Null\+Message\+Mpi\+Interface\+::$\sim$\+Null\+Message\+Mpi\+Interface (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1NullMessageMpiInterface_a7dc0735c9fd7d02449d9c72283db3d5b}{}\label{classns3_1_1NullMessageMpiInterface_a7dc0735c9fd7d02449d9c72283db3d5b}

\begin{DoxyCode}
109 \{
110   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
111 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Destroy@{Destroy}}
\index{Destroy@{Destroy}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Destroy()}{Destroy()}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Destroy (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a06dfa62339e8e66771e871f3ac539be6}{}\label{classns3_1_1NullMessageMpiInterface_a06dfa62339e8e66771e871f3ac539be6}
Delete all buffers 

Implements \hyperlink{classns3_1_1ParallelCommunicationInterface_ab647bad738a7ae91d8a993880c7ece10}{ns3\+::\+Parallel\+Communication\+Interface}.


\begin{DoxyCode}
115 \{
116   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
117 \}
\end{DoxyCode}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Disable@{Disable}}
\index{Disable@{Disable}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Disable()}{Disable()}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Disable (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a00ad9d086e977d0c3698961d44f15631}{}\label{classns3_1_1NullMessageMpiInterface_a00ad9d086e977d0c3698961d44f15631}
Terminates the M\+PI environment by calling M\+P\+I\+\_\+\+Finalize This function must be called after Destroy (). Resets m\+\_\+initialized and m\+\_\+enabled. 

Implements \hyperlink{classns3_1_1ParallelCommunicationInterface_adeb1416b3a2e0185b376bbbf0d341fe4}{ns3\+::\+Parallel\+Communication\+Interface}.


\begin{DoxyCode}
416 \{
417   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
418 
419 \textcolor{preprocessor}{#ifdef NS3\_MPI}
420   \textcolor{keywordtype}{int} flag = 0;
421   MPI\_Initialized (&flag);
422   \textcolor{keywordflow}{if} (flag)
423     \{
424 
425       \textcolor{keywordflow}{for} (std::list<NullMessageSentBuffer>::iterator iter = \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\_pendingTx}.begin ();
426            iter != \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\_pendingTx}.end ();
427            ++iter)
428         \{
429           MPI\_Cancel (iter->GetRequest ());
430           MPI\_Request\_free (iter->GetRequest ());
431         \}
432 
433       \textcolor{keywordflow}{for} (uint32\_t \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} = 0; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} < \hyperlink{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}{g\_numNeighbors}; ++\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i})
434         \{
435           MPI\_Cancel (&\hyperlink{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}{g\_requests}[\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}]);
436           MPI\_Request\_free (&\hyperlink{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}{g\_requests}[\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}]);
437         \}
438 
439       MPI\_Finalize ();
440 
441       \textcolor{keywordflow}{for} (uint32\_t \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} = 0; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} < \hyperlink{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}{g\_numNeighbors}; ++\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i})
442         \{
443           \textcolor{keyword}{delete} [] \hyperlink{classns3_1_1NullMessageMpiInterface_ab6aaed51bb851d090273d5c44fe2aec0}{g\_pRxBuffers}[\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}];
444         \}
445       \textcolor{keyword}{delete} [] \hyperlink{classns3_1_1NullMessageMpiInterface_ab6aaed51bb851d090273d5c44fe2aec0}{g\_pRxBuffers};
446       \textcolor{keyword}{delete} [] \hyperlink{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}{g\_requests};
447 
448       \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\_pendingTx}.clear ();
449 
450       \hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\_enabled} = \textcolor{keyword}{false};
451       \hyperlink{classns3_1_1NullMessageMpiInterface_a4f593d0bc0562f63fe183d3351d68c80}{g\_initialized} = \textcolor{keyword}{false};
452 
453     \}
454   \textcolor{keywordflow}{else}
455     \{
456       \hyperlink{group__fatal_ga5131d5e3f75d7d4cbfd706ac456fdc85}{NS\_FATAL\_ERROR} (\textcolor{stringliteral}{"Cannot disable MPI environment without Initializing it first"});
457     \}
458 \textcolor{preprocessor}{#endif}
459 \}
\end{DoxyCode}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Enable@{Enable}}
\index{Enable@{Enable}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Enable(int $\ast$pargc, char $\ast$$\ast$$\ast$pargv)}{Enable(int *pargc, char ***pargv)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Enable (
\begin{DoxyParamCaption}
\item[{int $\ast$}]{pargc, }
\item[{char $\ast$$\ast$$\ast$}]{pargv}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classns3_1_1NullMessageMpiInterface_afa4ce22542772a893e234c7c9c58cf5f}{}\label{classns3_1_1NullMessageMpiInterface_afa4ce22542772a893e234c7c9c58cf5f}

\begin{DoxyParams}{Parameters}
{\em pargc} & number of command line arguments \\
\hline
{\em pargv} & command line arguments\\
\hline
\end{DoxyParams}
Sets up interface. Calls M\+PI Init and posts receives. 

Implements \hyperlink{classns3_1_1ParallelCommunicationInterface_a0f73feee4076f27f3d80166656bdfdae}{ns3\+::\+Parallel\+Communication\+Interface}.


\begin{DoxyCode}
146 \{
147   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << *pargc);
148 \textcolor{preprocessor}{#ifdef NS3\_MPI}
149 
150   \textcolor{comment}{// Initialize the MPI interface}
151   MPI\_Init (pargc, pargv);
152   MPI\_Barrier (MPI\_COMM\_WORLD);
153 
154   \textcolor{comment}{// SystemId and Size are unit32\_t in interface but MPI uses int so convert.}
155   \textcolor{keywordtype}{int} mpiSystemId;
156   \textcolor{keywordtype}{int} mpiSize;
157   MPI\_Comm\_rank (MPI\_COMM\_WORLD, &mpiSystemId);
158   MPI\_Comm\_size (MPI\_COMM\_WORLD, &mpiSize);
159 
160   \hyperlink{classns3_1_1NullMessageMpiInterface_aba703fa18812299f38a533175e84789d}{g\_sid} = mpiSystemId;
161   \hyperlink{classns3_1_1NullMessageMpiInterface_acbc2b4d714259601b86e1bc1bc13e26a}{g\_size} = mpiSize;
162 
163   \hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\_enabled} = \textcolor{keyword}{true};
164   \hyperlink{classns3_1_1NullMessageMpiInterface_a4f593d0bc0562f63fe183d3351d68c80}{g\_initialized} = \textcolor{keyword}{true};
165 
166 \textcolor{preprocessor}{#endif}
167 \}
\end{DoxyCode}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Get\+Size@{Get\+Size}}
\index{Get\+Size@{Get\+Size}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Get\+Size()}{GetSize()}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Get\+Size (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classns3_1_1NullMessageMpiInterface_acf20c96eac19fb2e5f082e83523a2df7}{}\label{classns3_1_1NullMessageMpiInterface_acf20c96eac19fb2e5f082e83523a2df7}
\begin{DoxyReturn}{Returns}
number of systems (M\+PI size) 
\end{DoxyReturn}


Implements \hyperlink{classns3_1_1ParallelCommunicationInterface_ab9700002497437a15959e9009eedfcdb}{ns3\+::\+Parallel\+Communication\+Interface}.


\begin{DoxyCode}
128 \{
129   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\_enabled});
130   \textcolor{keywordflow}{return} \hyperlink{classns3_1_1NullMessageMpiInterface_acbc2b4d714259601b86e1bc1bc13e26a}{g\_size};
131 \}
\end{DoxyCode}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Get\+System\+Id@{Get\+System\+Id}}
\index{Get\+System\+Id@{Get\+System\+Id}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Get\+System\+Id()}{GetSystemId()}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Get\+System\+Id (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classns3_1_1NullMessageMpiInterface_acae7c11672daaac25e6819b76337ae48}{}\label{classns3_1_1NullMessageMpiInterface_acae7c11672daaac25e6819b76337ae48}
\begin{DoxyReturn}{Returns}
system id (M\+PI rank) 
\end{DoxyReturn}


Implements \hyperlink{classns3_1_1ParallelCommunicationInterface_a9070c6c68ffa2223d422f132ec8e27b9}{ns3\+::\+Parallel\+Communication\+Interface}.


\begin{DoxyCode}
121 \{
122   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\_enabled});
123   \textcolor{keywordflow}{return} \hyperlink{classns3_1_1NullMessageMpiInterface_aba703fa18812299f38a533175e84789d}{g\_sid};
124 \}
\end{DoxyCode}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Initialize\+Send\+Receive\+Buffers@{Initialize\+Send\+Receive\+Buffers}}
\index{Initialize\+Send\+Receive\+Buffers@{Initialize\+Send\+Receive\+Buffers}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Initialize\+Send\+Receive\+Buffers(void)}{InitializeSendReceiveBuffers(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Initialize\+Send\+Receive\+Buffers (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{classns3_1_1NullMessageMpiInterface_ab678abc12a3e689d5eeeaee743b51c11}{}\label{classns3_1_1NullMessageMpiInterface_ab678abc12a3e689d5eeeaee743b51c11}


Initialize send and receive buffers. 

This method should be called after all links have been added to the \hyperlink{classns3_1_1RemoteChannelBundle}{Remote\+Channel\+Bundle} manager to setup any required send and receive buffers. 
\begin{DoxyCode}
171 \{
172   \hyperlink{log-macros-disabled_8h_a8f7e4afc291c9d29a65c18ac1f79197b}{NS\_LOG\_FUNCTION\_NOARGS} ();
173 \textcolor{preprocessor}{#ifdef NS3\_MPI}
174   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\_enabled});
175 
176   \hyperlink{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}{g\_numNeighbors} = \hyperlink{classns3_1_1RemoteChannelBundleManager_aaf679dae2468048f39ee77ec6b41db64}{RemoteChannelBundleManager::Size}();
177 
178   \textcolor{comment}{// Post a non-blocking receive for all peers}
179   \hyperlink{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}{g\_requests} = \textcolor{keyword}{new} \hyperlink{granted-time-window-mpi-interface_8h_a31b372fd1cca939295900acb2a4961dd}{MPI\_Request}[\hyperlink{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}{g\_numNeighbors}];
180   \hyperlink{classns3_1_1NullMessageMpiInterface_ab6aaed51bb851d090273d5c44fe2aec0}{g\_pRxBuffers} = \textcolor{keyword}{new} \textcolor{keywordtype}{char}*[\hyperlink{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}{g\_numNeighbors}];
181   \textcolor{keywordtype}{int} index = 0;
182   \textcolor{keywordflow}{for} (uint32\_t rank = 0; rank < \hyperlink{classns3_1_1NullMessageMpiInterface_acbc2b4d714259601b86e1bc1bc13e26a}{g\_size}; ++rank)
183     \{
184       Ptr<RemoteChannelBundle> bundle = \hyperlink{classns3_1_1RemoteChannelBundleManager_a143cfdce189ed68cc0917255ef0b849f}{RemoteChannelBundleManager::Find}(
      rank);
185       \textcolor{keywordflow}{if} (bundle) 
186         \{
187           \hyperlink{classns3_1_1NullMessageMpiInterface_ab6aaed51bb851d090273d5c44fe2aec0}{g\_pRxBuffers}[index] = \textcolor{keyword}{new} \textcolor{keywordtype}{char}[NULL\_MESSAGE\_MAX\_MPI\_MSG\_SIZE];
188           MPI\_Irecv (\hyperlink{classns3_1_1NullMessageMpiInterface_ab6aaed51bb851d090273d5c44fe2aec0}{g\_pRxBuffers}[index], NULL\_MESSAGE\_MAX\_MPI\_MSG\_SIZE, MPI\_CHAR, rank, 0,
189                      MPI\_COMM\_WORLD, &\hyperlink{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}{g\_requests}[index]);
190           ++index;
191         \}
192     \}
193 \textcolor{preprocessor}{#endif}
194 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2




Here is the caller graph for this function\+:
% FIG 3


\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Is\+Enabled@{Is\+Enabled}}
\index{Is\+Enabled@{Is\+Enabled}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Is\+Enabled()}{IsEnabled()}}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Is\+Enabled (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a7f7b4f199007ebd7ea75ff111a43e831}{}\label{classns3_1_1NullMessageMpiInterface_a7f7b4f199007ebd7ea75ff111a43e831}
\begin{DoxyReturn}{Returns}
true if interface is enabled 
\end{DoxyReturn}


Implements \hyperlink{classns3_1_1ParallelCommunicationInterface_a5f7c1f671a8364f12e238c368ed4ad72}{ns3\+::\+Parallel\+Communication\+Interface}.


\begin{DoxyCode}
135 \{
136   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1NullMessageMpiInterface_a4f593d0bc0562f63fe183d3351d68c80}{g\_initialized})
137     \{
138       \hyperlink{classns3_1_1Simulator_afdbe7c7695132b3fae7cb0b5d67c04e3}{Simulator::GetImplementation} ();
139       \hyperlink{classns3_1_1NullMessageMpiInterface_a4f593d0bc0562f63fe183d3351d68c80}{g\_initialized} = \textcolor{keyword}{true};
140     \}
141   \textcolor{keywordflow}{return} \hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\_enabled};
142 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 4


\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Receive\+Messages@{Receive\+Messages}}
\index{Receive\+Messages@{Receive\+Messages}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Receive\+Messages(bool blocking=false)}{ReceiveMessages(bool blocking=false)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Receive\+Messages (
\begin{DoxyParamCaption}
\item[{bool}]{blocking = {\ttfamily {\bf false}}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a9ca96f3f6dc2df5f955505c441499430}{}\label{classns3_1_1NullMessageMpiInterface_a9ca96f3f6dc2df5f955505c441499430}
Check for received messages complete. Will block until message has been received if blocking flag is true. When blocking will return after the first message is received. Non-\/blocking mode will Non-\/blocking check for received messages complete. Will receive all messages that are queued up locally. 
\begin{DoxyCode}
291 \{
292   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (blocking);
293 
294   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\_enabled});
295 
296 \textcolor{preprocessor}{#ifdef NS3\_MPI}
297 
298   \textcolor{comment}{// stop flag set to true when no more messages are found to}
299   \textcolor{comment}{// process.}
300   \textcolor{keywordtype}{bool} stop = \textcolor{keyword}{false};
301 
302 
303   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}{g\_numNeighbors}) \{
304     \textcolor{comment}{// Not communicating with anyone.}
305     \textcolor{keywordflow}{return};
306   \}
307 
308   \textcolor{keywordflow}{do}
309     \{
310       \textcolor{keywordtype}{int} messageReceived = 0;
311       \textcolor{keywordtype}{int} index = 0;
312       MPI\_Status status;
313 
314       \textcolor{keywordflow}{if} (blocking)
315         \{
316           MPI\_Waitany (\hyperlink{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}{g\_numNeighbors}, \hyperlink{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}{g\_requests}, &index, &status);
317           messageReceived = 1; \textcolor{comment}{/* Wait always implies message was received */}
318           stop = \textcolor{keyword}{true};
319         \}
320       \textcolor{keywordflow}{else}
321         \{
322           MPI\_Testany (\hyperlink{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}{g\_numNeighbors}, \hyperlink{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}{g\_requests}, &index, &messageReceived, &
      status);
323         \}
324 
325       \textcolor{keywordflow}{if} (messageReceived)
326         \{
327           \textcolor{keywordtype}{int} count;
328           MPI\_Get\_count (&status, MPI\_CHAR, &count);
329 
330           \textcolor{comment}{// Get the meta data first}
331           uint64\_t* pTime = \textcolor{keyword}{reinterpret\_cast<}uint64\_t *\textcolor{keyword}{>} (\hyperlink{classns3_1_1NullMessageMpiInterface_ab6aaed51bb851d090273d5c44fe2aec0}{g\_pRxBuffers}[index]);
332           uint64\_t time = *pTime++;
333           uint64\_t guaranteeUpdate = *pTime++;
334 
335           uint32\_t* pData = \textcolor{keyword}{reinterpret\_cast<}uint32\_t *\textcolor{keyword}{>} (pTime);
336           uint32\_t node = *pData++;
337           uint32\_t dev  = *pData++;
338 
339           \hyperlink{namespacens3_1_1TracedValueCallback_a7ffd3e7c142ffe7c8a1d2db9b8de38ec}{Time} rxTime (time);
340 
341           \textcolor{comment}{// rxtime == 0 means this is a Null Message}
342           \textcolor{keywordflow}{if} (rxTime > \hyperlink{namespacens3_1_1TracedValueCallback_a7ffd3e7c142ffe7c8a1d2db9b8de38ec}{Time} (0))
343             \{
344               count -= \textcolor{keyword}{sizeof} (time) + \textcolor{keyword}{sizeof} (guaranteeUpdate) + \textcolor{keyword}{sizeof} (node) + \textcolor{keyword}{sizeof} (dev);
345 
346               Ptr<Packet> \hyperlink{lte__link__budget_8m_ac9de518908a968428863f829398a4e62}{p} = Create<Packet> (\textcolor{keyword}{reinterpret\_cast<}uint8\_t *\textcolor{keyword}{>} (pData), count, \textcolor{keyword}{true});
347 
348               \textcolor{comment}{// Find the correct node/device to schedule receive event}
349               Ptr<Node> pNode = \hyperlink{classns3_1_1NodeList_a80ac09977d48d29db5c704ac8483cf6c}{NodeList::GetNode} (node);
350               Ptr<MpiReceiver> pMpiRec = 0;
351               uint32\_t nDevices = pNode->GetNDevices ();
352               \textcolor{keywordflow}{for} (uint32\_t \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} = 0; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} < nDevices; ++\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i})
353                 \{
354                   Ptr<NetDevice> pThisDev = pNode->GetDevice (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i});
355                   \textcolor{keywordflow}{if} (pThisDev->GetIfIndex () == dev)
356                     \{
357                       pMpiRec = pThisDev->GetObject<MpiReceiver> ();
358                       \textcolor{keywordflow}{break};
359                     \}
360                 \}
361               \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (pNode && pMpiRec);
362 
363               \textcolor{comment}{// Schedule the rx event}
364               \hyperlink{classns3_1_1Simulator_a86dbaef45a15a42365d7d2ae550449f6}{Simulator::ScheduleWithContext} (pNode->GetId (), rxTime - 
      \hyperlink{classns3_1_1Simulator_ac3178fa975b419f7875e7105be122800}{Simulator::Now} (),
365                                               &\hyperlink{classns3_1_1MpiReceiver_a5c5506ca706198f61eaa2e550eca7ff3}{MpiReceiver::Receive}, pMpiRec, 
      \hyperlink{lte__link__budget_8m_ac9de518908a968428863f829398a4e62}{p});
366 
367             \}
368 
369           \textcolor{comment}{// Update guarantee time for both packet receives and Null Messages.}
370           Ptr<RemoteChannelBundle> bundle = \hyperlink{classns3_1_1RemoteChannelBundleManager_a143cfdce189ed68cc0917255ef0b849f}{RemoteChannelBundleManager::Find}
       (status.MPI\_SOURCE);
371           \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (bundle);
372 
373           bundle->SetGuaranteeTime (\hyperlink{namespacens3_1_1TracedValueCallback_a7ffd3e7c142ffe7c8a1d2db9b8de38ec}{Time} (guaranteeUpdate));
374 
375           \textcolor{comment}{// Re-queue the next read}
376           MPI\_Irecv (\hyperlink{classns3_1_1NullMessageMpiInterface_ab6aaed51bb851d090273d5c44fe2aec0}{g\_pRxBuffers}[index], NULL\_MESSAGE\_MAX\_MPI\_MSG\_SIZE, MPI\_CHAR, status.
      MPI\_SOURCE, 0,
377                      MPI\_COMM\_WORLD, &\hyperlink{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}{g\_requests}[index]);
378 
379         \}
380       \textcolor{keywordflow}{else}
381         \{
382           \textcolor{comment}{// if non-blocking and no message received in testany then stop message loop}
383           stop = \textcolor{keyword}{true};
384         \}
385     \}
386   \textcolor{keywordflow}{while} (!stop);
387 \textcolor{preprocessor}{#endif}
388 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 5


\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Receive\+Messages\+Blocking@{Receive\+Messages\+Blocking}}
\index{Receive\+Messages\+Blocking@{Receive\+Messages\+Blocking}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Receive\+Messages\+Blocking()}{ReceiveMessagesBlocking()}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Receive\+Messages\+Blocking (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a1fa1c0d0803d3aad54f54e05b361ac6f}{}\label{classns3_1_1NullMessageMpiInterface_a1fa1c0d0803d3aad54f54e05b361ac6f}
Blocking message receive. Will block until at least one message has been received. 
\begin{DoxyCode}
273 \{
274   \hyperlink{log-macros-disabled_8h_a8f7e4afc291c9d29a65c18ac1f79197b}{NS\_LOG\_FUNCTION\_NOARGS} ();
275 
276   \hyperlink{classns3_1_1NullMessageMpiInterface_a9ca96f3f6dc2df5f955505c441499430}{ReceiveMessages}(\textcolor{keyword}{true});
277 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 6


\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Receive\+Messages\+Non\+Blocking@{Receive\+Messages\+Non\+Blocking}}
\index{Receive\+Messages\+Non\+Blocking@{Receive\+Messages\+Non\+Blocking}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Receive\+Messages\+Non\+Blocking()}{ReceiveMessagesNonBlocking()}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Receive\+Messages\+Non\+Blocking (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a72b804a0df5b1a3b5f992c04e62e63c5}{}\label{classns3_1_1NullMessageMpiInterface_a72b804a0df5b1a3b5f992c04e62e63c5}
Non-\/blocking check for received messages complete. Will receive all messages that are queued up locally. 
\begin{DoxyCode}
282 \{
283   \hyperlink{log-macros-disabled_8h_a8f7e4afc291c9d29a65c18ac1f79197b}{NS\_LOG\_FUNCTION\_NOARGS} ();
284 
285   \hyperlink{classns3_1_1NullMessageMpiInterface_a9ca96f3f6dc2df5f955505c441499430}{ReceiveMessages}(\textcolor{keyword}{false});
286 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 7


\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Send\+Null\+Message@{Send\+Null\+Message}}
\index{Send\+Null\+Message@{Send\+Null\+Message}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Send\+Null\+Message(const Time \&guarantee\+Update, Ptr$<$ Remote\+Channel\+Bundle $>$ bundle)}{SendNullMessage(const Time &guaranteeUpdate, Ptr< RemoteChannelBundle > bundle)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Send\+Null\+Message (
\begin{DoxyParamCaption}
\item[{const {\bf Time} \&}]{guarantee\+Update, }
\item[{{\bf Ptr}$<$ {\bf Remote\+Channel\+Bundle} $>$}]{bundle}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a92aad3a1cd808f9434cb231887f830de}{}\label{classns3_1_1NullMessageMpiInterface_a92aad3a1cd808f9434cb231887f830de}


Send a Null Message to across the specified bundle. 


\begin{DoxyParams}{Parameters}
{\em guarantee\+Update} & guarantee update time for the Null Message  the destination bundle for the Null Message.\\
\hline
\end{DoxyParams}
Guarantee update time is the lower bound time on the next possible event from this M\+PI task to the remote M\+PI task across the bundle. Remote task may execute events up to time.

Null Messages are sent when a packet has not been sent across this bundle in order to allow time advancement on the remote M\+PI task. 
\begin{DoxyCode}
241 \{
242   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (guarantee\_update.GetTimeStep () << bundle);
243 
244   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\_enabled});
245 
246 \textcolor{preprocessor}{#ifdef NS3\_MPI}
247 
248   NullMessageSentBuffer sendBuf;
249   \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\_pendingTx}.push\_back (sendBuf);
250   std::list<NullMessageSentBuffer>::reverse\_iterator iter = \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\_pendingTx}.rbegin (); \textcolor{comment}{// Points to
       the last element}
251 
252   uint32\_t bufferSize = 2 * \textcolor{keyword}{sizeof} (uint64\_t) + 2 * \textcolor{keyword}{sizeof} (uint32\_t);
253   uint8\_t* buffer =  \textcolor{keyword}{new} uint8\_t[bufferSize];
254   iter->SetBuffer (buffer);
255   \textcolor{comment}{// Add the time, dest node and dest device}
256   uint64\_t* pTime = reinterpret\_cast <uint64\_t *> (buffer);
257   *pTime++ = 0;
258   *pTime++ = guarantee\_update.GetInteger ();
259   uint32\_t* pData = \textcolor{keyword}{reinterpret\_cast<}uint32\_t *\textcolor{keyword}{>} (pTime);
260   *pData++ = 0;
261   *pData++ = 0;
262 
263   \textcolor{comment}{// Find the system id for the destination MPI rank}
264   uint32\_t nodeSysId = bundle->GetSystemId ();
265 
266   MPI\_Isend (reinterpret\_cast<void *> (iter->GetBuffer ()), bufferSize, MPI\_CHAR, nodeSysId,
267              0, MPI\_COMM\_WORLD, (iter->GetRequest ()));
268 \textcolor{preprocessor}{#endif}
269 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 8




Here is the caller graph for this function\+:
% FIG 9


\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Send\+Packet@{Send\+Packet}}
\index{Send\+Packet@{Send\+Packet}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Send\+Packet(\+Ptr$<$ Packet $>$ p, const Time \&rx\+Time, uint32\+\_\+t node, uint32\+\_\+t dev)}{SendPacket(Ptr< Packet > p, const Time &rxTime, uint32_t node, uint32_t dev)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Send\+Packet (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Packet} $>$}]{p, }
\item[{const {\bf Time} \&}]{rx\+Time, }
\item[{uint32\+\_\+t}]{node, }
\item[{uint32\+\_\+t}]{dev}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a5bef503661f681b69f0c69abda3ed25a}{}\label{classns3_1_1NullMessageMpiInterface_a5bef503661f681b69f0c69abda3ed25a}

\begin{DoxyParams}{Parameters}
{\em p} & packet to send \\
\hline
{\em rx\+Time} & received time at destination node \\
\hline
{\em node} & destination node \\
\hline
{\em dev} & destination device\\
\hline
\end{DoxyParams}
Serialize and send a packet to the specified node and net device. 

Implements \hyperlink{classns3_1_1ParallelCommunicationInterface_a0a95966814596b4e668825fb00756639}{ns3\+::\+Parallel\+Communication\+Interface}.


\begin{DoxyCode}
198 \{
199   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << p << rxTime.GetTimeStep () << node << dev);
200 
201   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\_enabled});
202 
203 \textcolor{preprocessor}{#ifdef NS3\_MPI}
204 
205   \textcolor{comment}{// Find the system id for the destination node}
206   Ptr<Node> destNode = \hyperlink{classns3_1_1NodeList_a80ac09977d48d29db5c704ac8483cf6c}{NodeList::GetNode} (node);
207   uint32\_t nodeSysId = destNode->GetSystemId ();
208 
209   NullMessageSentBuffer sendBuf;
210   \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\_pendingTx}.push\_back (sendBuf);
211   std::list<NullMessageSentBuffer>::reverse\_iterator iter = \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\_pendingTx}.rbegin (); \textcolor{comment}{// Points to
       the last element}
212 
213   uint32\_t serializedSize = p->\hyperlink{classns3_1_1Packet_a7416c3bc8c1a9a86c8ade4dfd1d67d2d}{GetSerializedSize} ();
214   uint32\_t bufferSize = serializedSize + ( 2 * \textcolor{keyword}{sizeof} (uint64\_t) ) + ( 2 * \textcolor{keyword}{sizeof} (uint32\_t) );
215   uint8\_t* buffer =  \textcolor{keyword}{new} uint8\_t[bufferSize];
216   iter->SetBuffer (buffer);
217   \textcolor{comment}{// Add the time, dest node and dest device}
218   uint64\_t t = rxTime.GetInteger ();
219   uint64\_t* pTime = reinterpret\_cast <uint64\_t *> (buffer);
220   *pTime++ = t;
221 
222   \hyperlink{namespacens3_1_1TracedValueCallback_a7ffd3e7c142ffe7c8a1d2db9b8de38ec}{Time} guarantee\_update = \hyperlink{classns3_1_1NullMessageSimulatorImpl_ab5e219b843d754b0e812181af6115a53}{NullMessageSimulatorImpl::GetInstance} ()
      ->\hyperlink{classns3_1_1NullMessageSimulatorImpl_a5d8006e0b0f3953887dcb525394f5dd3}{CalculateGuaranteeTime} (nodeSysId);
223   *pTime++ = guarantee\_update.\hyperlink{classns3_1_1Time_a40a7025b73dac7d02f8a4e1e54eaa5b5}{GetTimeStep} ();
224 
225   uint32\_t* pData = \textcolor{keyword}{reinterpret\_cast<}uint32\_t *\textcolor{keyword}{>} (pTime);
226   *pData++ = node;
227   *pData++ = dev;
228   \textcolor{comment}{// Serialize the packet}
229   p->\hyperlink{classns3_1_1Packet_a939e41b065c6f9f77d3f51373baeaf7e}{Serialize} (reinterpret\_cast<uint8\_t *> (pData), serializedSize);
230 
231   MPI\_Isend (reinterpret\_cast<void *> (iter->GetBuffer ()), bufferSize, MPI\_CHAR, nodeSysId,
232              0, MPI\_COMM\_WORLD, (iter->GetRequest ()));
233 
234   \hyperlink{classns3_1_1NullMessageSimulatorImpl_ab5e219b843d754b0e812181af6115a53}{NullMessageSimulatorImpl::GetInstance} ()->
      \hyperlink{classns3_1_1NullMessageSimulatorImpl_addc65b52a532801e4f2dc1fdffce2a66}{RescheduleNullMessageEvent} (nodeSysId);
235 
236 \textcolor{preprocessor}{#endif}
237 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 10


\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!Test\+Send\+Complete@{Test\+Send\+Complete}}
\index{Test\+Send\+Complete@{Test\+Send\+Complete}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{Test\+Send\+Complete()}{TestSendComplete()}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Null\+Message\+Mpi\+Interface\+::\+Test\+Send\+Complete (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a97d3958578fd342a456baf86d8f956ab}{}\label{classns3_1_1NullMessageMpiInterface_a97d3958578fd342a456baf86d8f956ab}
Check for completed sends 
\begin{DoxyCode}
392 \{
393   \hyperlink{log-macros-disabled_8h_a8f7e4afc291c9d29a65c18ac1f79197b}{NS\_LOG\_FUNCTION\_NOARGS} ();
394 
395   \hyperlink{assert_8h_a6dccdb0de9b252f60088ce281c49d052}{NS\_ASSERT} (\hyperlink{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{g\_enabled});
396 
397 \textcolor{preprocessor}{#ifdef NS3\_MPI}
398   std::list<NullMessageSentBuffer>::iterator iter = \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\_pendingTx}.begin ();
399   \textcolor{keywordflow}{while} (iter != \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\_pendingTx}.end ())
400     \{
401       MPI\_Status status;
402       \textcolor{keywordtype}{int} flag = 0;
403       MPI\_Test (iter->GetRequest (), &flag, &status);
404       std::list<NullMessageSentBuffer>::iterator current = iter; \textcolor{comment}{// Save current for erasing}
405       ++iter; \textcolor{comment}{// Advance to next}
406       \textcolor{keywordflow}{if} (flag)
407         \{ \textcolor{comment}{// This message is complete}
408           \hyperlink{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{g\_pendingTx}.erase (current);
409         \}
410     \}
411 \textcolor{preprocessor}{#endif}
412 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 11




\subsection{Member Data Documentation}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!g\+\_\+enabled@{g\+\_\+enabled}}
\index{g\+\_\+enabled@{g\+\_\+enabled}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{g\+\_\+enabled}{g_enabled}}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Null\+Message\+Mpi\+Interface\+::g\+\_\+enabled = {\bf false}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}{}\label{classns3_1_1NullMessageMpiInterface_ab4002d79e5319aae80e5bc39251ba609}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!g\+\_\+initialized@{g\+\_\+initialized}}
\index{g\+\_\+initialized@{g\+\_\+initialized}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{g\+\_\+initialized}{g_initialized}}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Null\+Message\+Mpi\+Interface\+::g\+\_\+initialized = {\bf false}\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a4f593d0bc0562f63fe183d3351d68c80}{}\label{classns3_1_1NullMessageMpiInterface_a4f593d0bc0562f63fe183d3351d68c80}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!g\+\_\+num\+Neighbors@{g\+\_\+num\+Neighbors}}
\index{g\+\_\+num\+Neighbors@{g\+\_\+num\+Neighbors}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{g\+\_\+num\+Neighbors}{g_numNeighbors}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Null\+Message\+Mpi\+Interface\+::g\+\_\+num\+Neighbors = 0\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}{}\label{classns3_1_1NullMessageMpiInterface_afb1c81a47bce9a9b80fea71c80a66ef9}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!g\+\_\+pending\+Tx@{g\+\_\+pending\+Tx}}
\index{g\+\_\+pending\+Tx@{g\+\_\+pending\+Tx}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{g\+\_\+pending\+Tx}{g_pendingTx}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf std\+::list}$<$ {\bf Null\+Message\+Sent\+Buffer} $>$ ns3\+::\+Null\+Message\+Mpi\+Interface\+::g\+\_\+pending\+Tx\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}{}\label{classns3_1_1NullMessageMpiInterface_ad4d5d7c2c323bb4f225b7364f8b1c824}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!g\+\_\+p\+Rx\+Buffers@{g\+\_\+p\+Rx\+Buffers}}
\index{g\+\_\+p\+Rx\+Buffers@{g\+\_\+p\+Rx\+Buffers}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{g\+\_\+p\+Rx\+Buffers}{g_pRxBuffers}}]{\setlength{\rightskip}{0pt plus 5cm}char $\ast$$\ast$ ns3\+::\+Null\+Message\+Mpi\+Interface\+::g\+\_\+p\+Rx\+Buffers\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1NullMessageMpiInterface_ab6aaed51bb851d090273d5c44fe2aec0}{}\label{classns3_1_1NullMessageMpiInterface_ab6aaed51bb851d090273d5c44fe2aec0}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!g\+\_\+requests@{g\+\_\+requests}}
\index{g\+\_\+requests@{g\+\_\+requests}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{g\+\_\+requests}{g_requests}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf M\+P\+I\+\_\+\+Request} $\ast$ ns3\+::\+Null\+Message\+Mpi\+Interface\+::g\+\_\+requests\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}{}\label{classns3_1_1NullMessageMpiInterface_a8a48f62af92d9d68b83296c0a3ddbb3f}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!g\+\_\+sid@{g\+\_\+sid}}
\index{g\+\_\+sid@{g\+\_\+sid}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{g\+\_\+sid}{g_sid}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Null\+Message\+Mpi\+Interface\+::g\+\_\+sid = 0\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1NullMessageMpiInterface_aba703fa18812299f38a533175e84789d}{}\label{classns3_1_1NullMessageMpiInterface_aba703fa18812299f38a533175e84789d}
\index{ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}!g\+\_\+size@{g\+\_\+size}}
\index{g\+\_\+size@{g\+\_\+size}!ns3\+::\+Null\+Message\+Mpi\+Interface@{ns3\+::\+Null\+Message\+Mpi\+Interface}}
\subsubsection[{\texorpdfstring{g\+\_\+size}{g_size}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Null\+Message\+Mpi\+Interface\+::g\+\_\+size = 1\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1NullMessageMpiInterface_acbc2b4d714259601b86e1bc1bc13e26a}{}\label{classns3_1_1NullMessageMpiInterface_acbc2b4d714259601b86e1bc1bc13e26a}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
mpi/model/\hyperlink{null-message-mpi-interface_8h}{null-\/message-\/mpi-\/interface.\+h}\item 
mpi/model/\hyperlink{null-message-mpi-interface_8cc}{null-\/message-\/mpi-\/interface.\+cc}\end{DoxyCompactItemize}
