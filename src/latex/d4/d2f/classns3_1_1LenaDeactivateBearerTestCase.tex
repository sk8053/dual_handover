\hypertarget{classns3_1_1LenaDeactivateBearerTestCase}{}\section{ns3\+:\+:Lena\+Deactivate\+Bearer\+Test\+Case Class Reference}
\label{classns3_1_1LenaDeactivateBearerTestCase}\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}


{\ttfamily \#include $<$lte-\/test-\/deactivate-\/bearer.\+h$>$}



Inheritance diagram for ns3\+:\+:Lena\+Deactivate\+Bearer\+Test\+Case\+:
% FIG 0


Collaboration diagram for ns3\+:\+:Lena\+Deactivate\+Bearer\+Test\+Case\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a4dba05305aa047cb95b414060d02c8e8}{Lena\+Deactivate\+Bearer\+Test\+Case} (std\+::vector$<$ uint16\+\_\+t $>$ dist, std\+::vector$<$ uint32\+\_\+t $>$ est\+Thr\+Pss\+Dl, std\+::vector$<$ uint16\+\_\+t $>$ packet\+Size, uint16\+\_\+t interval, bool error\+Model\+Enabled, bool use\+Ideal\+Rrc)
\item 
virtual \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_ad44880c5177df52b76017bfa8850cbc5}{$\sim$\+Lena\+Deactivate\+Bearer\+Test\+Case} ()
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a214d777e46f96b701efdfd360871f53f}{Do\+Run} (void)
\begin{DoxyCompactList}\small\item\em Implementation to actually run this \hyperlink{classns3_1_1TestCase}{Test\+Case}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Static Private Member Functions}
\begin{DoxyCompactItemize}
\item 
static std\+::string \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_aaae207a6200341a78589c7de27446675}{Build\+Name\+String} (uint16\+\_\+t n\+User, std\+::vector$<$ uint16\+\_\+t $>$ dist)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
uint16\+\_\+t \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a119f58840a145a5be90eef6e01784ee6}{m\+\_\+n\+User}
\item 
std\+::vector$<$ uint16\+\_\+t $>$ \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_aa65554d27a1987eff686328a3441e8d0}{m\+\_\+dist}
\item 
std\+::vector$<$ uint16\+\_\+t $>$ \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a0d6c5b51de98a92178ecaa55b4bfc9df}{m\+\_\+packet\+Size}
\item 
uint16\+\_\+t \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a9e0c220c5ffe150a033cff11146c620a}{m\+\_\+interval}
\item 
std\+::vector$<$ uint32\+\_\+t $>$ \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_afdb8a203e9b78c7d4b6262958d85d6f6}{m\+\_\+est\+Thr\+Pss\+Dl}
\item 
bool \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a3ec449d8bd99571df63d3fd1360d77a1}{m\+\_\+error\+Model\+Enabled}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Constructor \& Destructor Documentation}
\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}!Lena\+Deactivate\+Bearer\+Test\+Case@{Lena\+Deactivate\+Bearer\+Test\+Case}}
\index{Lena\+Deactivate\+Bearer\+Test\+Case@{Lena\+Deactivate\+Bearer\+Test\+Case}!ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\subsubsection[{\texorpdfstring{Lena\+Deactivate\+Bearer\+Test\+Case(std\+::vector$<$ uint16\+\_\+t $>$ dist, std\+::vector$<$ uint32\+\_\+t $>$ est\+Thr\+Pss\+Dl, std\+::vector$<$ uint16\+\_\+t $>$ packet\+Size, uint16\+\_\+t interval, bool error\+Model\+Enabled, bool use\+Ideal\+Rrc)}{LenaDeactivateBearerTestCase(std::vector< uint16_t > dist, std::vector< uint32_t > estThrPssDl, std::vector< uint16_t > packetSize, uint16_t interval, bool errorModelEnabled, bool useIdealRrc)}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case\+::\+Lena\+Deactivate\+Bearer\+Test\+Case (
\begin{DoxyParamCaption}
\item[{std\+::vector$<$ uint16\+\_\+t $>$}]{dist, }
\item[{std\+::vector$<$ uint32\+\_\+t $>$}]{est\+Thr\+Pss\+Dl, }
\item[{std\+::vector$<$ uint16\+\_\+t $>$}]{packet\+Size, }
\item[{uint16\+\_\+t}]{interval, }
\item[{bool}]{error\+Model\+Enabled, }
\item[{bool}]{use\+Ideal\+Rrc}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1LenaDeactivateBearerTestCase_a4dba05305aa047cb95b414060d02c8e8}{}\label{classns3_1_1LenaDeactivateBearerTestCase_a4dba05305aa047cb95b414060d02c8e8}

\begin{DoxyCode}
114   : \hyperlink{classns3_1_1TestCase_a3b0b91a96aac1933e8d146e019b9e207}{TestCase} (\hyperlink{classns3_1_1LenaDeactivateBearerTestCase_aaae207a6200341a78589c7de27446675}{BuildNameString} (dist.size (), dist)),
115     \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a119f58840a145a5be90eef6e01784ee6}{m\_nUser} (dist.size ()),
116     \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_aa65554d27a1987eff686328a3441e8d0}{m\_dist} (dist),
117     \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a0d6c5b51de98a92178ecaa55b4bfc9df}{m\_packetSize} (packetSize),
118     \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a9e0c220c5ffe150a033cff11146c620a}{m\_interval} (interval),
119     \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_afdb8a203e9b78c7d4b6262958d85d6f6}{m\_estThrPssDl} (estThrPssDl),
120     \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a3ec449d8bd99571df63d3fd1360d77a1}{m\_errorModelEnabled} (errorModelEnabled)
121 \{
122 \}
\end{DoxyCode}
\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}!````~Lena\+Deactivate\+Bearer\+Test\+Case@{$\sim$\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\index{````~Lena\+Deactivate\+Bearer\+Test\+Case@{$\sim$\+Lena\+Deactivate\+Bearer\+Test\+Case}!ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\subsubsection[{\texorpdfstring{$\sim$\+Lena\+Deactivate\+Bearer\+Test\+Case()}{~LenaDeactivateBearerTestCase()}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case\+::$\sim$\+Lena\+Deactivate\+Bearer\+Test\+Case (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classns3_1_1LenaDeactivateBearerTestCase_ad44880c5177df52b76017bfa8850cbc5}{}\label{classns3_1_1LenaDeactivateBearerTestCase_ad44880c5177df52b76017bfa8850cbc5}

\begin{DoxyCode}
125 \{
126 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}!Build\+Name\+String@{Build\+Name\+String}}
\index{Build\+Name\+String@{Build\+Name\+String}!ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\subsubsection[{\texorpdfstring{Build\+Name\+String(uint16\+\_\+t n\+User, std\+::vector$<$ uint16\+\_\+t $>$ dist)}{BuildNameString(uint16_t nUser, std::vector< uint16_t > dist)}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::string ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case\+::\+Build\+Name\+String (
\begin{DoxyParamCaption}
\item[{uint16\+\_\+t}]{n\+User, }
\item[{std\+::vector$<$ uint16\+\_\+t $>$}]{dist}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}, {\ttfamily [private]}}\hypertarget{classns3_1_1LenaDeactivateBearerTestCase_aaae207a6200341a78589c7de27446675}{}\label{classns3_1_1LenaDeactivateBearerTestCase_aaae207a6200341a78589c7de27446675}

\begin{DoxyCode}
102 \{
103   std::ostringstream oss;
104   oss << \textcolor{stringliteral}{"distances (m) = [ "};
105   \textcolor{keywordflow}{for} (std::vector<uint16\_t>::iterator it = dist.begin (); it != dist.end (); ++it)
106     \{
107       oss << *it << \textcolor{stringliteral}{" "};
108     \}
109   oss << \textcolor{stringliteral}{"]"};
110   \textcolor{keywordflow}{return} oss.str ();
111 \}
\end{DoxyCode}
\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}!Do\+Run@{Do\+Run}}
\index{Do\+Run@{Do\+Run}!ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\subsubsection[{\texorpdfstring{Do\+Run(void)}{DoRun(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case\+::\+Do\+Run (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [virtual]}}\hypertarget{classns3_1_1LenaDeactivateBearerTestCase_a214d777e46f96b701efdfd360871f53f}{}\label{classns3_1_1LenaDeactivateBearerTestCase_a214d777e46f96b701efdfd360871f53f}


Implementation to actually run this \hyperlink{classns3_1_1TestCase}{Test\+Case}. 

Subclasses should override this method to conduct their tests. 

Implements \hyperlink{classns3_1_1TestCase_a8ff74680cf017ed42011e4be51917a24}{ns3\+::\+Test\+Case}.


\begin{DoxyCode}
130 \{
131   \textcolor{keywordflow}{if} (!\hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a3ec449d8bd99571df63d3fd1360d77a1}{m\_errorModelEnabled})
132     \{
133       \hyperlink{group__config_ga2e7882df849d8ba4aaad31c934c40c06}{Config::SetDefault} (\textcolor{stringliteral}{"ns3::LteSpectrumPhy::CtrlErrorModelEnabled"}, BooleanValue (\textcolor{keyword}{
      false}));
134       \hyperlink{group__config_ga2e7882df849d8ba4aaad31c934c40c06}{Config::SetDefault} (\textcolor{stringliteral}{"ns3::LteSpectrumPhy::DataErrorModelEnabled"}, BooleanValue (\textcolor{keyword}{
      false}));
135     \}
136 
137   \hyperlink{group__config_ga2e7882df849d8ba4aaad31c934c40c06}{Config::SetDefault} (\textcolor{stringliteral}{"ns3::LteHelper::UseIdealRrc"}, BooleanValue (\textcolor{keyword}{true}));
138 
139 
140   Ptr<LteHelper> lteHelper = CreateObject<LteHelper> ();
141   Ptr<PointToPointEpcHelper>  epcHelper = CreateObject<PointToPointEpcHelper> ();
142   lteHelper->SetEpcHelper (epcHelper);
143 
144   Ptr<Node> pgw = epcHelper->GetPgwNode ();
145 
146   \textcolor{comment}{// Create a single RemoteHost}
147   NodeContainer remoteHostContainer;
148   remoteHostContainer.Create (1);
149   Ptr<Node> remoteHost = remoteHostContainer.Get (0);
150   InternetStackHelper internet;
151   internet.Install (remoteHostContainer);
152 
153   \textcolor{comment}{// Create the Internet}
154   PointToPointHelper p2ph;
155   p2ph.SetDeviceAttribute (\textcolor{stringliteral}{"DataRate"}, DataRateValue (DataRate (\textcolor{stringliteral}{"100Gb/s"})));
156   p2ph.SetDeviceAttribute (\textcolor{stringliteral}{"Mtu"}, UintegerValue (1500));
157   p2ph.SetChannelAttribute (\textcolor{stringliteral}{"Delay"}, TimeValue (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.001)));
158   NetDeviceContainer internetDevices = p2ph.Install (pgw, remoteHost);
159   Ipv4AddressHelper ipv4h;
160   ipv4h.SetBase (\textcolor{stringliteral}{"1.0.0.0"}, \textcolor{stringliteral}{"255.0.0.0"});
161   Ipv4InterfaceContainer internetIpIfaces = ipv4h.Assign (internetDevices);
162   \textcolor{comment}{// interface 0 is localhost, 1 is the p2p device}
163   Ipv4Address remoteHostAddr = internetIpIfaces.GetAddress (1);
164 
165   Ipv4StaticRoutingHelper ipv4RoutingHelper;
166   Ptr<Ipv4StaticRouting> remoteHostStaticRouting = ipv4RoutingHelper.GetStaticRouting (remoteHost->
      GetObject<Ipv4> ());
167   remoteHostStaticRouting->AddNetworkRouteTo (Ipv4Address (\textcolor{stringliteral}{"7.0.0.0"}), Ipv4Mask (\textcolor{stringliteral}{"255.0.0.0"}), 1);
168 
169   \textcolor{comment}{// LogLevel logLevel = (LogLevel)(LOG\_PREFIX\_FUNC | LOG\_PREFIX\_TIME | LOG\_LEVEL\_ALL);}
170 
171   \textcolor{comment}{// LogComponentEnable ("LenaTestDeactivateBearer", LOG\_LEVEL\_ALL);}
172   \textcolor{comment}{// LogComponentEnable ("LteHelper", logLevel);}
173   \textcolor{comment}{// LogComponentEnable ("EpcHelper", logLevel);}
174   \textcolor{comment}{// LogComponentEnable ("EpcEnbApplication", logLevel);}
175   \textcolor{comment}{// LogComponentEnable ("EpcSgwPgwApplication", logLevel);}
176   \textcolor{comment}{// LogComponentEnable ("EpcMme", logLevel);}
177   \textcolor{comment}{// LogComponentEnable ("LteEnbRrc", logLevel);}
178 
179   lteHelper->SetAttribute (\textcolor{stringliteral}{"PathlossModel"}, StringValue (\textcolor{stringliteral}{"ns3::FriisSpectrumPropagationLossModel"}));
180 
181   \textcolor{comment}{// Create Nodes: eNodeB and UE}
182   NodeContainer enbNodes;
183   NodeContainer ueNodes;
184   enbNodes.Create (1);
185   ueNodes.Create (\hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a119f58840a145a5be90eef6e01784ee6}{m\_nUser});
186 
187   \textcolor{comment}{// Install Mobility Model}
188   MobilityHelper mobility;
189   mobility.SetMobilityModel (\textcolor{stringliteral}{"ns3::ConstantPositionMobilityModel"});
190   mobility.Install (enbNodes);
191   mobility.SetMobilityModel (\textcolor{stringliteral}{"ns3::ConstantPositionMobilityModel"});
192   mobility.Install (ueNodes);
193 
194   \textcolor{comment}{// Create Devices and install them in the Nodes (eNB and UE)}
195   NetDeviceContainer enbDevs;
196   NetDeviceContainer ueDevs;
197   lteHelper->SetSchedulerType (\textcolor{stringliteral}{"ns3::PssFfMacScheduler"});
198   enbDevs = lteHelper->InstallEnbDevice (enbNodes);
199   ueDevs = lteHelper->InstallUeDevice (ueNodes);
200 
201   Ptr<LteEnbNetDevice> lteEnbDev = enbDevs.Get (0)->GetObject<LteEnbNetDevice> ();
202   Ptr<LteEnbPhy> enbPhy = lteEnbDev->GetPhy ();
203   enbPhy->SetAttribute (\textcolor{stringliteral}{"TxPower"}, DoubleValue (30.0));
204   enbPhy->SetAttribute (\textcolor{stringliteral}{"NoiseFigure"}, DoubleValue (5.0));
205 
206   \textcolor{comment}{// Set UEs' position and power}
207   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} = 0; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} < \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a119f58840a145a5be90eef6e01784ee6}{m\_nUser}; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}++)
208     \{
209       Ptr<ConstantPositionMobilityModel> mm = ueNodes.Get (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i})->GetObject<ConstantPositionMobilityModel> ()
      ;
210       mm->SetPosition (Vector (\hyperlink{classns3_1_1LenaDeactivateBearerTestCase_aa65554d27a1987eff686328a3441e8d0}{m\_dist}.at (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}), 0.0, 0.0));
211       Ptr<LteUeNetDevice> lteUeDev = ueDevs.Get (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i})->GetObject<LteUeNetDevice> ();
212       Ptr<LteUePhy> uePhy = lteUeDev->GetPhy ();
213       uePhy->SetAttribute (\textcolor{stringliteral}{"TxPower"}, DoubleValue (23.0));
214       uePhy->SetAttribute (\textcolor{stringliteral}{"NoiseFigure"}, DoubleValue (9.0));
215     \}
216 
217   \textcolor{comment}{// Install the IP stack on the UEs}
218   internet.Install (ueNodes);
219   Ipv4InterfaceContainer ueIpIface;
220   ueIpIface = epcHelper->AssignUeIpv4Address (NetDeviceContainer (ueDevs));
221 
222   \textcolor{comment}{// Assign IP address to UEs}
223   \textcolor{keywordflow}{for} (uint32\_t u = 0; u < ueNodes.GetN (); ++u)
224     \{
225       Ptr<Node> ueNode = ueNodes.Get (u);
226       \textcolor{comment}{// Set the default gateway for the UE}
227       Ptr<Ipv4StaticRouting> ueStaticRouting = ipv4RoutingHelper.GetStaticRouting (ueNode->GetObject<Ipv4> 
      ());
228       ueStaticRouting->SetDefaultRoute (epcHelper->GetUeDefaultGatewayAddress (), 1);
229     \}
230 
231   \textcolor{comment}{// Attach a UE to a eNB}
232   lteHelper->Attach (ueDevs, enbDevs.Get (0));
233 
234   \textcolor{comment}{// Activate an EPS bearer on all UEs}
235 
236   \textcolor{keywordflow}{for} (uint32\_t u = 0; u < ueNodes.GetN (); ++u)
237     \{
238       Ptr<NetDevice> ueDevice = ueDevs.Get (u);
239       GbrQosInformation qos;
240       qos.gbrDl = (\hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a0d6c5b51de98a92178ecaa55b4bfc9df}{m\_packetSize}.at (u) + 32) * (1000 / \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a9e0c220c5ffe150a033cff11146c620a}{m\_interval}) * 8;  \textcolor{comment}{// bit/s,
       considering IP, UDP, RLC, PDCP header size}
241       qos.gbrUl = (\hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a0d6c5b51de98a92178ecaa55b4bfc9df}{m\_packetSize}.at (u) + 32) * (1000 / \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a9e0c220c5ffe150a033cff11146c620a}{m\_interval}) * 8;
242       qos.mbrDl = qos.gbrDl;
243       qos.mbrUl = qos.gbrUl;
244 
245       \textcolor{keyword}{enum} \hyperlink{structns3_1_1EpsBearer_aecf0c67109c5eb4ec0b07226fff5885e}{EpsBearer::Qci} q = \hyperlink{structns3_1_1EpsBearer_aecf0c67109c5eb4ec0b07226fff5885ea02ebd970315c3f749f5abac6e0c3e6d7}{EpsBearer::GBR\_CONV\_VOICE};
246       EpsBearer bearer (q, qos);
247       bearer.arp.priorityLevel = 15 - (u + 1);
248       bearer.arp.preemptionCapability = \textcolor{keyword}{true};
249       bearer.arp.preemptionVulnerability = \textcolor{keyword}{true};
250       lteHelper->ActivateDedicatedEpsBearer (ueDevice, bearer, \hyperlink{classns3_1_1EpcTft_a48c099da249ba99152c2e597c864e155}{EpcTft::Default} ());
251     \}
252 
253 
254   \textcolor{comment}{// Install downlink and uplink applications}
255   uint16\_t dlPort = 1234;
256   uint16\_t ulPort = 2000;
257   PacketSinkHelper dlPacketSinkHelper (\textcolor{stringliteral}{"ns3::UdpSocketFactory"}, InetSocketAddress (
      \hyperlink{classns3_1_1Ipv4Address_a7a39b330c8e701183a411d5779fca1a4}{Ipv4Address::GetAny} (), dlPort));
258   PacketSinkHelper ulPacketSinkHelper (\textcolor{stringliteral}{"ns3::UdpSocketFactory"}, InetSocketAddress (
      \hyperlink{classns3_1_1Ipv4Address_a7a39b330c8e701183a411d5779fca1a4}{Ipv4Address::GetAny} (), ulPort));
259   ApplicationContainer clientApps;
260   ApplicationContainer serverApps;
261   \textcolor{keywordflow}{for} (uint32\_t u = 0; u < ueNodes.GetN (); ++u)
262     \{
263       ++ulPort;
264       serverApps.Add (dlPacketSinkHelper.Install (ueNodes.Get (u))); \textcolor{comment}{// receive packets from remotehost}
265       serverApps.Add (ulPacketSinkHelper.Install (remoteHost));  \textcolor{comment}{// receive packets from UEs}
266 
267       UdpClientHelper dlClient (ueIpIface.GetAddress (u), dlPort); \textcolor{comment}{// uplink packets generator}
268       dlClient.SetAttribute (\textcolor{stringliteral}{"Interval"}, TimeValue (\hyperlink{group__timecivil_gaf26127cf4571146b83a92ee18679c7a9}{MilliSeconds} (
      \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a9e0c220c5ffe150a033cff11146c620a}{m\_interval})));
269       dlClient.SetAttribute (\textcolor{stringliteral}{"MaxPackets"}, UintegerValue (1000000));
270       dlClient.SetAttribute (\textcolor{stringliteral}{"PacketSize"}, UintegerValue (\hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a0d6c5b51de98a92178ecaa55b4bfc9df}{m\_packetSize}.at (u)));
271 
272       UdpClientHelper ulClient (remoteHostAddr, ulPort);           \textcolor{comment}{// downlink packets generator}
273       ulClient.SetAttribute (\textcolor{stringliteral}{"Interval"}, TimeValue (\hyperlink{group__timecivil_gaf26127cf4571146b83a92ee18679c7a9}{MilliSeconds} (
      \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a9e0c220c5ffe150a033cff11146c620a}{m\_interval})));
274       ulClient.SetAttribute (\textcolor{stringliteral}{"MaxPackets"}, UintegerValue (1000000));
275       ulClient.SetAttribute (\textcolor{stringliteral}{"PacketSize"}, UintegerValue (\hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a0d6c5b51de98a92178ecaa55b4bfc9df}{m\_packetSize}.at (u)));
276 
277       clientApps.Add (dlClient.Install (remoteHost));
278       clientApps.Add (ulClient.Install (ueNodes.Get (u)));
279     \}
280 
281 
282   serverApps.Start (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.030));
283   clientApps.Start (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.030));
284 
285   \textcolor{keywordtype}{double} statsStartTime = 0.04; \textcolor{comment}{// need to allow for RRC connection establishment + SRS}
286   \textcolor{keywordtype}{double} statsDuration = 1.0;
287   \textcolor{keywordtype}{double} tolerance = 0.1;
288 
289   lteHelper->EnableRlcTraces ();
290   Ptr<RadioBearerStatsCalculator> rlcStats = lteHelper->GetRlcStats ();
291   rlcStats->SetAttribute (\textcolor{stringliteral}{"StartTime"}, TimeValue (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (statsStartTime)));
292   rlcStats->SetAttribute (\textcolor{stringliteral}{"EpochDuration"}, TimeValue (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (statsDuration)));
293 
294 
295   \textcolor{comment}{//get ue device pointer for UE-ID 0 IMSI 1 and enb device pointer}
296   Ptr<NetDevice> ueDevice = ueDevs.Get (0);
297   Ptr<NetDevice> enbDevice = enbDevs.Get (0);
298 
299   \textcolor{comment}{/*}
300 \textcolor{comment}{   *   Instantiate De-activation using Simulator::Schedule() method which will initiate bearer
       de-activation after deActivateTime}
301 \textcolor{comment}{   *   Instantiate De-activation in sequence (Time const &time, MEM mem\_ptr, OBJ obj, T1 a1, T2 a2, T3 a3)}
302 \textcolor{comment}{   */}
303   \hyperlink{namespacens3_1_1TracedValueCallback_a7ffd3e7c142ffe7c8a1d2db9b8de38ec}{Time} deActivateTime (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (1.5));
304   \hyperlink{classns3_1_1Simulator_a671882c894a08af4a5e91181bf1eec13}{Simulator::Schedule} (deActivateTime, &
      \hyperlink{classns3_1_1LteHelper_a58e90297e466808af034b827870e089e}{LteHelper::DeActivateDedicatedEpsBearer}, lteHelper, ueDevice, 
      enbDevice, 2);
305 
306   \textcolor{comment}{//stop simulation after 3 seconds}
307   \hyperlink{classns3_1_1Simulator_a2335ba5b62e9066e893fecb21b7f6afd}{Simulator::Stop} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (3.0));
308 
309   \hyperlink{classns3_1_1Simulator_a84be982e6d03b62c3dc3303c75a9b909}{Simulator::Run} ();
310 
311   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"DL - Test with "} << m\_nUser << \textcolor{stringliteral}{" user(s)"});
312   std::vector <uint64\_t> dlDataRxed;
313   std::vector <uint64\_t> dlDataTxed;
314   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} = 0; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} < \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a119f58840a145a5be90eef6e01784ee6}{m\_nUser}; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}++)
315     \{
316       \textcolor{comment}{// get the imsi}
317       uint64\_t imsi = ueDevs.Get (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i})->GetObject<LteUeNetDevice> ()->GetImsi ();
318       \textcolor{comment}{// get the lcId}
319       \textcolor{comment}{// lcId is hard-coded, since only one dedicated bearer is added}
320       uint8\_t lcId = 4;
321       dlDataRxed.push\_back (rlcStats->GetDlRxData (imsi, lcId));
322       dlDataTxed.push\_back (rlcStats->GetDlTxData (imsi, lcId));
323       \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"\(\backslash\)tUser "} << \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} << \textcolor{stringliteral}{" dist "} << \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_aa65554d27a1987eff686328a3441e8d0}{m\_dist}.at (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}) << \textcolor{stringliteral}{" imsi "} << imsi << \textcolor{stringliteral}{"
       bytes rxed "} << (double)dlDataRxed.at (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}) << \textcolor{stringliteral}{"  thr "} << (double)dlDataRxed.at (
      \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}) / statsDuration << \textcolor{stringliteral}{" ref "} << \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_afdb8a203e9b78c7d4b6262958d85d6f6}{m\_estThrPssDl}.at (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}));
324       \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"\(\backslash\)tUser "} << \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} << \textcolor{stringliteral}{" imsi "} << imsi << \textcolor{stringliteral}{" bytes txed "} << (\textcolor{keywordtype}{double})dlDataTxed.
      at (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}) << \textcolor{stringliteral}{"  thr "} << (double)dlDataTxed.at (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}) / statsDuration);
325     \}
326 
327   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} = 0; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} < \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_a119f58840a145a5be90eef6e01784ee6}{m\_nUser}; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}++)
328     \{
329       uint64\_t imsi = ueDevs.Get (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i})->GetObject<LteUeNetDevice> ()->GetImsi ();
330 
331       \textcolor{comment}{/*}
332 \textcolor{comment}{       * For UE ID-0 IMSI 1, LCID=4 is deactivated hence If traffic seen on it, test case should fail}
333 \textcolor{comment}{       * Else For other UE's, test case should validate throughput}
334 \textcolor{comment}{       */}
335       \textcolor{keywordflow}{if} (imsi == 1)
336         \{
337           \hyperlink{group__testing_ga2a9d78cffb3db8e867c35fff0b698cf5}{NS\_TEST\_ASSERT\_MSG\_EQ} ((\textcolor{keywordtype}{double})dlDataTxed.at (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}), 0, \textcolor{stringliteral}{"Invalid LCID in
       Statistics "});
338         \}
339       \textcolor{keywordflow}{else}
340         \{
341           \hyperlink{group__testing_ga9e7861b56b4e70db3b56044cb7a28e41}{NS\_TEST\_ASSERT\_MSG\_EQ\_TOL} ((\textcolor{keywordtype}{double})dlDataTxed.at (
      \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}) / statsDuration, \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_afdb8a203e9b78c7d4b6262958d85d6f6}{m\_estThrPssDl}.at (\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}), \hyperlink{classns3_1_1LenaDeactivateBearerTestCase_afdb8a203e9b78c7d4b6262958d85d6f6}{m\_estThrPssDl}.at (
      \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}) * tolerance, \textcolor{stringliteral}{" Unfair Throughput!"});
342         \}
343     \}
344 
345   \hyperlink{classns3_1_1Simulator_a2a056e59a6623225df0957eda0ee8252}{Simulator::Destroy} ();
346 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2




\subsection{Member Data Documentation}
\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}!m\+\_\+dist@{m\+\_\+dist}}
\index{m\+\_\+dist@{m\+\_\+dist}!ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+dist}{m_dist}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<$uint16\+\_\+t$>$ ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case\+::m\+\_\+dist\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1LenaDeactivateBearerTestCase_aa65554d27a1987eff686328a3441e8d0}{}\label{classns3_1_1LenaDeactivateBearerTestCase_aa65554d27a1987eff686328a3441e8d0}
\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}!m\+\_\+error\+Model\+Enabled@{m\+\_\+error\+Model\+Enabled}}
\index{m\+\_\+error\+Model\+Enabled@{m\+\_\+error\+Model\+Enabled}!ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+error\+Model\+Enabled}{m_errorModelEnabled}}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case\+::m\+\_\+error\+Model\+Enabled\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1LenaDeactivateBearerTestCase_a3ec449d8bd99571df63d3fd1360d77a1}{}\label{classns3_1_1LenaDeactivateBearerTestCase_a3ec449d8bd99571df63d3fd1360d77a1}
\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}!m\+\_\+est\+Thr\+Pss\+Dl@{m\+\_\+est\+Thr\+Pss\+Dl}}
\index{m\+\_\+est\+Thr\+Pss\+Dl@{m\+\_\+est\+Thr\+Pss\+Dl}!ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+est\+Thr\+Pss\+Dl}{m_estThrPssDl}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<$uint32\+\_\+t$>$ ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case\+::m\+\_\+est\+Thr\+Pss\+Dl\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1LenaDeactivateBearerTestCase_afdb8a203e9b78c7d4b6262958d85d6f6}{}\label{classns3_1_1LenaDeactivateBearerTestCase_afdb8a203e9b78c7d4b6262958d85d6f6}
\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}!m\+\_\+interval@{m\+\_\+interval}}
\index{m\+\_\+interval@{m\+\_\+interval}!ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+interval}{m_interval}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case\+::m\+\_\+interval\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1LenaDeactivateBearerTestCase_a9e0c220c5ffe150a033cff11146c620a}{}\label{classns3_1_1LenaDeactivateBearerTestCase_a9e0c220c5ffe150a033cff11146c620a}
\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}!m\+\_\+n\+User@{m\+\_\+n\+User}}
\index{m\+\_\+n\+User@{m\+\_\+n\+User}!ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+n\+User}{m_nUser}}]{\setlength{\rightskip}{0pt plus 5cm}uint16\+\_\+t ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case\+::m\+\_\+n\+User\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1LenaDeactivateBearerTestCase_a119f58840a145a5be90eef6e01784ee6}{}\label{classns3_1_1LenaDeactivateBearerTestCase_a119f58840a145a5be90eef6e01784ee6}
\index{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}!m\+\_\+packet\+Size@{m\+\_\+packet\+Size}}
\index{m\+\_\+packet\+Size@{m\+\_\+packet\+Size}!ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case@{ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+packet\+Size}{m_packetSize}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<$uint16\+\_\+t$>$ ns3\+::\+Lena\+Deactivate\+Bearer\+Test\+Case\+::m\+\_\+packet\+Size\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1LenaDeactivateBearerTestCase_a0d6c5b51de98a92178ecaa55b4bfc9df}{}\label{classns3_1_1LenaDeactivateBearerTestCase_a0d6c5b51de98a92178ecaa55b4bfc9df}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lte/test/\hyperlink{lte-test-deactivate-bearer_8h}{lte-\/test-\/deactivate-\/bearer.\+h}\item 
lte/test/\hyperlink{lte-test-deactivate-bearer_8cc}{lte-\/test-\/deactivate-\/bearer.\+cc}\end{DoxyCompactItemize}
