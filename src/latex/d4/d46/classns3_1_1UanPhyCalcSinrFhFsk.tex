\hypertarget{classns3_1_1UanPhyCalcSinrFhFsk}{}\section{ns3\+:\+:Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk Class Reference}
\label{classns3_1_1UanPhyCalcSinrFhFsk}\index{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}}


{\ttfamily \#include $<$uan-\/phy-\/gen.\+h$>$}



Inheritance diagram for ns3\+:\+:Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk\+:
% FIG 0


Collaboration diagram for ns3\+:\+:Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classns3_1_1UanPhyCalcSinrFhFsk_a0b8284d527492e7dfadd160e6e8bab97}{Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk} ()
\item 
virtual \hyperlink{classns3_1_1UanPhyCalcSinrFhFsk_a5eb28cdd599ea53f641901364a733eb3}{$\sim$\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk} ()
\item 
virtual double \hyperlink{classns3_1_1UanPhyCalcSinrFhFsk_a6d728e7e7fa4c3ce682bae527d0c7db3}{Calc\+Sinr\+Db} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ pkt, \hyperlink{classns3_1_1Time}{Time} arr\+Time, double rx\+Power\+Db, double amb\+Noise\+Db, \hyperlink{classns3_1_1UanTxMode}{Uan\+Tx\+Mode} mode, \hyperlink{classns3_1_1UanPdp}{Uan\+Pdp} pdp, const \hyperlink{classns3_1_1UanTransducer_a95332a21e30506421a116d4b5c4dfd75}{Uan\+Transducer\+::\+Arrival\+List} \&arrival\+List) const 
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classns3_1_1TypeId}{Type\+Id} \hyperlink{classns3_1_1UanPhyCalcSinrFhFsk_a8a6924587390c3244eae009b52d2fd6e}{Get\+Type\+Id} (void)
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
uint32\+\_\+t \hyperlink{classns3_1_1UanPhyCalcSinrFhFsk_ad3f404c81ac8fcc8987c991b51ecb717}{m\+\_\+hops}
\begin{DoxyCompactList}\small\item\em Number of hops. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
W\+H\+OI Micromodem like F\+H-\/\+F\+SK model.

Model of interference calculation for F\+H-\/\+F\+SK wherein all nodes use an identical hopping pattern. In this case, there is an (M-\/1)$\ast$\+Symbol\+Time clearing time between symbols transmitted on the same frequency. This clearing time combats I\+SI from channel delay spread and also has a byproduct of possibly reducing interference from other transmitted packets. 

\subsection{Constructor \& Destructor Documentation}
\index{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}!Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}}
\index{Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}!ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}}
\subsubsection[{\texorpdfstring{Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk()}{UanPhyCalcSinrFhFsk()}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1UanPhyCalcSinrFhFsk_a0b8284d527492e7dfadd160e6e8bab97}{}\label{classns3_1_1UanPhyCalcSinrFhFsk_a0b8284d527492e7dfadd160e6e8bab97}
Constructor 
\begin{DoxyCode}
101 \{
102 
103 \}
\end{DoxyCode}
\index{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}!````~Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{$\sim$\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}}
\index{````~Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{$\sim$\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}!ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}}
\subsubsection[{\texorpdfstring{$\sim$\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk()}{~UanPhyCalcSinrFhFsk()}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk\+::$\sim$\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classns3_1_1UanPhyCalcSinrFhFsk_a5eb28cdd599ea53f641901364a733eb3}{}\label{classns3_1_1UanPhyCalcSinrFhFsk_a5eb28cdd599ea53f641901364a733eb3}
Destructor 
\begin{DoxyCode}
105 \{
106 
107 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}!Calc\+Sinr\+Db@{Calc\+Sinr\+Db}}
\index{Calc\+Sinr\+Db@{Calc\+Sinr\+Db}!ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}}
\subsubsection[{\texorpdfstring{Calc\+Sinr\+Db(\+Ptr$<$ Packet $>$ pkt, Time arr\+Time, double rx\+Power\+Db, double amb\+Noise\+Db, Uan\+Tx\+Mode mode, Uan\+Pdp pdp, const Uan\+Transducer\+::\+Arrival\+List \&arrival\+List) const }{CalcSinrDb(Ptr< Packet > pkt, Time arrTime, double rxPowerDb, double ambNoiseDb, UanTxMode mode, UanPdp pdp, const UanTransducer::ArrivalList &arrivalList) const }}]{\setlength{\rightskip}{0pt plus 5cm}double ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk\+::\+Calc\+Sinr\+Db (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Packet} $>$}]{pkt, }
\item[{{\bf Time}}]{arr\+Time, }
\item[{double}]{rx\+Power\+Db, }
\item[{double}]{amb\+Noise\+Db, }
\item[{{\bf Uan\+Tx\+Mode}}]{mode, }
\item[{{\bf Uan\+Pdp}}]{pdp, }
\item[{const {\bf Uan\+Transducer\+::\+Arrival\+List} \&}]{arrival\+List}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classns3_1_1UanPhyCalcSinrFhFsk_a6d728e7e7fa4c3ce682bae527d0c7db3}{}\label{classns3_1_1UanPhyCalcSinrFhFsk_a6d728e7e7fa4c3ce682bae527d0c7db3}
Calculate the S\+I\+NR value for a packet.


\begin{DoxyParams}{Parameters}
{\em pkt} & \hyperlink{classns3_1_1Packet}{Packet} to calculate S\+I\+NR for. \\
\hline
{\em arr\+Time} & Arrival time of pkt. \\
\hline
{\em rx\+Power\+Db} & The received signal strength of the packet in dB re 1 u\+Pa. \\
\hline
{\em amb\+Noise\+Db} & Ambient channel noise in dB re 1 u\+Pa. \\
\hline
{\em mode} & TX Mode of pkt. \\
\hline
{\em pdp} & Power delay profile of pkt. \\
\hline
{\em arrival\+List} & List of interfering arrivals given from Transducer. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
The S\+I\+NR in dB re 1 u\+Pa. 
\end{DoxyReturn}


Implements \hyperlink{classns3_1_1UanPhyCalcSinr_ad595f00cc07f863e9f5f957e2f772d56}{ns3\+::\+Uan\+Phy\+Calc\+Sinr}.


\begin{DoxyCode}
132 \{
133   \textcolor{keywordflow}{if} (mode.GetModType () != \hyperlink{classns3_1_1UanTxMode_a0e822d222c13aa9499c96d9b3ad21223aed210294b6a9642f3f027ccb74cdf7b6}{UanTxMode::FSK})
134     \{
135       \hyperlink{group__logging_gade7208b4009cdf0e25783cd26766f559}{NS\_LOG\_WARN} (\textcolor{stringliteral}{"Calculating SINR for unsupported mode type"});
136     \}
137 
138 
139 
140   \textcolor{keywordtype}{double} \hyperlink{lte_2model_2fading-traces_2fading__trace__generator_8m_ada841f58d7be618bfbc76c87e7d44086}{ts} = 1.0 / mode.GetPhyRateSps ();
141   \textcolor{keywordtype}{double} clearingTime = (\hyperlink{classns3_1_1UanPhyCalcSinrFhFsk_ad3f404c81ac8fcc8987c991b51ecb717}{m\_hops} - 1.0) * \hyperlink{lte_2model_2fading-traces_2fading__trace__generator_8m_ada841f58d7be618bfbc76c87e7d44086}{ts};
142   \textcolor{keywordtype}{double} csp = pdp.SumTapsFromMaxNc (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (ts));
143 
144   \textcolor{comment}{// Get maximum arrival offset}
145   \textcolor{keywordtype}{double} maxAmp = -1;
146   \textcolor{keywordtype}{double} maxTapDelay = 0.0;
147   \hyperlink{classns3_1_1UanPdp_a640e546e31696f75f9e638513b38ceba}{UanPdp::Iterator} pit = pdp.GetBegin ();
148   \textcolor{keywordflow}{for} (; pit != pdp.GetEnd (); pit++)
149     \{
150       \textcolor{keywordflow}{if} (std::abs (pit->GetAmp ()) > maxAmp)
151         \{
152           maxAmp = std::abs (pit->GetAmp ());
153           maxTapDelay = pit->GetDelay ().GetSeconds ();
154         \}
155     \}
156 
157 
158   \textcolor{keywordtype}{double} effRxPowerDb = rxPowerDb + \hyperlink{classns3_1_1UanPhyCalcSinr_a5f57a07d4f7e8e457a4c6fb946b9ec96}{KpToDb} (csp);
159 
160   \textcolor{keywordtype}{double} isiUpa = rxPowerDb * pdp.SumTapsFromMaxNc (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (ts + clearingTime), 
      \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (ts));
161   UanTransducer::ArrivalList::const\_iterator it = arrivalList.begin ();
162   \textcolor{keywordtype}{double} intKp = -\hyperlink{classns3_1_1UanPhyCalcSinr_a7af4e8735a93dabeef93d929fe166d27}{DbToKp} (effRxPowerDb);
163   \textcolor{keywordflow}{for} (; it != arrivalList.end (); it++)
164     \{
165       UanPdp intPdp = it->GetPdp ();
166       \textcolor{keywordtype}{double} tDelta = std::abs (arrTime.GetSeconds () + maxTapDelay - it->GetArrivalTime ().GetSeconds ());
167       \textcolor{comment}{// We want tDelta in terms of a single symbol (i.e. if tDelta = 7.3 symbol+clearing}
168       \textcolor{comment}{// times, the offset in terms of the arriving symbol power is}
169       \textcolor{comment}{// 0.3 symbol+clearing times.}
170 
171       int32\_t syms = (uint32\_t)( (\textcolor{keywordtype}{double}) tDelta / (ts + clearingTime));
172       tDelta = tDelta - syms * (ts + clearingTime);
173 
174       \textcolor{comment}{// Align to pktRx}
175       \textcolor{keywordflow}{if} (arrTime + \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (maxTapDelay)  > it->GetArrivalTime ())
176         \{
177           tDelta = ts + clearingTime - tDelta;
178         \}
179 
180       \textcolor{keywordtype}{double} intPower = 0.0;
181       \textcolor{keywordflow}{if} (tDelta < ts)
182         \{
183           intPower += intPdp.SumTapsNc (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (ts - tDelta));
184           intPower += intPdp.SumTapsNc (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (ts - tDelta + clearingTime),
185                                         \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (2 * ts - tDelta + clearingTime));
186         \}
187       \textcolor{keywordflow}{else}
188         \{
189           \hyperlink{namespacens3_1_1TracedValueCallback_a7ffd3e7c142ffe7c8a1d2db9b8de38ec}{Time} \hyperlink{namespacevisualizer_1_1core_a2a35e5d8a34af358b508dac8635754e0}{start} = \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (ts + clearingTime - tDelta);
190           \hyperlink{namespacens3_1_1TracedValueCallback_a7ffd3e7c142ffe7c8a1d2db9b8de38ec}{Time} end = start + \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (ts);
191           intPower += intPdp.SumTapsNc (start, end);
192 
193           start = start + \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (ts + clearingTime);
194           end = start + \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (ts);
195           intPower += intPdp.SumTapsNc (start, end);
196         \}
197       intKp += \hyperlink{classns3_1_1UanPhyCalcSinr_a7af4e8735a93dabeef93d929fe166d27}{DbToKp} (it->GetRxPowerDb ()) * intPower;
198     \}
199 
200   \textcolor{keywordtype}{double} totalIntDb = \hyperlink{classns3_1_1UanPhyCalcSinr_a5f57a07d4f7e8e457a4c6fb946b9ec96}{KpToDb} (isiUpa + intKp + \hyperlink{classns3_1_1UanPhyCalcSinr_a7af4e8735a93dabeef93d929fe166d27}{DbToKp} (ambNoiseDb));
201 
202   \hyperlink{group__logging_ga413f1886406d49f59a6a0a89b77b4d0a}{NS\_LOG\_DEBUG} (\textcolor{stringliteral}{"Calculating SINR:  RxPower = "} << rxPowerDb << \textcolor{stringliteral}{" dB.  Effective Rx power "} << 
      effRxPowerDb << \textcolor{stringliteral}{" dB.  Number of interferers = "} << arrivalList.size () << \textcolor{stringliteral}{"  Interference + noise power = "}
       << totalIntDb << \textcolor{stringliteral}{" dB.  SINR = "} << effRxPowerDb - totalIntDb << \textcolor{stringliteral}{" dB."});
203   \textcolor{keywordflow}{return} effRxPowerDb - totalIntDb;
204 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2


\index{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}!Get\+Type\+Id@{Get\+Type\+Id}}
\index{Get\+Type\+Id@{Get\+Type\+Id}!ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}}
\subsubsection[{\texorpdfstring{Get\+Type\+Id(void)}{GetTypeId(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Type\+Id} ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk\+::\+Get\+Type\+Id (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{classns3_1_1UanPhyCalcSinrFhFsk_a8a6924587390c3244eae009b52d2fd6e}{}\label{classns3_1_1UanPhyCalcSinrFhFsk_a8a6924587390c3244eae009b52d2fd6e}
Register this type. \begin{DoxyReturn}{Returns}
The \hyperlink{classns3_1_1TypeId}{Type\+Id}. 
\end{DoxyReturn}

\begin{DoxyCode}
111 \{
112   \textcolor{keyword}{static} TypeId tid = TypeId (\textcolor{stringliteral}{"ns3::UanPhyCalcSinrFhFsk"})
113     .SetParent<UanPhyCalcSinr> ()
114     .SetGroupName (\textcolor{stringliteral}{"Uan"})
115     .AddConstructor<\hyperlink{classns3_1_1UanPhyCalcSinrFhFsk_a0b8284d527492e7dfadd160e6e8bab97}{UanPhyCalcSinrFhFsk}> ()
116     .AddAttribute (\textcolor{stringliteral}{"NumberOfHops"},
117                    \textcolor{stringliteral}{"Number of frequencies in hopping pattern."},
118                    UintegerValue (13),
119                    MakeUintegerAccessor (&\hyperlink{classns3_1_1UanPhyCalcSinrFhFsk_ad3f404c81ac8fcc8987c991b51ecb717}{UanPhyCalcSinrFhFsk::m\_hops}),
120                    MakeUintegerChecker<uint32\_t> ())
121   ;
122   \textcolor{keywordflow}{return} tid;
123 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 3




\subsection{Member Data Documentation}
\index{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}!m\+\_\+hops@{m\+\_\+hops}}
\index{m\+\_\+hops@{m\+\_\+hops}!ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk@{ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk}}
\subsubsection[{\texorpdfstring{m\+\_\+hops}{m_hops}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t ns3\+::\+Uan\+Phy\+Calc\+Sinr\+Fh\+Fsk\+::m\+\_\+hops\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1UanPhyCalcSinrFhFsk_ad3f404c81ac8fcc8987c991b51ecb717}{}\label{classns3_1_1UanPhyCalcSinrFhFsk_ad3f404c81ac8fcc8987c991b51ecb717}


Number of hops. 



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
uan/model/\hyperlink{uan-phy-gen_8h}{uan-\/phy-\/gen.\+h}\item 
uan/model/\hyperlink{uan-phy-gen_8cc}{uan-\/phy-\/gen.\+cc}\end{DoxyCompactItemize}
