\hypertarget{lr-wpan-data_8cc}{}\section{lr-\/wpan/examples/lr-\/wpan-\/data.cc File Reference}
\label{lr-wpan-data_8cc}\index{lr-\/wpan/examples/lr-\/wpan-\/data.\+cc@{lr-\/wpan/examples/lr-\/wpan-\/data.\+cc}}
{\ttfamily \#include $<$ns3/log.\+h$>$}\\*
{\ttfamily \#include $<$ns3/core-\/module.\+h$>$}\\*
{\ttfamily \#include $<$ns3/lr-\/wpan-\/module.\+h$>$}\\*
{\ttfamily \#include $<$ns3/propagation-\/loss-\/model.\+h$>$}\\*
{\ttfamily \#include $<$ns3/propagation-\/delay-\/model.\+h$>$}\\*
{\ttfamily \#include $<$ns3/simulator.\+h$>$}\\*
{\ttfamily \#include $<$ns3/single-\/model-\/spectrum-\/channel.\+h$>$}\\*
{\ttfamily \#include $<$ns3/constant-\/position-\/mobility-\/model.\+h$>$}\\*
{\ttfamily \#include $<$ns3/packet.\+h$>$}\\*
{\ttfamily \#include $<$iostream$>$}\\*
Include dependency graph for lr-\/wpan-\/data.cc\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \hyperlink{lr-wpan-data_8cc_a910681814411efb730f34de800607624}{Data\+Indication} (\hyperlink{structns3_1_1McpsDataIndicationParams}{Mcps\+Data\+Indication\+Params} params, \hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{lte__link__budget__x2__handover__measures_8m_ac9de518908a968428863f829398a4e62}{p})
\item 
static void \hyperlink{lr-wpan-data_8cc_a2007bf71d36faa06c946470857adc7f0}{Data\+Confirm} (\hyperlink{structns3_1_1McpsDataConfirmParams}{Mcps\+Data\+Confirm\+Params} params)
\item 
static void \hyperlink{lr-wpan-data_8cc_aed2e31e36ab5372d8c92e97e5e4215ae}{State\+Change\+Notification} (std\+::string context, \hyperlink{classns3_1_1Time}{Time} now, \hyperlink{group__lr-wpan_ga6494269d13d45c511a07b7ccbb1de754}{Lr\+Wpan\+Phy\+Enumeration} old\+State, \hyperlink{group__lr-wpan_ga6494269d13d45c511a07b7ccbb1de754}{Lr\+Wpan\+Phy\+Enumeration} new\+State)
\item 
int \hyperlink{lr-wpan-data_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{lr-\/wpan-\/data.\+cc@{lr-\/wpan-\/data.\+cc}!Data\+Confirm@{Data\+Confirm}}
\index{Data\+Confirm@{Data\+Confirm}!lr-\/wpan-\/data.\+cc@{lr-\/wpan-\/data.\+cc}}
\subsubsection[{\texorpdfstring{Data\+Confirm(\+Mcps\+Data\+Confirm\+Params params)}{DataConfirm(McpsDataConfirmParams params)}}]{\setlength{\rightskip}{0pt plus 5cm}static void Data\+Confirm (
\begin{DoxyParamCaption}
\item[{{\bf Mcps\+Data\+Confirm\+Params}}]{params}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{lr-wpan-data_8cc_a2007bf71d36faa06c946470857adc7f0}{}\label{lr-wpan-data_8cc_a2007bf71d36faa06c946470857adc7f0}

\begin{DoxyCode}
48 \{
49   \hyperlink{log-macros-disabled_8h_a0b36e5e182b37194f85ef1c5e979fb2e}{NS\_LOG\_UNCOND} (\textcolor{stringliteral}{"LrWpanMcpsDataConfirmStatus = "} << params.
      \hyperlink{structns3_1_1McpsDataConfirmParams_a8f62949258fb8ca94621ce33361a3953}{m\_status});
50 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 1


\index{lr-\/wpan-\/data.\+cc@{lr-\/wpan-\/data.\+cc}!Data\+Indication@{Data\+Indication}}
\index{Data\+Indication@{Data\+Indication}!lr-\/wpan-\/data.\+cc@{lr-\/wpan-\/data.\+cc}}
\subsubsection[{\texorpdfstring{Data\+Indication(\+Mcps\+Data\+Indication\+Params params, Ptr$<$ Packet $>$ p)}{DataIndication(McpsDataIndicationParams params, Ptr< Packet > p)}}]{\setlength{\rightskip}{0pt plus 5cm}static void Data\+Indication (
\begin{DoxyParamCaption}
\item[{{\bf Mcps\+Data\+Indication\+Params}}]{params, }
\item[{{\bf Ptr}$<$ {\bf Packet} $>$}]{p}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{lr-wpan-data_8cc_a910681814411efb730f34de800607624}{}\label{lr-wpan-data_8cc_a910681814411efb730f34de800607624}

\begin{DoxyCode}
43 \{
44   \hyperlink{log-macros-disabled_8h_a0b36e5e182b37194f85ef1c5e979fb2e}{NS\_LOG\_UNCOND} (\textcolor{stringliteral}{"Received packet of size "} << p->\hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} ());
45 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2




Here is the caller graph for this function\+:
% FIG 3


\index{lr-\/wpan-\/data.\+cc@{lr-\/wpan-\/data.\+cc}!main@{main}}
\index{main@{main}!lr-\/wpan-\/data.\+cc@{lr-\/wpan-\/data.\+cc}}
\subsubsection[{\texorpdfstring{main(int argc, char $\ast$argv[])}{main(int argc, char *argv[])}}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{lr-wpan-data_8cc_a0ddf1224851353fc92bfbff6f499fa97}{}\label{lr-wpan-data_8cc_a0ddf1224851353fc92bfbff6f499fa97}

\begin{DoxyCode}
60 \{
61   \textcolor{keywordtype}{bool} \hyperlink{openflow-switch_8cc_ab3f078684998b83967d507d0f453f454}{verbose} = \textcolor{keyword}{false};
62 
63   \hyperlink{classns3_1_1CommandLine}{CommandLine} cmd;
64 
65   cmd.\hyperlink{classns3_1_1CommandLine_addcfb546c7ad4c8bd0965654d55beb8e}{AddValue} (\textcolor{stringliteral}{"verbose"}, \textcolor{stringliteral}{"turn on all log components"}, verbose);
66 
67   cmd.\hyperlink{classns3_1_1CommandLine_a5c10b85b3207e5ecb48d907966923156}{Parse} (argc, argv);
68 
69   \hyperlink{classns3_1_1LrWpanHelper}{LrWpanHelper} lrWpanHelper;
70   \textcolor{keywordflow}{if} (verbose)
71     \{
72       lrWpanHelper.\hyperlink{classns3_1_1LrWpanHelper_a897bfee8ce0c3e4340545423cb3a69af}{EnableLogComponents} ();
73     \}
74 
75   \textcolor{comment}{// Enable calculation of FCS in the trailers. Only necessary when interacting with real devices or
       wireshark.}
76   \textcolor{comment}{// GlobalValue::Bind ("ChecksumEnabled", BooleanValue (true));}
77 
78   \textcolor{comment}{// Create 2 nodes, and a NetDevice for each one}
79   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} n0 = CreateObject <Node> ();
80   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} n1 = CreateObject <Node> ();
81 
82   \hyperlink{classns3_1_1Ptr}{Ptr<LrWpanNetDevice>} dev0 = CreateObject<LrWpanNetDevice> ();
83   \hyperlink{classns3_1_1Ptr}{Ptr<LrWpanNetDevice>} dev1 = CreateObject<LrWpanNetDevice> ();
84 
85   dev0->SetAddress (\hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:01"}));
86   dev1->SetAddress (\hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:02"}));
87 
88   \textcolor{comment}{// Each device must be attached to the same channel}
89   \hyperlink{classns3_1_1Ptr}{Ptr<SingleModelSpectrumChannel>} channel = 
      CreateObject<SingleModelSpectrumChannel> ();
90   \hyperlink{classns3_1_1Ptr}{Ptr<LogDistancePropagationLossModel>} propModel = 
      CreateObject<LogDistancePropagationLossModel> ();
91   \hyperlink{classns3_1_1Ptr}{Ptr<ConstantSpeedPropagationDelayModel>} delayModel = 
      CreateObject<ConstantSpeedPropagationDelayModel> ();
92   channel->\hyperlink{classns3_1_1SingleModelSpectrumChannel_a3d8c68e54e0e7659fdf715260d5613ac}{AddPropagationLossModel} (propModel);
93   channel->\hyperlink{classns3_1_1SingleModelSpectrumChannel_afd757c085623596ebf3da8264cfbaa45}{SetPropagationDelayModel} (delayModel);
94 
95   dev0->SetChannel (channel);
96   dev1->SetChannel (channel);
97 
98   \textcolor{comment}{// To complete configuration, a LrWpanNetDevice must be added to a node}
99   n0->\hyperlink{classns3_1_1Node_a42ff83ee1d5d1649c770d3f5b62375de}{AddDevice} (dev0);
100   n1->AddDevice (dev1);
101 
102   \textcolor{comment}{// Trace state changes in the phy}
103   dev0->GetPhy ()->TraceConnect (\textcolor{stringliteral}{"TrxState"}, std::string (\textcolor{stringliteral}{"phy0"}), \hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&
      \hyperlink{lr-wpan-data_8cc_aed2e31e36ab5372d8c92e97e5e4215ae}{StateChangeNotification}));
104   dev1->GetPhy ()->TraceConnect (\textcolor{stringliteral}{"TrxState"}, std::string (\textcolor{stringliteral}{"phy1"}), \hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&
      \hyperlink{lr-wpan-data_8cc_aed2e31e36ab5372d8c92e97e5e4215ae}{StateChangeNotification}));
105 
106   \hyperlink{classns3_1_1Ptr}{Ptr<ConstantPositionMobilityModel>} sender0Mobility = 
      CreateObject<ConstantPositionMobilityModel> ();
107   sender0Mobility->\hyperlink{classns3_1_1MobilityModel_ac584b3d5a309709d2f13ed6ada1e7640}{SetPosition} (\hyperlink{classns3_1_1Vector3D_a7e59b47bc94c9cb1dadff68c1d0112d8}{Vector} (0,0,0));
108   dev0->GetPhy ()->SetMobility (sender0Mobility);
109   \hyperlink{classns3_1_1Ptr}{Ptr<ConstantPositionMobilityModel>} sender1Mobility = 
      CreateObject<ConstantPositionMobilityModel> ();
110   \textcolor{comment}{// Configure position 10 m distance}
111   sender1Mobility->\hyperlink{classns3_1_1MobilityModel_ac584b3d5a309709d2f13ed6ada1e7640}{SetPosition} (\hyperlink{classns3_1_1Vector3D_a7e59b47bc94c9cb1dadff68c1d0112d8}{Vector} (0,10,0));
112   dev1->GetPhy ()->SetMobility (sender1Mobility);
113 
114   \hyperlink{classns3_1_1Callback}{McpsDataConfirmCallback} cb0;
115   cb0 = \hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&\hyperlink{lr-wpan-data_8cc_a2007bf71d36faa06c946470857adc7f0}{DataConfirm});
116   dev0->GetMac ()->SetMcpsDataConfirmCallback (cb0);
117 
118   \hyperlink{classns3_1_1Callback}{McpsDataIndicationCallback} cb1;
119   cb1 = \hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&\hyperlink{lr-wpan-data_8cc_a910681814411efb730f34de800607624}{DataIndication});
120   dev0->GetMac ()->SetMcpsDataIndicationCallback (cb1);
121 
122   \hyperlink{classns3_1_1Callback}{McpsDataConfirmCallback} cb2;
123   cb2 = \hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&\hyperlink{lr-wpan-data_8cc_a2007bf71d36faa06c946470857adc7f0}{DataConfirm});
124   dev1->GetMac ()->SetMcpsDataConfirmCallback (cb2);
125 
126   \hyperlink{classns3_1_1Callback}{McpsDataIndicationCallback} cb3;
127   cb3 = \hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&\hyperlink{lr-wpan-data_8cc_a910681814411efb730f34de800607624}{DataIndication});
128   dev1->GetMac ()->SetMcpsDataIndicationCallback (cb3);
129 
130   \textcolor{comment}{// Tracing}
131   lrWpanHelper.\hyperlink{classns3_1_1PcapHelperForDevice_a4ab183a2512120200d4a0e5d8ececd49}{EnablePcapAll} (std::string (\textcolor{stringliteral}{"lr-wpan-data"}), \textcolor{keyword}{true});
132   \hyperlink{classns3_1_1AsciiTraceHelper}{AsciiTraceHelper} ascii;
133   \hyperlink{classns3_1_1Ptr}{Ptr<OutputStreamWrapper>} stream = ascii.
      \hyperlink{classns3_1_1AsciiTraceHelper_a44960bf2ca32835024eaedd26d1c4f94}{CreateFileStream} (\textcolor{stringliteral}{"lr-wpan-data.tr"});
134   lrWpanHelper.\hyperlink{classns3_1_1AsciiTraceHelperForDevice_a63e57c878526c732924e14c1e52cca8b}{EnableAsciiAll} (stream);
135 
136   \textcolor{comment}{// The below should trigger two callbacks when end-to-end data is working}
137   \textcolor{comment}{// 1) DataConfirm callback is called}
138   \textcolor{comment}{// 2) DataIndication callback is called with value of 50}
139   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} p0 = Create<Packet> (50);  \textcolor{comment}{// 50 bytes of dummy data}
140   \hyperlink{structns3_1_1McpsDataRequestParams}{McpsDataRequestParams} params;
141   params.\hyperlink{structns3_1_1McpsDataRequestParams_a31f4c281d07cf3b5992d45416bd71309}{m\_srcAddrMode} = \hyperlink{group__lr-wpan_gga9ea4702ab11d5329e1593afebce06bbba7bf58267dde39bdabfeeb5793450c5e3}{SHORT\_ADDR};
142   params.m\_dstAddrMode = \hyperlink{group__lr-wpan_gga9ea4702ab11d5329e1593afebce06bbba7bf58267dde39bdabfeeb5793450c5e3}{SHORT\_ADDR};
143   params.m\_dstPanId = 0;
144   params.m\_dstAddr = \hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:02"});
145   params.m\_msduHandle = 0;
146   params.m\_txOptions = \hyperlink{group__lr-wpan_gga74ea891230ebf45d80d69a67266930a4a270a37d12b62bb8b5e92d646456244cf}{TX\_OPTION\_ACK};
147 \textcolor{comment}{//  dev0->GetMac ()->McpsDataRequest (params, p0);}
148   Simulator::ScheduleWithContext (1, \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.0),
149                                   &LrWpanMac::McpsDataRequest,
150                                   dev0->GetMac (), params, p0);
151 
152   \textcolor{comment}{// Send a packet back at time 2 seconds}
153   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} p2 = Create<Packet> (60);  \textcolor{comment}{// 60 bytes of dummy data}
154   params.m\_dstAddr = \hyperlink{classns3_1_1Mac16Address}{Mac16Address} (\textcolor{stringliteral}{"00:01"});
155   Simulator::ScheduleWithContext (2, \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (2.0),
156                                   &LrWpanMac::McpsDataRequest,
157                                   dev1->GetMac (), params, p2);
158 
159   Simulator::Run ();
160 
161   Simulator::Destroy ();
162   \textcolor{keywordflow}{return} 0;
163 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 4


\index{lr-\/wpan-\/data.\+cc@{lr-\/wpan-\/data.\+cc}!State\+Change\+Notification@{State\+Change\+Notification}}
\index{State\+Change\+Notification@{State\+Change\+Notification}!lr-\/wpan-\/data.\+cc@{lr-\/wpan-\/data.\+cc}}
\subsubsection[{\texorpdfstring{State\+Change\+Notification(std\+::string context, Time now, Lr\+Wpan\+Phy\+Enumeration old\+State, Lr\+Wpan\+Phy\+Enumeration new\+State)}{StateChangeNotification(std::string context, Time now, LrWpanPhyEnumeration oldState, LrWpanPhyEnumeration newState)}}]{\setlength{\rightskip}{0pt plus 5cm}static void State\+Change\+Notification (
\begin{DoxyParamCaption}
\item[{std\+::string}]{context, }
\item[{{\bf Time}}]{now, }
\item[{{\bf Lr\+Wpan\+Phy\+Enumeration}}]{old\+State, }
\item[{{\bf Lr\+Wpan\+Phy\+Enumeration}}]{new\+State}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}\hypertarget{lr-wpan-data_8cc_aed2e31e36ab5372d8c92e97e5e4215ae}{}\label{lr-wpan-data_8cc_aed2e31e36ab5372d8c92e97e5e4215ae}

\begin{DoxyCode}
53 \{
54   \hyperlink{log-macros-disabled_8h_a0b36e5e182b37194f85ef1c5e979fb2e}{NS\_LOG\_UNCOND} (context << \textcolor{stringliteral}{" state change at "} << now.\hyperlink{classns3_1_1Time_a8f20d5c3b0902d7b4320982f340b57c8}{GetSeconds} ()
55                          << \textcolor{stringliteral}{" from "} << LrWpanHelper::LrWpanPhyEnumerationPrinter (oldState)
56                          << \textcolor{stringliteral}{" to "} << LrWpanHelper::LrWpanPhyEnumerationPrinter (newState));
57 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 5




Here is the caller graph for this function\+:
% FIG 6


