\hypertarget{classIpv6PacketInfoTagTest}{}\section{Ipv6\+Packet\+Info\+Tag\+Test Class Reference}
\label{classIpv6PacketInfoTagTest}\index{Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}}


I\+Pv6 Packet\+Info\+Tag Test.  




Inheritance diagram for Ipv6\+Packet\+Info\+Tag\+Test\+:
% FIG 0


Collaboration diagram for Ipv6\+Packet\+Info\+Tag\+Test\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classIpv6PacketInfoTagTest_a8f298d8e4a044c024f9abf0c2a76b640}{Ipv6\+Packet\+Info\+Tag\+Test} ()
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classIpv6PacketInfoTagTest_a6b51aaddc63d2aaef95b72056cb5b36d}{Do\+Run} (void)
\begin{DoxyCompactList}\small\item\em Implementation to actually run this Test\+Case. \end{DoxyCompactList}\item 
void \hyperlink{classIpv6PacketInfoTagTest_a71bf0b1c87d70945d55fa28995a18db0}{Rx\+Cb} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Socket}{Socket} $>$ socket)
\begin{DoxyCompactList}\small\item\em Receive callback. \end{DoxyCompactList}\item 
void \hyperlink{classIpv6PacketInfoTagTest_ab880bf3bb45b329560c08666ed9aa16d}{Do\+Send\+Data} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Socket}{Socket} $>$ socket, std\+::string to)
\begin{DoxyCompactList}\small\item\em Send data. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
I\+Pv6 Packet\+Info\+Tag Test. 

\subsection{Constructor \& Destructor Documentation}
\index{Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}!Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}}
\index{Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}!Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}}
\subsubsection[{\texorpdfstring{Ipv6\+Packet\+Info\+Tag\+Test()}{Ipv6PacketInfoTagTest()}}]{\setlength{\rightskip}{0pt plus 5cm}Ipv6\+Packet\+Info\+Tag\+Test\+::\+Ipv6\+Packet\+Info\+Tag\+Test (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classIpv6PacketInfoTagTest_a8f298d8e4a044c024f9abf0c2a76b640}{}\label{classIpv6PacketInfoTagTest_a8f298d8e4a044c024f9abf0c2a76b640}

\begin{DoxyCode}
104   : \hyperlink{classns3_1_1TestCase_a3b0b91a96aac1933e8d146e019b9e207}{TestCase} (\textcolor{stringliteral}{"Ipv6PacketInfoTagTest"})
105 \{
106 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}!Do\+Run@{Do\+Run}}
\index{Do\+Run@{Do\+Run}!Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}}
\subsubsection[{\texorpdfstring{Do\+Run(void)}{DoRun(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv6\+Packet\+Info\+Tag\+Test\+::\+Do\+Run (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [virtual]}}\hypertarget{classIpv6PacketInfoTagTest_a6b51aaddc63d2aaef95b72056cb5b36d}{}\label{classIpv6PacketInfoTagTest_a6b51aaddc63d2aaef95b72056cb5b36d}


Implementation to actually run this Test\+Case. 

Subclasses should override this method to conduct their tests. 

Implements \hyperlink{classns3_1_1TestCase_a8ff74680cf017ed42011e4be51917a24}{ns3\+::\+Test\+Case}.


\begin{DoxyCode}
142 \{
143   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} node0 = CreateObject<Node> ();
144   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} node1 = CreateObject<Node> ();
145 
146   \hyperlink{classns3_1_1SimpleNetDeviceHelper}{SimpleNetDeviceHelper} simpleNetDevHelper;
147   \hyperlink{classns3_1_1NetDeviceContainer}{NetDeviceContainer} devs = simpleNetDevHelper.Install (
      \hyperlink{classns3_1_1NodeContainer}{NodeContainer} (node0, node1));
148   \hyperlink{classns3_1_1Ptr}{Ptr<SimpleNetDevice>} device = DynamicCast<SimpleNetDevice> (devs.
      \hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (0));
149   \hyperlink{classns3_1_1Ptr}{Ptr<SimpleNetDevice>} device2 = DynamicCast<SimpleNetDevice> (devs.
      \hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (1));
150 
151   \hyperlink{classns3_1_1InternetStackHelper}{InternetStackHelper} internet;
152   internet.\hyperlink{classns3_1_1InternetStackHelper_a10e2a35f410d0d1c90d979542c8bfd6e}{SetIpv4StackInstall} (\textcolor{keyword}{false});
153 
154   \textcolor{comment}{// For Node 0}
155   node0->\hyperlink{classns3_1_1Node_a42ff83ee1d5d1649c770d3f5b62375de}{AddDevice} (device);
156   internet.Install (node0);
157   \hyperlink{classns3_1_1Ptr}{Ptr<Ipv6>} ipv6 = node0->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1Ipv6}{Ipv6}> ();
158   \hyperlink{classns3_1_1Ptr}{Ptr<Icmpv6L4Protocol>} icmpv6 = node0->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<
      \hyperlink{classns3_1_1Icmpv6L4Protocol}{Icmpv6L4Protocol}> ();
159   icmpv6->\hyperlink{classns3_1_1ObjectBase_ac60245d3ea4123bbc9b1d391f1f6592f}{SetAttribute} (\textcolor{stringliteral}{"DAD"}, \hyperlink{classns3_1_1BooleanValue}{BooleanValue} (\textcolor{keyword}{false}));
160 
161   uint32\_t index = ipv6->\hyperlink{classns3_1_1Ipv6_a4fd7da82c16b8abf9ca15f982918e6a4}{AddInterface} (device);
162   \hyperlink{classns3_1_1Ipv6InterfaceAddress}{Ipv6InterfaceAddress} ifaceAddr1 = \hyperlink{classns3_1_1Ipv6InterfaceAddress}{Ipv6InterfaceAddress} (
      \hyperlink{classns3_1_1Ipv6Address}{Ipv6Address} (\textcolor{stringliteral}{"2000:1000:0:2000::1"}),
163                                                           \hyperlink{classns3_1_1Ipv6Prefix}{Ipv6Prefix} (64));
164   ipv6->\hyperlink{classns3_1_1Ipv6_a5cd576e83cf65445be3a0b5ffd1ddc5c}{AddAddress} (index, ifaceAddr1);
165   ipv6->\hyperlink{classns3_1_1Ipv6_ab8dfd51c931ebc11c107bff673bae827}{SetMetric} (index, 1);
166   ipv6->\hyperlink{classns3_1_1Ipv6_a8e61d85ec7fd342ed38fef2d040ed1b9}{SetUp} (index);
167 
168   \textcolor{comment}{// For Node 1}
169   node1->AddDevice (device2);
170   internet.Install (node1);
171   ipv6 = node1->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1Ipv6}{Ipv6}> ();
172   icmpv6 = node0->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1Icmpv6L4Protocol}{Icmpv6L4Protocol}> ();
173   icmpv6->\hyperlink{classns3_1_1ObjectBase_ac60245d3ea4123bbc9b1d391f1f6592f}{SetAttribute} (\textcolor{stringliteral}{"DAD"}, \hyperlink{classns3_1_1BooleanValue}{BooleanValue} (\textcolor{keyword}{false}));
174 
175   index = ipv6->\hyperlink{classns3_1_1Ipv6_a4fd7da82c16b8abf9ca15f982918e6a4}{AddInterface} (device2);
176   \hyperlink{classns3_1_1Ipv6InterfaceAddress}{Ipv6InterfaceAddress} ifaceAddr2 = \hyperlink{classns3_1_1Ipv6InterfaceAddress}{Ipv6InterfaceAddress} (
      \hyperlink{classns3_1_1Ipv6Address}{Ipv6Address} (\textcolor{stringliteral}{"2000:1000:0:2000::2"}),
177                                                           \hyperlink{classns3_1_1Ipv6Prefix}{Ipv6Prefix} (64));
178   ipv6->\hyperlink{classns3_1_1Ipv6_a5cd576e83cf65445be3a0b5ffd1ddc5c}{AddAddress} (index, ifaceAddr2);
179   ipv6->\hyperlink{classns3_1_1Ipv6_ab8dfd51c931ebc11c107bff673bae827}{SetMetric} (index, 1);
180   ipv6->\hyperlink{classns3_1_1Ipv6_a8e61d85ec7fd342ed38fef2d040ed1b9}{SetUp} (index);
181 
182   \textcolor{comment}{// ipv6 w rawsocket}
183   \hyperlink{classns3_1_1Ptr}{Ptr<SocketFactory>} factory = node0->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<
      \hyperlink{classns3_1_1SocketFactory}{SocketFactory}> (Ipv6RawSocketFactory::GetTypeId ());
184   \hyperlink{classns3_1_1Ptr}{Ptr<Socket>} socket = factory->\hyperlink{classns3_1_1SocketFactory_a97351e6e7860503a4912042530449f62}{CreateSocket} ();
185   \hyperlink{classns3_1_1Inet6SocketAddress}{Inet6SocketAddress} local =  \hyperlink{classns3_1_1Inet6SocketAddress}{Inet6SocketAddress} (Ipv6Address::GetAny (
      ), 0);
186   socket->SetAttribute (\textcolor{stringliteral}{"Protocol"}, UintegerValue (Ipv6Header::IPV6\_ICMPV6));
187   socket->Bind (local);
188   socket->SetRecvPktInfo (\textcolor{keyword}{true});
189   socket->SetRecvCallback (\hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&
      \hyperlink{classIpv6PacketInfoTagTest_a71bf0b1c87d70945d55fa28995a18db0}{Ipv6PacketInfoTagTest::RxCb}, \textcolor{keyword}{this}));
190 
191   \textcolor{comment}{// receive on loopback}
192   Simulator::ScheduleWithContext (socket->GetNode ()->GetId (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
193                                   &\hyperlink{classIpv6PacketInfoTagTest_ab880bf3bb45b329560c08666ed9aa16d}{Ipv6PacketInfoTagTest::DoSendData}, \textcolor{keyword}{this}
      , socket, \textcolor{stringliteral}{"::1"});
194   Simulator::Run ();
195 
196   \hyperlink{classns3_1_1Ptr}{Ptr<SocketFactory>} factory2 = node1->GetObject<\hyperlink{classns3_1_1SocketFactory}{SocketFactory}> (
      Ipv6RawSocketFactory::GetTypeId ());
197   \hyperlink{classns3_1_1Ptr}{Ptr<Socket>} socket2 = factory2->\hyperlink{classns3_1_1SocketFactory_a97351e6e7860503a4912042530449f62}{CreateSocket} ();
198   std::stringstream dst;
199   dst << ifaceAddr1.\hyperlink{classns3_1_1Ipv6InterfaceAddress_a80d4caacff72bddc3045a5929519e107}{GetAddress} ();
200   Simulator::ScheduleWithContext (socket2->GetNode ()->GetId (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
201                                   &\hyperlink{classIpv6PacketInfoTagTest_ab880bf3bb45b329560c08666ed9aa16d}{Ipv6PacketInfoTagTest::DoSendData}, \textcolor{keyword}{this}
      , socket,
202                                   dst.str ());
203   Simulator::Run ();
204 
205 \textcolor{preprocessor}{#ifdef UDP6\_SUPPORTED}
206   \textcolor{comment}{// IPv6 test}
207   factory = node0->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1SocketFactory}{SocketFactory}> (UdpSocketFactory::GetTypeId ());
208   socket = factory->\hyperlink{classns3_1_1SocketFactory_a97351e6e7860503a4912042530449f62}{CreateSocket} ();
209   local =  \hyperlink{classns3_1_1Inet6SocketAddress}{Inet6SocketAddress} (Ipv6Address::GetAny (), 200);
210   socket->Bind (local);
211   socket->SetRecvPktInfo (\textcolor{keyword}{true});
212   socket->SetRecvCallback (\hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&
      \hyperlink{classIpv6PacketInfoTagTest_a71bf0b1c87d70945d55fa28995a18db0}{Ipv6PacketInfoTagTest::RxCb}, \textcolor{keyword}{this}));
213 
214   \textcolor{comment}{// receive on loopback}
215   Simulator::ScheduleWithContext (socket->GetNode ()->GetId (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
216                                   &\hyperlink{classIpv6PacketInfoTagTest_ab880bf3bb45b329560c08666ed9aa16d}{Ipv6PacketInfoTagTest::DoSendData}, \textcolor{keyword}{this}
      , socket, \textcolor{stringliteral}{"::1"});
217   Simulator::Run ();
218 
219   factory2 = node1->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1SocketFactory}{SocketFactory}> (UdpSocketFactory::GetTypeId ());
220   socket2 = factory2->\hyperlink{classns3_1_1SocketFactory_a97351e6e7860503a4912042530449f62}{CreateSocket} ();
221   Simulator::ScheduleWithContext (socket2->GetNode ()->GetId (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
222                                   &\hyperlink{classIpv6PacketInfoTagTest_ab880bf3bb45b329560c08666ed9aa16d}{Ipv6PacketInfoTagTest::DoSendData}, \textcolor{keyword}{this}
      , socket, \textcolor{stringliteral}{"10.1.1.1"});
223   Simulator::Run ();
224 
225 \textcolor{preprocessor}{#endif  // UDP6\_SUPPORTED}
226 
227   Simulator::Destroy ();
228   \textcolor{comment}{// IPv6 test}
229 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2


\index{Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}!Do\+Send\+Data@{Do\+Send\+Data}}
\index{Do\+Send\+Data@{Do\+Send\+Data}!Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}}
\subsubsection[{\texorpdfstring{Do\+Send\+Data(\+Ptr$<$ Socket $>$ socket, std\+::string to)}{DoSendData(Ptr< Socket > socket, std::string to)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv6\+Packet\+Info\+Tag\+Test\+::\+Do\+Send\+Data (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Socket} $>$}]{socket, }
\item[{std\+::string}]{to}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv6PacketInfoTagTest_ab880bf3bb45b329560c08666ed9aa16d}{}\label{classIpv6PacketInfoTagTest_ab880bf3bb45b329560c08666ed9aa16d}


Send data. 


\begin{DoxyParams}{Parameters}
{\em socket} & Sending socket. \\
\hline
{\em to} & Destination address. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
126 \{
127   \hyperlink{classns3_1_1Address}{Address} realTo = \hyperlink{classns3_1_1Inet6SocketAddress}{Inet6SocketAddress} (\hyperlink{classns3_1_1Ipv6Address}{Ipv6Address} (to.c\_str ()), 200);
128   \textcolor{keywordflow}{if} (DynamicCast<UdpSocket> (socket) != 0)
129     \{
130       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (socket->\hyperlink{classns3_1_1Socket_af898fce6a58e0dbba23c1c6de1d4220e}{SendTo} (Create<Packet> (123), 0, realTo),
131                              123, \textcolor{stringliteral}{"100"});
132     \}
133   \textcolor{comment}{// Should only Ipv6RawSock}
134   \textcolor{keywordflow}{else}
135     \{
136       socket->\hyperlink{classns3_1_1Socket_af898fce6a58e0dbba23c1c6de1d4220e}{SendTo} (Create<Packet> (123), 0, realTo);
137     \}
138 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 3




Here is the caller graph for this function\+:
% FIG 4


\index{Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}!Rx\+Cb@{Rx\+Cb}}
\index{Rx\+Cb@{Rx\+Cb}!Ipv6\+Packet\+Info\+Tag\+Test@{Ipv6\+Packet\+Info\+Tag\+Test}}
\subsubsection[{\texorpdfstring{Rx\+Cb(\+Ptr$<$ Socket $>$ socket)}{RxCb(Ptr< Socket > socket)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv6\+Packet\+Info\+Tag\+Test\+::\+Rx\+Cb (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Socket} $>$}]{socket}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv6PacketInfoTagTest_a71bf0b1c87d70945d55fa28995a18db0}{}\label{classIpv6PacketInfoTagTest_a71bf0b1c87d70945d55fa28995a18db0}


Receive callback. 


\begin{DoxyParams}{Parameters}
{\em socket} & Receiving socket. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
110 \{
111   uint32\_t availableData;
112   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} m\_receivedPacket;
113 
114   availableData = socket->\hyperlink{classns3_1_1Socket_ad35d8931e53ae0754ee864acb1cecd0e}{GetRxAvailable} ();
115   m\_receivedPacket = socket->\hyperlink{classns3_1_1Socket_a8949b1f844aae563446f2f4c5be8827a}{Recv} (\hyperlink{80211b_8c_affe776513b24d84b39af8ab0930fef7f}{std::numeric\_limits<uint32\_t>::max}
       (), 0);
116   \hyperlink{group__testing_ga2a9d78cffb3db8e867c35fff0b698cf5}{NS\_TEST\_ASSERT\_MSG\_EQ} (availableData, m\_receivedPacket->
      \hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} (), \textcolor{stringliteral}{"Did not read expected data"});
117 
118   \hyperlink{classns3_1_1Ipv6PacketInfoTag}{Ipv6PacketInfoTag} tag;
119   \textcolor{keywordtype}{bool} found;
120   found = m\_receivedPacket->\hyperlink{classns3_1_1Packet_a078fe922d976a417ab25ba2f3c2fd667}{RemovePacketTag} (tag);
121   \hyperlink{group__testing_ga2a9d78cffb3db8e867c35fff0b698cf5}{NS\_TEST\_ASSERT\_MSG\_EQ} (found, \textcolor{keyword}{true}, \textcolor{stringliteral}{"Could not find tag"});
122 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 5




Here is the caller graph for this function\+:
% FIG 6




The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
internet/test/\hyperlink{ipv6-packet-info-tag-test-suite_8cc}{ipv6-\/packet-\/info-\/tag-\/test-\/suite.\+cc}\end{DoxyCompactItemize}
