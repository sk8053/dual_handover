\hypertarget{classEpcS1uDlTestCase}{}\section{Epc\+S1u\+Dl\+Test\+Case Class Reference}
\label{classEpcS1uDlTestCase}\index{Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}}


Inheritance diagram for Epc\+S1u\+Dl\+Test\+Case\+:
% FIG 0


Collaboration diagram for Epc\+S1u\+Dl\+Test\+Case\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classEpcS1uDlTestCase_a2cffa86eedffbb29c7fca838eea9c006}{Epc\+S1u\+Dl\+Test\+Case} (std\+::string \hyperlink{generate__test__data__lte__spectrum__model_8m_ab74e6bf80237ddc4109968cedc58c151}{name}, std\+::vector$<$ \hyperlink{structEnbDlTestData}{Enb\+Dl\+Test\+Data} $>$ v)
\item 
virtual \hyperlink{classEpcS1uDlTestCase_a104ff503167ca03b81e783c272fb6534}{$\sim$\+Epc\+S1u\+Dl\+Test\+Case} ()
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classEpcS1uDlTestCase_a2ac9313672e6c5e2a5a33f98a77ffec2}{Do\+Run} (void)
\begin{DoxyCompactList}\small\item\em Implementation to actually run this Test\+Case. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
std\+::vector$<$ \hyperlink{structEnbDlTestData}{Enb\+Dl\+Test\+Data} $>$ \hyperlink{classEpcS1uDlTestCase_a076410c7636f6081aeaab215a0a1bf9d}{m\+\_\+enb\+Dl\+Test\+Data}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Constructor \& Destructor Documentation}
\index{Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}!Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}}
\index{Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}!Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}}
\subsubsection[{\texorpdfstring{Epc\+S1u\+Dl\+Test\+Case(std\+::string name, std\+::vector$<$ Enb\+Dl\+Test\+Data $>$ v)}{EpcS1uDlTestCase(std::string name, std::vector< EnbDlTestData > v)}}]{\setlength{\rightskip}{0pt plus 5cm}Epc\+S1u\+Dl\+Test\+Case\+::\+Epc\+S1u\+Dl\+Test\+Case (
\begin{DoxyParamCaption}
\item[{std\+::string}]{name, }
\item[{std\+::vector$<$ {\bf Enb\+Dl\+Test\+Data} $>$}]{v}
\end{DoxyParamCaption}
)}\hypertarget{classEpcS1uDlTestCase_a2cffa86eedffbb29c7fca838eea9c006}{}\label{classEpcS1uDlTestCase_a2cffa86eedffbb29c7fca838eea9c006}

\begin{DoxyCode}
86   : \hyperlink{classns3_1_1TestCase_a3b0b91a96aac1933e8d146e019b9e207}{TestCase} (\hyperlink{generate__test__data__lte__spectrum__model_8m_ab74e6bf80237ddc4109968cedc58c151}{name}),
87     \hyperlink{classEpcS1uDlTestCase_a076410c7636f6081aeaab215a0a1bf9d}{m\_enbDlTestData} (v)
88 \{
89 \}
\end{DoxyCode}
\index{Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}!````~Epc\+S1u\+Dl\+Test\+Case@{$\sim$\+Epc\+S1u\+Dl\+Test\+Case}}
\index{````~Epc\+S1u\+Dl\+Test\+Case@{$\sim$\+Epc\+S1u\+Dl\+Test\+Case}!Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}}
\subsubsection[{\texorpdfstring{$\sim$\+Epc\+S1u\+Dl\+Test\+Case()}{~EpcS1uDlTestCase()}}]{\setlength{\rightskip}{0pt plus 5cm}Epc\+S1u\+Dl\+Test\+Case\+::$\sim$\+Epc\+S1u\+Dl\+Test\+Case (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classEpcS1uDlTestCase_a104ff503167ca03b81e783c272fb6534}{}\label{classEpcS1uDlTestCase_a104ff503167ca03b81e783c272fb6534}

\begin{DoxyCode}
92 \{
93 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}!Do\+Run@{Do\+Run}}
\index{Do\+Run@{Do\+Run}!Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}}
\subsubsection[{\texorpdfstring{Do\+Run(void)}{DoRun(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void Epc\+S1u\+Dl\+Test\+Case\+::\+Do\+Run (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [virtual]}}\hypertarget{classEpcS1uDlTestCase_a2ac9313672e6c5e2a5a33f98a77ffec2}{}\label{classEpcS1uDlTestCase_a2ac9313672e6c5e2a5a33f98a77ffec2}


Implementation to actually run this Test\+Case. 

Subclasses should override this method to conduct their tests. 

Implements \hyperlink{classns3_1_1TestCase_a8ff74680cf017ed42011e4be51917a24}{ns3\+::\+Test\+Case}.


\begin{DoxyCode}
97 \{
98   \hyperlink{classns3_1_1Ptr}{Ptr<PointToPointEpcHelper>} epcHelper = CreateObject<PointToPointEpcHelper> ();
99   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} pgw = epcHelper->\hyperlink{classns3_1_1PointToPointEpcHelper_a828ac04ae81b0e323f9ccfc08bcacf21}{GetPgwNode} ();
100 
101   \textcolor{comment}{// allow jumbo packets}
102   \hyperlink{group__config_ga2e7882df849d8ba4aaad31c934c40c06}{Config::SetDefault} (\textcolor{stringliteral}{"ns3::CsmaNetDevice::Mtu"}, UintegerValue (30000));
103   \hyperlink{group__config_ga2e7882df849d8ba4aaad31c934c40c06}{Config::SetDefault} (\textcolor{stringliteral}{"ns3::PointToPointNetDevice::Mtu"}, UintegerValue (30000));
104   epcHelper->\hyperlink{classns3_1_1ObjectBase_ac60245d3ea4123bbc9b1d391f1f6592f}{SetAttribute} (\textcolor{stringliteral}{"S1uLinkMtu"}, UintegerValue (30000));
105   
106   \textcolor{comment}{// Create a single RemoteHost}
107   \hyperlink{classns3_1_1NodeContainer}{NodeContainer} remoteHostContainer;
108   remoteHostContainer.\hyperlink{classns3_1_1NodeContainer_a787f059e2813e8b951cc6914d11dfe69}{Create} (1);
109   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} remoteHost = remoteHostContainer.\hyperlink{classns3_1_1NodeContainer_a9ed96e2ecc22e0f5a3d4842eb9bf90bf}{Get} (0);
110   \hyperlink{classns3_1_1InternetStackHelper}{InternetStackHelper} internet;
111   internet.\hyperlink{classns3_1_1InternetStackHelper_a6645b412f31283d2d9bc3d8a95cebbc0}{Install} (remoteHostContainer);
112 
113   \textcolor{comment}{// Create the internet}
114   \hyperlink{classns3_1_1PointToPointHelper}{PointToPointHelper} p2ph;
115   p2ph.\hyperlink{classns3_1_1PointToPointHelper_a4577f5ab8c387e5528af2e0fbab1152e}{SetDeviceAttribute} (\textcolor{stringliteral}{"DataRate"},  DataRateValue (
      \hyperlink{classns3_1_1DataRate}{DataRate} (\textcolor{stringliteral}{"100Gb/s"})));
116   \hyperlink{classns3_1_1NetDeviceContainer}{NetDeviceContainer} internetDevices = p2ph.\hyperlink{classns3_1_1PointToPointHelper_ab9162fea3e88722666fed1106df1f9ec}{Install} (pgw, remoteHost);  
117   \hyperlink{classns3_1_1Ipv4AddressHelper}{Ipv4AddressHelper} ipv4h;
118   ipv4h.\hyperlink{classns3_1_1Ipv4AddressHelper_acf7b16dd25bac67e00f5e25f90a9a035}{SetBase} (\textcolor{stringliteral}{"1.0.0.0"}, \textcolor{stringliteral}{"255.0.0.0"});
119   ipv4h.\hyperlink{classns3_1_1Ipv4AddressHelper_af8e7f4a1a7e74c00014a1eac445a27af}{Assign} (internetDevices);
120   
121   \textcolor{comment}{// setup default gateway for the remote hosts}
122   \hyperlink{classns3_1_1Ipv4StaticRoutingHelper}{Ipv4StaticRoutingHelper} ipv4RoutingHelper;
123   \hyperlink{classns3_1_1Ptr}{Ptr<Ipv4StaticRouting>} remoteHostStaticRouting = ipv4RoutingHelper.
      \hyperlink{classns3_1_1Ipv4StaticRoutingHelper_a731206e50d305695dac7fb2ef963a4bb}{GetStaticRouting} (remoteHost->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1Ipv4}{Ipv4}> ());
124 
125   \textcolor{comment}{// hardcoded UE addresses for now}
126   remoteHostStaticRouting->\hyperlink{classns3_1_1Ipv4StaticRouting_a8bf5eaa7ba49fe33c78c70d5560b6c39}{AddNetworkRouteTo} (\hyperlink{classns3_1_1Ipv4Address}{Ipv4Address} (\textcolor{stringliteral}{"7.0.0.0"}), 
      \hyperlink{classns3_1_1Ipv4Mask}{Ipv4Mask} (\textcolor{stringliteral}{"255.255.255.0"}), 1);
127   
128 
129 
130 
131   \hyperlink{classns3_1_1NodeContainer}{NodeContainer} enbs;
132   uint16\_t cellIdCounter = 0;
133 
134   \textcolor{keywordflow}{for} (std::vector<EnbDlTestData>::iterator enbit = \hyperlink{classEpcS1uDlTestCase_a076410c7636f6081aeaab215a0a1bf9d}{m\_enbDlTestData}.begin ();
135        enbit < \hyperlink{classEpcS1uDlTestCase_a076410c7636f6081aeaab215a0a1bf9d}{m\_enbDlTestData}.end ();
136        ++enbit)
137     \{
138       \hyperlink{classns3_1_1Ptr}{Ptr<Node>} enb = CreateObject<Node> ();
139       enbs.\hyperlink{classns3_1_1NodeContainer_aa60b3a0e70f2fb324e16ffcf8bf31fcb}{Add} (enb);
140 
141       \textcolor{comment}{// we test EPC without LTE, hence we use:}
142       \textcolor{comment}{// 1) a CSMA network to simulate the cell}
143       \textcolor{comment}{// 2) a raw socket opened on the CSMA device to simulate the LTE socket}
144 
145       uint16\_t cellId = ++cellIdCounter;
146 
147       \hyperlink{classns3_1_1NodeContainer}{NodeContainer} ues;
148       ues.\hyperlink{classns3_1_1NodeContainer_a787f059e2813e8b951cc6914d11dfe69}{Create} (enbit->ues.size ());
149 
150       \hyperlink{classns3_1_1NodeContainer}{NodeContainer} cell;
151       cell.\hyperlink{classns3_1_1NodeContainer_aa60b3a0e70f2fb324e16ffcf8bf31fcb}{Add} (ues);
152       cell.\hyperlink{classns3_1_1NodeContainer_aa60b3a0e70f2fb324e16ffcf8bf31fcb}{Add} (enb);
153 
154       \hyperlink{classns3_1_1CsmaHelper}{CsmaHelper} csmaCell;      
155       \hyperlink{classns3_1_1NetDeviceContainer}{NetDeviceContainer} cellDevices = csmaCell.\hyperlink{classns3_1_1CsmaHelper_af79a91372595230b0817200270ab84e7}{Install} (cell);
156 
157       \textcolor{comment}{// the eNB's CSMA NetDevice acting as an LTE NetDevice. }
158       \hyperlink{classns3_1_1Ptr}{Ptr<NetDevice>} enbDevice = cellDevices.\hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (cellDevices.
      \hyperlink{classns3_1_1NetDeviceContainer_a74cafc212479bc38976bebd118e856b9}{GetN} () - 1);
159 
160       \textcolor{comment}{// Note that the EpcEnbApplication won't care of the actual NetDevice type}
161       epcHelper->\hyperlink{classns3_1_1PointToPointEpcHelper_a6636cc9c0501b719bd81ed13efd3c589}{AddEnb} (enb, enbDevice, cellId);      
162 
163       \textcolor{comment}{// Plug test RRC entity}
164       \hyperlink{classns3_1_1Ptr}{Ptr<EpcEnbApplication>} enbApp = enb->\hyperlink{classns3_1_1Node_ad0ab54d76712398c0a8e25d9ac59ea41}{GetApplication} (0)->
      \hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1EpcEnbApplication}{EpcEnbApplication}> ();
165       \hyperlink{assert_8h_aff5ece9066c74e681e74999856f08539}{NS\_ASSERT\_MSG} (enbApp != 0, \textcolor{stringliteral}{"cannot retrieve EpcEnbApplication"});
166       \hyperlink{classns3_1_1Ptr}{Ptr<EpcTestRrc>} rrc = CreateObject<EpcTestRrc> ();
167       rrc->\hyperlink{classns3_1_1EpcTestRrc_a4dc91a1208c2f22d76991df2f2bd15dc}{SetS1SapProvider} (enbApp->\hyperlink{classns3_1_1EpcEnbApplication_a706b531d6ec3ab6eb37567232f5c6cd4}{GetS1SapProvider} ());
168       enbApp->\hyperlink{classns3_1_1EpcEnbApplication_aec298b6adc29bad4c52828ddf1a260d6}{SetS1SapUser} (rrc->\hyperlink{classns3_1_1EpcTestRrc_ac145e0e646ca9d170ed04d6b3b3b93c4}{GetS1SapUser} ());
169       
170       \textcolor{comment}{// we install the IP stack on UEs only}
171       \hyperlink{classns3_1_1InternetStackHelper}{InternetStackHelper} internet;
172       internet.\hyperlink{classns3_1_1InternetStackHelper_a6645b412f31283d2d9bc3d8a95cebbc0}{Install} (ues);
173 
174       \textcolor{comment}{// assign IP address to UEs, and install applications}
175       \textcolor{keywordflow}{for} (uint32\_t u = 0; u < ues.\hyperlink{classns3_1_1NodeContainer_aed647ac56d0407a7706aba02eb44b951}{GetN} (); ++u)
176         \{
177           \hyperlink{classns3_1_1Ptr}{Ptr<NetDevice>} ueLteDevice = cellDevices.\hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (u);
178           \hyperlink{classns3_1_1Ipv4InterfaceContainer}{Ipv4InterfaceContainer} ueIpIface = epcHelper->
      \hyperlink{classns3_1_1PointToPointEpcHelper_a11102d32127163fdcc47c44623d4f0cc}{AssignUeIpv4Address} (\hyperlink{classns3_1_1NetDeviceContainer}{NetDeviceContainer} (ueLteDevice));
179 
180           \hyperlink{classns3_1_1Ptr}{Ptr<Node>} ue = ues.\hyperlink{classns3_1_1NodeContainer_a9ed96e2ecc22e0f5a3d4842eb9bf90bf}{Get} (u);
181 
182           \textcolor{comment}{// disable IP Forwarding on the UE. This is because we use}
183           \textcolor{comment}{// CSMA broadcast MAC addresses for this test. The problem}
184           \textcolor{comment}{// won't happen with a LteUeNetDevice. }
185           ue->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1Ipv4}{Ipv4}> ()->SetAttribute (\textcolor{stringliteral}{"IpForward"}, 
      \hyperlink{classns3_1_1BooleanValue}{BooleanValue} (\textcolor{keyword}{false}));
186           
187           uint16\_t \hyperlink{dsdv-manet_8cc_a8e0798404bf2cf5dabb84c5ba9a4f236}{port} = 1234;
188           \hyperlink{classns3_1_1PacketSinkHelper}{PacketSinkHelper} packetSinkHelper (\textcolor{stringliteral}{"ns3::UdpSocketFactory"}, 
      \hyperlink{classns3_1_1InetSocketAddress}{InetSocketAddress} (Ipv4Address::GetAny (), port));
189           \hyperlink{classns3_1_1ApplicationContainer}{ApplicationContainer} apps = packetSinkHelper.Install (ue);
190           apps.\hyperlink{classns3_1_1ApplicationContainer_a8eff87926507020bbe3e1390358a54a7}{Start} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (1.0));
191           apps.\hyperlink{classns3_1_1ApplicationContainer_adfc52f9aa4020c8714679b00bbb9ddb3}{Stop} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (10.0));
192           enbit->ues[u].serverApp = apps.\hyperlink{classns3_1_1ApplicationContainer_a9e565807abd4213a56566a7ccd8d7509}{Get} (0)->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<
      \hyperlink{classns3_1_1PacketSink}{PacketSink}> ();
193           
194           \hyperlink{classns3_1_1Time}{Time} interPacketInterval = \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.01);
195           \hyperlink{classns3_1_1UdpEchoClientHelper}{UdpEchoClientHelper} client (ueIpIface.\hyperlink{classns3_1_1Ipv4InterfaceContainer_ae63208dcd222be986822937ee4aa828c}{GetAddress} (0), 
      \hyperlink{dsdv-manet_8cc_a8e0798404bf2cf5dabb84c5ba9a4f236}{port});
196           client.\hyperlink{classns3_1_1UdpEchoClientHelper_a11228c069ad896f8ed13f4d37c13f51d}{SetAttribute} (\textcolor{stringliteral}{"MaxPackets"}, UintegerValue (enbit->ues[u].numPkts));
197           client.SetAttribute (\textcolor{stringliteral}{"Interval"}, TimeValue (interPacketInterval));
198           client.SetAttribute (\textcolor{stringliteral}{"PacketSize"}, UintegerValue (enbit->ues[u].pktSize));
199           apps = client.Install (remoteHost);
200           apps.\hyperlink{classns3_1_1ApplicationContainer_a8eff87926507020bbe3e1390358a54a7}{Start} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (2.0));
201           apps.\hyperlink{classns3_1_1ApplicationContainer_adfc52f9aa4020c8714679b00bbb9ddb3}{Stop} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (10.0));   
202           enbit->ues[u].clientApp = apps.\hyperlink{classns3_1_1ApplicationContainer_a9e565807abd4213a56566a7ccd8d7509}{Get} (0);
203 
204           uint64\_t imsi = u+1;
205           epcHelper->\hyperlink{classns3_1_1PointToPointEpcHelper_a6ed801de21387477fabd23eeafff7e73}{AddUe} (ueLteDevice, imsi);
206           epcHelper->\hyperlink{classns3_1_1PointToPointEpcHelper_a97023077eae8644e8f1b269a357c8f93}{ActivateEpsBearer} (ueLteDevice, imsi, EpcTft::Default (), 
      \hyperlink{structns3_1_1EpsBearer}{EpsBearer} (EpsBearer::NGBR\_VIDEO\_TCP\_DEFAULT));
207           enbApp->\hyperlink{classns3_1_1EpcEnbApplication_a706b531d6ec3ab6eb37567232f5c6cd4}{GetS1SapProvider} ()->\hyperlink{classns3_1_1EpcEnbS1SapProvider_af5e1397f498eb5b2b2e84d8a41106cac}{InitialUeMessage} (imsi, (uint16\_t) 
      imsi);
208         \} 
209             
210     \} 
211   
212   Simulator::Run ();
213 
214   \textcolor{keywordflow}{for} (std::vector<EnbDlTestData>::iterator enbit = \hyperlink{classEpcS1uDlTestCase_a076410c7636f6081aeaab215a0a1bf9d}{m\_enbDlTestData}.begin ();
215        enbit < \hyperlink{classEpcS1uDlTestCase_a076410c7636f6081aeaab215a0a1bf9d}{m\_enbDlTestData}.end ();
216        ++enbit)
217     \{
218       \textcolor{keywordflow}{for} (std::vector<UeDlTestData>::iterator ueit = enbit->ues.begin ();
219            ueit < enbit->ues.end ();
220            ++ueit)
221         \{
222           \hyperlink{group__testing_ga2a9d78cffb3db8e867c35fff0b698cf5}{NS\_TEST\_ASSERT\_MSG\_EQ} (ueit->serverApp->GetTotalRx (), (ueit->numPkts) * (
      ueit->pktSize), \textcolor{stringliteral}{"wrong total received bytes"});
223         \}      
224     \}
225   
226   Simulator::Destroy ();
227 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2




\subsection{Member Data Documentation}
\index{Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}!m\+\_\+enb\+Dl\+Test\+Data@{m\+\_\+enb\+Dl\+Test\+Data}}
\index{m\+\_\+enb\+Dl\+Test\+Data@{m\+\_\+enb\+Dl\+Test\+Data}!Epc\+S1u\+Dl\+Test\+Case@{Epc\+S1u\+Dl\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+enb\+Dl\+Test\+Data}{m_enbDlTestData}}]{\setlength{\rightskip}{0pt plus 5cm}std\+::vector$<${\bf Enb\+Dl\+Test\+Data}$>$ Epc\+S1u\+Dl\+Test\+Case\+::m\+\_\+enb\+Dl\+Test\+Data\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classEpcS1uDlTestCase_a076410c7636f6081aeaab215a0a1bf9d}{}\label{classEpcS1uDlTestCase_a076410c7636f6081aeaab215a0a1bf9d}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
lte/test/\hyperlink{epc-test-s1u-downlink_8cc}{epc-\/test-\/s1u-\/downlink.\+cc}\end{DoxyCompactItemize}
