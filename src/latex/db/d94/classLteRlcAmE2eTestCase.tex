\hypertarget{classLteRlcAmE2eTestCase}{}\section{Lte\+Rlc\+Am\+E2e\+Test\+Case Class Reference}
\label{classLteRlcAmE2eTestCase}\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}


{\ttfamily \#include $<$lte-\/test-\/rlc-\/am-\/e2e.\+h$>$}



Inheritance diagram for Lte\+Rlc\+Am\+E2e\+Test\+Case\+:
% FIG 0


Collaboration diagram for Lte\+Rlc\+Am\+E2e\+Test\+Case\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classLteRlcAmE2eTestCase_abde759871dbab8d926f3a835257e017d}{Lte\+Rlc\+Am\+E2e\+Test\+Case} (std\+::string \hyperlink{generate__test__data__lte__spectrum__model_8m_ab74e6bf80237ddc4109968cedc58c151}{name}, uint32\+\_\+t seed, double losses, bool bulk\+Sdu\+Arrival)
\item 
\hyperlink{classLteRlcAmE2eTestCase_af36c9b812693ba0c025d0a3a9fcc11a9}{Lte\+Rlc\+Am\+E2e\+Test\+Case} ()
\item 
virtual \hyperlink{classLteRlcAmE2eTestCase_afde30957bbe36d0de1167218c533f9ae}{$\sim$\+Lte\+Rlc\+Am\+E2e\+Test\+Case} ()
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classLteRlcAmE2eTestCase_a96cf405c2fe8e9a1c878c615b185d419}{Do\+Run} (void)
\begin{DoxyCompactList}\small\item\em Implementation to actually run this Test\+Case. \end{DoxyCompactList}\item 
void \hyperlink{classLteRlcAmE2eTestCase_a29f5f21aa4f70fe42aaa5315c2f6a444}{Dl\+Drop\+Event} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ const \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{lte__link__budget__x2__handover__measures_8m_ac9de518908a968428863f829398a4e62}{p})
\item 
void \hyperlink{classLteRlcAmE2eTestCase_ab3e6d1006e655b2743f08a46ca8a414c}{Ul\+Drop\+Event} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ const \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{lte__link__budget__x2__handover__measures_8m_ac9de518908a968428863f829398a4e62}{p})
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
uint32\+\_\+t \hyperlink{classLteRlcAmE2eTestCase_af47c853d67661e384fbed678b588a6e5}{m\+\_\+run}
\item 
double \hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\+\_\+losses}
\item 
bool \hyperlink{classLteRlcAmE2eTestCase_a401b57783a0a1908adcf7a087757fb83}{m\+\_\+bulk\+Sdu\+Arrival}
\item 
uint32\+\_\+t \hyperlink{classLteRlcAmE2eTestCase_ab618569119894079072ea0e4867dcaeb}{m\+\_\+dl\+Drops}
\item 
uint32\+\_\+t \hyperlink{classLteRlcAmE2eTestCase_a341e4ba269f052efbd439ebacf09e6f0}{m\+\_\+ul\+Drops}
\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
Test cases used for the test suite lte-\/rlc-\/am-\/e2e. See the testing section of the L\+TE module documentation for details. 

\subsection{Constructor \& Destructor Documentation}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{Lte\+Rlc\+Am\+E2e\+Test\+Case(std\+::string name, uint32\+\_\+t seed, double losses, bool bulk\+Sdu\+Arrival)}{LteRlcAmE2eTestCase(std::string name, uint32_t seed, double losses, bool bulkSduArrival)}}]{\setlength{\rightskip}{0pt plus 5cm}Lte\+Rlc\+Am\+E2e\+Test\+Case\+::\+Lte\+Rlc\+Am\+E2e\+Test\+Case (
\begin{DoxyParamCaption}
\item[{std\+::string}]{name, }
\item[{uint32\+\_\+t}]{seed, }
\item[{double}]{losses, }
\item[{bool}]{bulk\+Sdu\+Arrival}
\end{DoxyParamCaption}
)}\hypertarget{classLteRlcAmE2eTestCase_abde759871dbab8d926f3a835257e017d}{}\label{classLteRlcAmE2eTestCase_abde759871dbab8d926f3a835257e017d}

\begin{DoxyCode}
102    : \hyperlink{classns3_1_1TestCase_a3b0b91a96aac1933e8d146e019b9e207}{TestCase} (\hyperlink{generate__test__data__lte__spectrum__model_8m_ab74e6bf80237ddc4109968cedc58c151}{name}),
103      \hyperlink{classLteRlcAmE2eTestCase_af47c853d67661e384fbed678b588a6e5}{m\_run} (\hyperlink{generate__test__data__lte__spectrum__value__txpsd_8m_a093eaf8ac95b223aafb28e4668160d1f}{run}),
104      \hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\_losses} (losses),
105      \hyperlink{classLteRlcAmE2eTestCase_a401b57783a0a1908adcf7a087757fb83}{m\_bulkSduArrival} (bulkSduArrival),
106      \hyperlink{classLteRlcAmE2eTestCase_ab618569119894079072ea0e4867dcaeb}{m\_dlDrops} (0),
107      \hyperlink{classLteRlcAmE2eTestCase_a341e4ba269f052efbd439ebacf09e6f0}{m\_ulDrops} (0)
108 \{
109   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"Creating LteRlcAmTestingTestCase: "} + \hyperlink{generate__test__data__lte__spectrum__model_8m_ab74e6bf80237ddc4109968cedc58c151}{name});
110 \}
\end{DoxyCode}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{Lte\+Rlc\+Am\+E2e\+Test\+Case()}{LteRlcAmE2eTestCase()}}]{\setlength{\rightskip}{0pt plus 5cm}Lte\+Rlc\+Am\+E2e\+Test\+Case\+::\+Lte\+Rlc\+Am\+E2e\+Test\+Case (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classLteRlcAmE2eTestCase_af36c9b812693ba0c025d0a3a9fcc11a9}{}\label{classLteRlcAmE2eTestCase_af36c9b812693ba0c025d0a3a9fcc11a9}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!````~Lte\+Rlc\+Am\+E2e\+Test\+Case@{$\sim$\+Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\index{````~Lte\+Rlc\+Am\+E2e\+Test\+Case@{$\sim$\+Lte\+Rlc\+Am\+E2e\+Test\+Case}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{$\sim$\+Lte\+Rlc\+Am\+E2e\+Test\+Case()}{~LteRlcAmE2eTestCase()}}]{\setlength{\rightskip}{0pt plus 5cm}Lte\+Rlc\+Am\+E2e\+Test\+Case\+::$\sim$\+Lte\+Rlc\+Am\+E2e\+Test\+Case (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classLteRlcAmE2eTestCase_afde30957bbe36d0de1167218c533f9ae}{}\label{classLteRlcAmE2eTestCase_afde30957bbe36d0de1167218c533f9ae}

\begin{DoxyCode}
113 \{
114 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!Dl\+Drop\+Event@{Dl\+Drop\+Event}}
\index{Dl\+Drop\+Event@{Dl\+Drop\+Event}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{Dl\+Drop\+Event(\+Ptr$<$ const Packet $>$ p)}{DlDropEvent(Ptr< const Packet > p)}}]{\setlength{\rightskip}{0pt plus 5cm}void Lte\+Rlc\+Am\+E2e\+Test\+Case\+::\+Dl\+Drop\+Event (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ const {\bf Packet} $>$}]{p}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classLteRlcAmE2eTestCase_a29f5f21aa4f70fe42aaa5315c2f6a444}{}\label{classLteRlcAmE2eTestCase_a29f5f21aa4f70fe42aaa5315c2f6a444}

\begin{DoxyCode}
119 \{
120   \textcolor{comment}{// NS\_LOG\_FUNCTION (this);}
121   \hyperlink{classLteRlcAmE2eTestCase_ab618569119894079072ea0e4867dcaeb}{m\_dlDrops}++;
122 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 2


\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!Do\+Run@{Do\+Run}}
\index{Do\+Run@{Do\+Run}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{Do\+Run(void)}{DoRun(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void Lte\+Rlc\+Am\+E2e\+Test\+Case\+::\+Do\+Run (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [virtual]}}\hypertarget{classLteRlcAmE2eTestCase_a96cf405c2fe8e9a1c878c615b185d419}{}\label{classLteRlcAmE2eTestCase_a96cf405c2fe8e9a1c878c615b185d419}


Implementation to actually run this Test\+Case. 

Subclasses should override this method to conduct their tests. 

Implements \hyperlink{classns3_1_1TestCase_a8ff74680cf017ed42011e4be51917a24}{ns3\+::\+Test\+Case}.


\begin{DoxyCode}
133 \{
134   uint16\_t numberOfNodes = 1;
135 
136   \textcolor{comment}{// LogLevel level = (LogLevel) (LOG\_LEVEL\_ALL | LOG\_PREFIX\_TIME | LOG\_PREFIX\_NODE | LOG\_PREFIX\_FUNC);}
137   \textcolor{comment}{// LogComponentEnable ("LteRlcAmE2eTest", level);}
138   \textcolor{comment}{// LogComponentEnable ("ErrorModel", level);}
139   \textcolor{comment}{// LogComponentEnable ("LteSimpleHelper", level);}
140   \textcolor{comment}{// LogComponentEnable ("LteSimpleNetDevice", level);}
141   \textcolor{comment}{// LogComponentEnable ("SimpleNetDevice", level);}
142   \textcolor{comment}{// LogComponentEnable ("SimpleChannel", level);}
143   \textcolor{comment}{// LogComponentEnable ("LteTestEntities", level);}
144   \textcolor{comment}{// LogComponentEnable ("LtePdcp", level);}
145   \textcolor{comment}{// LogComponentEnable ("LteRlc", level);}
146   \textcolor{comment}{// LogComponentEnable ("LteRlcUm", level);}
147   \textcolor{comment}{// LogComponentEnable ("LteRlcAm", level);}
148 
149   \hyperlink{group__config_ga0e12663a7bd119b65d0a219a578f2a3c}{Config::SetGlobal} (\textcolor{stringliteral}{"RngRun"}, IntegerValue (\hyperlink{classLteRlcAmE2eTestCase_af47c853d67661e384fbed678b588a6e5}{m\_run}));
150   \hyperlink{group__config_ga2e7882df849d8ba4aaad31c934c40c06}{Config::SetDefault} (\textcolor{stringliteral}{"ns3::LteRlcAm::PollRetransmitTimer"}, TimeValue (
      \hyperlink{group__timecivil_gaf26127cf4571146b83a92ee18679c7a9}{MilliSeconds} (20)));
151   \hyperlink{group__config_ga2e7882df849d8ba4aaad31c934c40c06}{Config::SetDefault} (\textcolor{stringliteral}{"ns3::LteRlcAm::ReorderingTimer"}, TimeValue (
      \hyperlink{group__timecivil_gaf26127cf4571146b83a92ee18679c7a9}{MilliSeconds} (10)));
152   \hyperlink{group__config_ga2e7882df849d8ba4aaad31c934c40c06}{Config::SetDefault} (\textcolor{stringliteral}{"ns3::LteRlcAm::StatusProhibitTimer"}, TimeValue (
      \hyperlink{group__timecivil_gaf26127cf4571146b83a92ee18679c7a9}{MilliSeconds} (40)));
153 
154   \hyperlink{classns3_1_1Ptr}{Ptr<LteSimpleHelper>} lteSimpleHelper = CreateObject<LteSimpleHelper> ();
155   \textcolor{comment}{// lteSimpleHelper->EnableLogComponents ();}
156   \textcolor{comment}{// lteSimpleHelper->EnableTraces ();}
157 
158   lteSimpleHelper->\hyperlink{classns3_1_1ObjectBase_ac60245d3ea4123bbc9b1d391f1f6592f}{SetAttribute} (\textcolor{stringliteral}{"RlcEntity"}, StringValue (\textcolor{stringliteral}{"RlcAm"}));
159 
160   \textcolor{comment}{// eNB and UE nodes}
161   \hyperlink{classns3_1_1NodeContainer}{NodeContainer} ueNodes;
162   \hyperlink{classns3_1_1NodeContainer}{NodeContainer} enbNodes;
163   enbNodes.\hyperlink{classns3_1_1NodeContainer_a787f059e2813e8b951cc6914d11dfe69}{Create} (numberOfNodes);
164   ueNodes.\hyperlink{classns3_1_1NodeContainer_a787f059e2813e8b951cc6914d11dfe69}{Create} (numberOfNodes);
165 
166   \textcolor{comment}{// Install LTE Devices to the nodes}
167   \hyperlink{classns3_1_1NetDeviceContainer}{NetDeviceContainer} enbLteDevs = lteSimpleHelper->
      \hyperlink{classns3_1_1LteSimpleHelper_a406e71dd8dcda8fa2f9a9fc31ff6494a}{InstallEnbDevice} (enbNodes);
168   \hyperlink{classns3_1_1NetDeviceContainer}{NetDeviceContainer} ueLteDevs = lteSimpleHelper->
      \hyperlink{classns3_1_1LteSimpleHelper_aa575a9480b50754a2a01e038ca5c5f27}{InstallUeDevice} (ueNodes);
169 
170   \textcolor{comment}{// Note: Just one eNB and UE is supported. Everything is done in InstallEnbDevice and InstallUeDevice}
171 
172   \textcolor{comment}{// Attach one UE per eNodeB}
173   \textcolor{comment}{// for (uint16\_t i = 0; i < numberOfNodes; i++)}
174   \textcolor{comment}{//   \{}
175   \textcolor{comment}{//     lteSimpleHelper->Attach (ueLteDevs.Get(i), enbLteDevs.Get(i));}
176   \textcolor{comment}{//   \}}
177 
178   \textcolor{comment}{//   lteSimpleHelper->ActivateEpsBearer (ueLteDevs, EpsBearer (EpsBearer::NGBR\_VIDEO\_TCP\_DEFAULT),
       EpcTft::Default ());}
179 
180 
181   \textcolor{comment}{// Error models: downlink and uplink}
182   \hyperlink{classns3_1_1Ptr}{Ptr<RateErrorModel>} dlEm = CreateObject<RateErrorModel> ();
183   \textcolor{comment}{// fix the stream so that subsequent test cases get a number from the same stream}
184   \textcolor{comment}{// if RngRun is different, the number shall then be different}
185   dlEm->\hyperlink{classns3_1_1RateErrorModel_a759d58c787549d27e35729a4a850648a}{AssignStreams} (3);
186   dlEm->\hyperlink{classns3_1_1ObjectBase_ac60245d3ea4123bbc9b1d391f1f6592f}{SetAttribute} (\textcolor{stringliteral}{"ErrorRate"}, DoubleValue (\hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\_losses}));
187   dlEm->\hyperlink{classns3_1_1ObjectBase_ac60245d3ea4123bbc9b1d391f1f6592f}{SetAttribute} (\textcolor{stringliteral}{"ErrorUnit"}, StringValue (\textcolor{stringliteral}{"ERROR\_UNIT\_PACKET"}));
188 
189 \textcolor{comment}{//   Ptr<RateErrorModel> ueEm = CreateObjectWithAttributes<RateErrorModel> ("RanVar", StringValue
       ("ns3::UniformRandomVariable[Min=0.0|Max=1.0]"));}
190 \textcolor{comment}{//   ueEm->SetAttribute ("ErrorRate", DoubleValue (m\_losses));}
191 \textcolor{comment}{//   ueEm->SetAttribute ("ErrorUnit", StringValue ("ERROR\_UNIT\_PACKET"));}
192 
193   \textcolor{comment}{// The below hooks will cause drops and receptions to be counted}
194   ueLteDevs.\hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (0)->SetAttribute (\textcolor{stringliteral}{"ReceiveErrorModel"}, \hyperlink{classns3_1_1PointerValue}{PointerValue} (dlEm));
195   ueLteDevs.\hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (0)->TraceConnectWithoutContext (\textcolor{stringliteral}{"PhyRxDrop"}, \hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback} (&
      \hyperlink{classLteRlcAmE2eTestCase_a29f5f21aa4f70fe42aaa5315c2f6a444}{LteRlcAmE2eTestCase::DlDropEvent}, \textcolor{keyword}{this}));
196 \textcolor{comment}{//   enbLteDevs.Get (0)->SetAttribute ("ReceiveErrorModel", PointerValue (enbEm));}
197 \textcolor{comment}{//   enbLteDevs.Get (0)->TraceConnectWithoutContext ("PhyRxDrop", MakeCallback
       (&LteRlcAmE2eTestCase::EnbDropEvent, this));}
198 
199 
200 
201   uint32\_t sduSizeBytes = 100;
202   uint32\_t numSdu = 1000;
203   \textcolor{keywordtype}{double} sduStartTimeSeconds = 0.100;
204   \textcolor{keywordtype}{double} sduStopTimeSeconds;
205   \textcolor{keywordtype}{double} sduArrivalTimeSeconds;
206   uint32\_t dlTxOppSizeBytes = 150;
207   \textcolor{keywordtype}{double} dlTxOpprTimeSeconds = 0.003;
208   uint32\_t ulTxOppSizeBytes = 140;
209   \textcolor{keywordtype}{double} ulTxOpprTimeSeconds = 0.003;
210 
211   \textcolor{keywordflow}{if} (\hyperlink{classLteRlcAmE2eTestCase_a401b57783a0a1908adcf7a087757fb83}{m\_bulkSduArrival})
212     \{
213       sduStopTimeSeconds = sduStartTimeSeconds + 0.010;
214     \}
215   \textcolor{keywordflow}{else}
216     \{
217       sduStopTimeSeconds = sduStartTimeSeconds + 10;
218     \}
219   sduArrivalTimeSeconds = (sduStopTimeSeconds - sduStartTimeSeconds) / numSdu;
220   
221   
222 
223   \textcolor{comment}{// Sending packets from RRC layer}
224   lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a89ce7ea3468b4cbea029490a6451052e}{m\_enbRrc}->SetArrivalTime (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (sduArrivalTimeSeconds));
225   lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a89ce7ea3468b4cbea029490a6451052e}{m\_enbRrc}->SetPduSize (sduSizeBytes);
226 
227   \textcolor{comment}{// MAC sends transmission opportunities (TxOpp)}
228   lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a953ff7bc15f6b310a13d35581c2fecef}{m\_enbMac}->\hyperlink{classns3_1_1LteTestMac_a650a080a34f7f31d97ec3a6daea651bb}{SetTxOppSize} (dlTxOppSizeBytes);
229   lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a953ff7bc15f6b310a13d35581c2fecef}{m\_enbMac}->\hyperlink{classns3_1_1LteTestMac_aeaa7f68b716b8ee044bd7af49f4ca141}{SetTxOppTime} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (dlTxOpprTimeSeconds));
230   lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a953ff7bc15f6b310a13d35581c2fecef}{m\_enbMac}->\hyperlink{classns3_1_1LteTestMac_af48f53304281f34d121eec2fecb85f6d}{SetTxOpportunityMode} (LteTestMac::AUTOMATIC\_MODE);
231 
232   \textcolor{comment}{// MAC sends transmission opportunities (TxOpp)}
233   lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a963987a7323f3f7b1cefbc0e0bc367bc}{m\_ueMac}->\hyperlink{classns3_1_1LteTestMac_a650a080a34f7f31d97ec3a6daea651bb}{SetTxOppSize} (ulTxOppSizeBytes);
234   lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a963987a7323f3f7b1cefbc0e0bc367bc}{m\_ueMac}->\hyperlink{classns3_1_1LteTestMac_aeaa7f68b716b8ee044bd7af49f4ca141}{SetTxOppTime} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (ulTxOpprTimeSeconds));
235   lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a963987a7323f3f7b1cefbc0e0bc367bc}{m\_ueMac}->\hyperlink{classns3_1_1LteTestMac_af48f53304281f34d121eec2fecb85f6d}{SetTxOpportunityMode} (LteTestMac::AUTOMATIC\_MODE);
236 
237   \textcolor{comment}{// Start/Stop pseudo-application at RRC layer}
238   Simulator::Schedule (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (sduStartTimeSeconds), &LteTestRrc::Start, lteSimpleHelper->
      \hyperlink{classns3_1_1LteSimpleHelper_a89ce7ea3468b4cbea029490a6451052e}{m\_enbRrc});
239   Simulator::Schedule (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (sduStopTimeSeconds), &LteTestRrc::Stop, lteSimpleHelper->
      \hyperlink{classns3_1_1LteSimpleHelper_a89ce7ea3468b4cbea029490a6451052e}{m\_enbRrc});
240 
241   
242   \textcolor{keywordtype}{double} maxDlThroughput = (dlTxOppSizeBytes/(dlTxOppSizeBytes+4.0))*(dlTxOppSizeBytes/dlTxOpprTimeSeconds)
       * (1.0-\hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\_losses});
243   \textcolor{keyword}{const} \textcolor{keywordtype}{double} statusProhibitSeconds = 0.020;
244   \textcolor{keywordtype}{double} pollFrequency = (1.0/dlTxOpprTimeSeconds)*(1-\hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\_losses});
245   \textcolor{keywordtype}{double} statusFrequency = \hyperlink{80211b_8c_ac6afabdc09a49a433ee19d8a9486056d}{std::min} (pollFrequency, 1.0/statusProhibitSeconds);
246   \textcolor{keyword}{const} uint32\_t numNackSnPerStatusPdu = (ulTxOppSizeBytes*8 - 14)/10;
247   \textcolor{keywordtype}{double} maxRetxThroughput = ((double)numNackSnPerStatusPdu*(\textcolor{keywordtype}{double})dlTxOppSizeBytes)*statusFrequency;
248   \textcolor{keywordtype}{double} throughput = \hyperlink{80211b_8c_ac6afabdc09a49a433ee19d8a9486056d}{std::min} (maxDlThroughput, maxRetxThroughput);
249   \textcolor{keywordtype}{double} totBytes = ((sduSizeBytes) * (sduStopTimeSeconds - sduStartTimeSeconds) / sduArrivalTimeSeconds);
250 
251 
252   \textcolor{comment}{// note: the throughput estimation is valid only for the full buffer}
253   \textcolor{comment}{// case. However, the test sends a finite number of SDUs. Hence, the}
254   \textcolor{comment}{// estimated throughput will only be effective at the beginning of}
255   \textcolor{comment}{// the test. Towards the end of the test, two issues are present:}
256   \textcolor{comment}{//   1) no new data is transmitted, hence less feedback is sent,}
257   \textcolor{comment}{//      hence the transmission rate for the last PDUs to be}
258   \textcolor{comment}{//      retransmitted is much lower. This effect can be best noteed}
259   \textcolor{comment}{//      at very high loss rates, and can be adjusted by timers and}
260   \textcolor{comment}{//      params.}
261   \textcolor{comment}{//   2) throuhgput is not meaningful, you need to evaluate the time}
262   \textcolor{comment}{//      it takes for all PDUs to be (re)transmitted successfully,}
263   \textcolor{comment}{//      i.e., how long it takes for the TX and reTX queues to deplete.}
264 
265   \textcolor{comment}{// Estimating correctly this effect would require a complex stateful}
266   \textcolor{comment}{// model (e.g., a Markov chain model) so to avoid the hassle we just}
267   \textcolor{comment}{// use a margin here which we empirically determine as something we}
268   \textcolor{comment}{// think reasonable based on the PDU loss rate}
269   \hyperlink{classns3_1_1Time}{Time} margin;
270   \textcolor{keywordflow}{if} (\hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\_losses} < 0.07)
271     \{
272       margin = \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.500);
273     \}
274   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\_losses} < 0.20)
275     \{
276       margin = \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (1);
277     \}
278   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\_losses} < 0.50)
279     \{
280       margin = \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (2);
281     \}
282   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\_losses} < 0.70)
283     \{
284       margin = \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (10);
285     \}
286   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\_losses} < 0.91)
287     \{
288       margin = \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (20);
289     \}
290   \textcolor{keywordflow}{else} \textcolor{comment}{// 0.95}
291     \{
292       margin = \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (30);
293     \}
294   \hyperlink{classns3_1_1Time}{Time} stopTime = \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (\hyperlink{80211b_8c_affe776513b24d84b39af8ab0930fef7f}{std::max} (sduStartTimeSeconds + totBytes/throughput, 
      sduStopTimeSeconds)) + margin;
295   
296   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"statusFrequency="} << statusFrequency << \textcolor{stringliteral}{", maxDlThroughput="} << maxDlThroughput 
      << \textcolor{stringliteral}{", maxRetxThroughput="} << maxRetxThroughput << \textcolor{stringliteral}{", totBytes="} << totBytes << \textcolor{stringliteral}{", stopTime="} << stopTime.
      \hyperlink{classns3_1_1Time_a8f20d5c3b0902d7b4320982f340b57c8}{GetSeconds} () << \textcolor{stringliteral}{"s"});
297   
298   Simulator::Stop (stopTime);
299   Simulator::Run ();
300 
301   uint32\_t txEnbRrcPdus = lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a89ce7ea3468b4cbea029490a6451052e}{m\_enbRrc}->GetTxPdus ();
302   uint32\_t rxUeRrcPdus = lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a21a115de62aaa22c3278c1154057b5f2}{m\_ueRrc}->GetRxPdus ();
303 
304   uint32\_t txEnbRlcPdus = lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a953ff7bc15f6b310a13d35581c2fecef}{m\_enbMac}->\hyperlink{classns3_1_1LteTestMac_a04d893d376960c0fc0adbc982b32c0cc}{GetTxPdus} ();
305   uint32\_t rxUeRlcPdus = lteSimpleHelper->\hyperlink{classns3_1_1LteSimpleHelper_a963987a7323f3f7b1cefbc0e0bc367bc}{m\_ueMac}->\hyperlink{classns3_1_1LteTestMac_ab2ba8d5fc32e1327e353330fac2ffdea}{GetRxPdus} ();
306 
307   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"Run = "} << \hyperlink{classLteRlcAmE2eTestCase_af47c853d67661e384fbed678b588a6e5}{m\_run});
308   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"Loss rate (%) = "} << uint32\_t (\hyperlink{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{m\_losses} * 100));
309 
310   
311   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"RLC PDUs   TX: "} << txEnbRlcPdus 
312                << \textcolor{stringliteral}{"   RX: "} << rxUeRlcPdus 
313                << \textcolor{stringliteral}{"   LOST: "} << \hyperlink{classLteRlcAmE2eTestCase_ab618569119894079072ea0e4867dcaeb}{m\_dlDrops}
314                << \textcolor{stringliteral}{" ("} << (100.0 * (\textcolor{keywordtype}{double}) \hyperlink{classLteRlcAmE2eTestCase_ab618569119894079072ea0e4867dcaeb}{m\_dlDrops})/txEnbRlcPdus << \textcolor{stringliteral}{"%)"});
315 
316   \hyperlink{group__testing_ga2a9d78cffb3db8e867c35fff0b698cf5}{NS\_TEST\_ASSERT\_MSG\_EQ} (txEnbRlcPdus,  rxUeRlcPdus + 
      \hyperlink{classLteRlcAmE2eTestCase_ab618569119894079072ea0e4867dcaeb}{m\_dlDrops}, \textcolor{stringliteral}{"lost RLC PDUs don't match TX + RX"});  
317                           
318   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"eNB tx RRC count = "} << txEnbRrcPdus);
319   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"UE rx RRC count = "} << rxUeRrcPdus);
320 
321 
322   \hyperlink{group__testing_ga2a9d78cffb3db8e867c35fff0b698cf5}{NS\_TEST\_ASSERT\_MSG\_EQ} (txEnbRrcPdus, rxUeRrcPdus,
323                          \textcolor{stringliteral}{"TX PDUs ("} << txEnbRrcPdus << \textcolor{stringliteral}{") != RX PDUs ("} << rxUeRrcPdus << \textcolor{stringliteral}{")"});
324 
325   Simulator::Destroy ();
326 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 3


\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!Ul\+Drop\+Event@{Ul\+Drop\+Event}}
\index{Ul\+Drop\+Event@{Ul\+Drop\+Event}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{Ul\+Drop\+Event(\+Ptr$<$ const Packet $>$ p)}{UlDropEvent(Ptr< const Packet > p)}}]{\setlength{\rightskip}{0pt plus 5cm}void Lte\+Rlc\+Am\+E2e\+Test\+Case\+::\+Ul\+Drop\+Event (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ const {\bf Packet} $>$}]{p}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classLteRlcAmE2eTestCase_ab3e6d1006e655b2743f08a46ca8a414c}{}\label{classLteRlcAmE2eTestCase_ab3e6d1006e655b2743f08a46ca8a414c}

\begin{DoxyCode}
126 \{
127   \textcolor{comment}{// NS\_LOG\_FUNCTION (this);}
128   \hyperlink{classLteRlcAmE2eTestCase_a341e4ba269f052efbd439ebacf09e6f0}{m\_ulDrops}++;
129 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!m\+\_\+bulk\+Sdu\+Arrival@{m\+\_\+bulk\+Sdu\+Arrival}}
\index{m\+\_\+bulk\+Sdu\+Arrival@{m\+\_\+bulk\+Sdu\+Arrival}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+bulk\+Sdu\+Arrival}{m_bulkSduArrival}}]{\setlength{\rightskip}{0pt plus 5cm}bool Lte\+Rlc\+Am\+E2e\+Test\+Case\+::m\+\_\+bulk\+Sdu\+Arrival\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classLteRlcAmE2eTestCase_a401b57783a0a1908adcf7a087757fb83}{}\label{classLteRlcAmE2eTestCase_a401b57783a0a1908adcf7a087757fb83}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!m\+\_\+dl\+Drops@{m\+\_\+dl\+Drops}}
\index{m\+\_\+dl\+Drops@{m\+\_\+dl\+Drops}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+dl\+Drops}{m_dlDrops}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t Lte\+Rlc\+Am\+E2e\+Test\+Case\+::m\+\_\+dl\+Drops\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classLteRlcAmE2eTestCase_ab618569119894079072ea0e4867dcaeb}{}\label{classLteRlcAmE2eTestCase_ab618569119894079072ea0e4867dcaeb}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!m\+\_\+losses@{m\+\_\+losses}}
\index{m\+\_\+losses@{m\+\_\+losses}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+losses}{m_losses}}]{\setlength{\rightskip}{0pt plus 5cm}double Lte\+Rlc\+Am\+E2e\+Test\+Case\+::m\+\_\+losses\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}{}\label{classLteRlcAmE2eTestCase_afbb72ea6f3599c57b19be03be5e43878}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!m\+\_\+run@{m\+\_\+run}}
\index{m\+\_\+run@{m\+\_\+run}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+run}{m_run}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t Lte\+Rlc\+Am\+E2e\+Test\+Case\+::m\+\_\+run\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classLteRlcAmE2eTestCase_af47c853d67661e384fbed678b588a6e5}{}\label{classLteRlcAmE2eTestCase_af47c853d67661e384fbed678b588a6e5}
\index{Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}!m\+\_\+ul\+Drops@{m\+\_\+ul\+Drops}}
\index{m\+\_\+ul\+Drops@{m\+\_\+ul\+Drops}!Lte\+Rlc\+Am\+E2e\+Test\+Case@{Lte\+Rlc\+Am\+E2e\+Test\+Case}}
\subsubsection[{\texorpdfstring{m\+\_\+ul\+Drops}{m_ulDrops}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t Lte\+Rlc\+Am\+E2e\+Test\+Case\+::m\+\_\+ul\+Drops\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classLteRlcAmE2eTestCase_a341e4ba269f052efbd439ebacf09e6f0}{}\label{classLteRlcAmE2eTestCase_a341e4ba269f052efbd439ebacf09e6f0}


The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
lte/test/\hyperlink{lte-test-rlc-am-e2e_8h}{lte-\/test-\/rlc-\/am-\/e2e.\+h}\item 
lte/test/\hyperlink{lte-test-rlc-am-e2e_8cc}{lte-\/test-\/rlc-\/am-\/e2e.\+cc}\end{DoxyCompactItemize}
