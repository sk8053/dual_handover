\hypertarget{fd2fd-onoff_8cc}{}\section{fd-\/net-\/device/examples/fd2fd-\/onoff.cc File Reference}
\label{fd2fd-onoff_8cc}\index{fd-\/net-\/device/examples/fd2fd-\/onoff.\+cc@{fd-\/net-\/device/examples/fd2fd-\/onoff.\+cc}}
{\ttfamily \#include $<$sys/socket.\+h$>$}\\*
{\ttfamily \#include $<$errno.\+h$>$}\\*
{\ttfamily \#include \char`\"{}ns3/core-\/module.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ns3/network-\/module.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ns3/internet-\/module.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ns3/fd-\/net-\/device-\/module.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ns3/applications-\/module.\+h\char`\"{}}\\*
Include dependency graph for fd2fd-\/onoff.cc\+:
% FIG 0
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{fd2fd-onoff_8cc_a547b26f9ad7e39943ebd82e1039c1d77}{N\+S\+\_\+\+L\+O\+G\+\_\+\+C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+D\+E\+F\+I\+NE} (\char`\"{}Fd\+Net\+Device\+Saturation\+Example\char`\"{})
\item 
int \hyperlink{fd2fd-onoff_8cc_a0ddf1224851353fc92bfbff6f499fa97}{main} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\index{fd2fd-\/onoff.\+cc@{fd2fd-\/onoff.\+cc}!main@{main}}
\index{main@{main}!fd2fd-\/onoff.\+cc@{fd2fd-\/onoff.\+cc}}
\subsubsection[{\texorpdfstring{main(int argc, char $\ast$argv[])}{main(int argc, char *argv[])}}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}\hypertarget{fd2fd-onoff_8cc_a0ddf1224851353fc92bfbff6f499fa97}{}\label{fd2fd-onoff_8cc_a0ddf1224851353fc92bfbff6f499fa97}

\begin{DoxyCode}
59 \{
60 
61   \textcolor{comment}{// Command-line arguments}
62   \textcolor{comment}{//}
63   \textcolor{keywordtype}{bool} tcpMode = \textcolor{keyword}{false};
64   \hyperlink{classns3_1_1CommandLine}{CommandLine} cmd;
65   cmd.\hyperlink{classns3_1_1CommandLine_addcfb546c7ad4c8bd0965654d55beb8e}{AddValue} (\textcolor{stringliteral}{"tcpMode"}, \textcolor{stringliteral}{"1:true, 0:false, default mode UDP"},tcpMode);
66   cmd.\hyperlink{classns3_1_1CommandLine_a5c10b85b3207e5ecb48d907966923156}{Parse} (argc, argv);
67    
68   std::string factory;
69   \textcolor{keywordflow}{if} (tcpMode==1)
70     \{
71       factory = \textcolor{stringliteral}{"ns3::TcpSocketFactory"};
72     \}
73   \textcolor{keywordflow}{else}
74     \{
75       factory = \textcolor{stringliteral}{"ns3::UdpSocketFactory"};
76     \}
77 
78   GlobalValue::Bind (\textcolor{stringliteral}{"ChecksumEnabled"}, \hyperlink{classns3_1_1BooleanValue}{BooleanValue} (\textcolor{keyword}{true}));
79 
80   uint16\_t sinkPort = 8000;
81   uint32\_t packetSize = 10000; \textcolor{comment}{// bytes}
82   std::string dataRate(\textcolor{stringliteral}{"10Mb/s"});
83 
84   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"Create Node"});
85   \hyperlink{classns3_1_1NodeContainer}{NodeContainer} \hyperlink{visualizer-ideas_8txt_a3e1b3808014a2c68ab0cd0182e041be2}{nodes};
86   nodes.\hyperlink{classns3_1_1NodeContainer_a787f059e2813e8b951cc6914d11dfe69}{Create} (2);
87 
88   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"Create Device"});
89   \hyperlink{classns3_1_1FdNetDeviceHelper}{FdNetDeviceHelper} \hyperlink{lte_2model_2fading-traces_2fading__trace__generator_8m_a44f21d5190b5a6df8089f54799628d7e}{fd};
90   \hyperlink{classns3_1_1NetDeviceContainer}{NetDeviceContainer} devices = fd.\hyperlink{classns3_1_1FdNetDeviceHelper_af70d55cbb4f6411c33cacb84eb651ad5}{Install} (nodes);
91 
92   \textcolor{keywordtype}{int} sv[2];
93   \textcolor{keywordflow}{if} (socketpair (AF\_UNIX, SOCK\_DGRAM, 0, sv) < 0)
94     \{
95       \hyperlink{group__fatal_ga5131d5e3f75d7d4cbfd706ac456fdc85}{NS\_FATAL\_ERROR} (\textcolor{stringliteral}{"Error creating pipe="} << strerror (errno));
96     \}
97 
98   \hyperlink{classns3_1_1Ptr}{Ptr<NetDevice>} \hyperlink{lte__link__budget__interference_8m_ab5ca0c44c6f0a063a5219b3749db661f}{d1} = devices.\hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (0);
99   \hyperlink{classns3_1_1Ptr}{Ptr<FdNetDevice>} clientDevice = d1->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<
      \hyperlink{classns3_1_1FdNetDevice}{FdNetDevice}> ();
100   clientDevice->\hyperlink{classns3_1_1FdNetDevice_ac72fff1b3d44824245645a9bcb37c709}{SetFileDescriptor} (sv[0]);
101 
102   \hyperlink{classns3_1_1Ptr}{Ptr<NetDevice>} \hyperlink{lte__cqi__generation_8m_a479b78c01efbe4664b402a300da492f7}{d2} = devices.\hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (1);
103   \hyperlink{classns3_1_1Ptr}{Ptr<FdNetDevice>} serverDevice = d2->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<
      \hyperlink{classns3_1_1FdNetDevice}{FdNetDevice}> ();
104   serverDevice->\hyperlink{classns3_1_1FdNetDevice_ac72fff1b3d44824245645a9bcb37c709}{SetFileDescriptor} (sv[1]);
105 
106   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"Add Internet Stack"});
107   \hyperlink{classns3_1_1InternetStackHelper}{InternetStackHelper} internetStackHelper;
108   internetStackHelper.\hyperlink{classns3_1_1InternetStackHelper_a10e2a35f410d0d1c90d979542c8bfd6e}{SetIpv4StackInstall}(\textcolor{keyword}{true});
109   internetStackHelper.\hyperlink{classns3_1_1InternetStackHelper_a6645b412f31283d2d9bc3d8a95cebbc0}{Install} (nodes);
110 
111   \hyperlink{group__logging_gafbd73ee2cf9f26b319f49086d8e860fb}{NS\_LOG\_INFO} (\textcolor{stringliteral}{"Create IPv4 Interface"});
112   \hyperlink{classns3_1_1Ipv4AddressHelper}{Ipv4AddressHelper} addresses;
113   addresses.\hyperlink{classns3_1_1Ipv4AddressHelper_acf7b16dd25bac67e00f5e25f90a9a035}{SetBase} (\textcolor{stringliteral}{"10.0.0.0"}, \textcolor{stringliteral}{"255.255.255.0"});
114   \hyperlink{classns3_1_1Ipv4InterfaceContainer}{Ipv4InterfaceContainer} interfaces = addresses.\hyperlink{classns3_1_1Ipv4AddressHelper_af8e7f4a1a7e74c00014a1eac445a27af}{Assign} (devices);
115 
116   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} clientNode = nodes.\hyperlink{classns3_1_1NodeContainer_a9ed96e2ecc22e0f5a3d4842eb9bf90bf}{Get} (0);
117   \hyperlink{classns3_1_1Ipv4Address}{Ipv4Address} serverIp = interfaces.\hyperlink{classns3_1_1Ipv4InterfaceContainer_ae63208dcd222be986822937ee4aa828c}{GetAddress} (1);
118   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} serverNode = nodes.\hyperlink{classns3_1_1NodeContainer_a9ed96e2ecc22e0f5a3d4842eb9bf90bf}{Get} (1);
119 
120   \textcolor{comment}{// server}
121   \hyperlink{classns3_1_1Address}{Address} sinkLocalAddress (\hyperlink{classns3_1_1InetSocketAddress}{InetSocketAddress} (serverIp, sinkPort));
122 
123   \hyperlink{classns3_1_1PacketSinkHelper}{PacketSinkHelper} sinkHelper (factory, sinkLocalAddress);
124   \hyperlink{classns3_1_1ApplicationContainer}{ApplicationContainer} sinkApp = sinkHelper.Install (serverNode);
125   sinkApp.\hyperlink{classns3_1_1ApplicationContainer_a8eff87926507020bbe3e1390358a54a7}{Start} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.0));
126   sinkApp.\hyperlink{classns3_1_1ApplicationContainer_adfc52f9aa4020c8714679b00bbb9ddb3}{Stop} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (30.0));
127   fd.\hyperlink{classns3_1_1PcapHelperForDevice_a74866def9a881aa9d5c5be1225a26722}{EnablePcap} (\textcolor{stringliteral}{"fd2fd-onoff-server"}, serverDevice);
128 
129   \textcolor{comment}{// client}
130   AddressValue serverAddress (\hyperlink{classns3_1_1InetSocketAddress}{InetSocketAddress} (serverIp, sinkPort));
131   \hyperlink{classns3_1_1OnOffHelper}{OnOffHelper} onoff (factory, \hyperlink{classns3_1_1Address}{Address} ());
132   onoff.SetAttribute (\textcolor{stringliteral}{"Remote"}, serverAddress);
133   onoff.SetAttribute (\textcolor{stringliteral}{"OnTime"}, StringValue (\textcolor{stringliteral}{"ns3::ConstantRandomVariable[Constant=1]"}));
134   onoff.SetAttribute (\textcolor{stringliteral}{"OffTime"}, StringValue (\textcolor{stringliteral}{"ns3::ConstantRandomVariable[Constant=0]"}));
135   onoff.SetAttribute (\textcolor{stringliteral}{"DataRate"}, DataRateValue (dataRate));
136   onoff.SetAttribute (\textcolor{stringliteral}{"PacketSize"}, UintegerValue (packetSize));
137   \hyperlink{classns3_1_1ApplicationContainer}{ApplicationContainer} clientApps = onoff.Install (clientNode);
138   clientApps.\hyperlink{classns3_1_1ApplicationContainer_a8eff87926507020bbe3e1390358a54a7}{Start} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (2.0));
139   clientApps.\hyperlink{classns3_1_1ApplicationContainer_adfc52f9aa4020c8714679b00bbb9ddb3}{Stop} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (29.0));
140   fd.\hyperlink{classns3_1_1PcapHelperForDevice_a74866def9a881aa9d5c5be1225a26722}{EnablePcap} (\textcolor{stringliteral}{"fd2fd-onoff-client"}, clientDevice);
141 
142   Simulator::Stop (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (30.0));
143   Simulator::Run ();
144   Simulator::Destroy ();
145 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 1


\index{fd2fd-\/onoff.\+cc@{fd2fd-\/onoff.\+cc}!N\+S\+\_\+\+L\+O\+G\+\_\+\+C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+D\+E\+F\+I\+NE@{N\+S\+\_\+\+L\+O\+G\+\_\+\+C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+D\+E\+F\+I\+NE}}
\index{N\+S\+\_\+\+L\+O\+G\+\_\+\+C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+D\+E\+F\+I\+NE@{N\+S\+\_\+\+L\+O\+G\+\_\+\+C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+D\+E\+F\+I\+NE}!fd2fd-\/onoff.\+cc@{fd2fd-\/onoff.\+cc}}
\subsubsection[{\texorpdfstring{N\+S\+\_\+\+L\+O\+G\+\_\+\+C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+D\+E\+F\+I\+N\+E(""Fd\+Net\+Device\+Saturation\+Example"")}{NS_LOG_COMPONENT_DEFINE("FdNetDeviceSaturationExample")}}]{\setlength{\rightskip}{0pt plus 5cm}N\+S\+\_\+\+L\+O\+G\+\_\+\+C\+O\+M\+P\+O\+N\+E\+N\+T\+\_\+\+D\+E\+F\+I\+NE (
\begin{DoxyParamCaption}
\item[{\char`\"{}Fd\+Net\+Device\+Saturation\+Example\char`\"{}}]{}
\end{DoxyParamCaption}
)}\hypertarget{fd2fd-onoff_8cc_a547b26f9ad7e39943ebd82e1039c1d77}{}\label{fd2fd-onoff_8cc_a547b26f9ad7e39943ebd82e1039c1d77}
