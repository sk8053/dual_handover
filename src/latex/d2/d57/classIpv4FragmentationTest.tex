\hypertarget{classIpv4FragmentationTest}{}\section{Ipv4\+Fragmentation\+Test Class Reference}
\label{classIpv4FragmentationTest}\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}


I\+Pv4 Fragmentation Test.  




Inheritance diagram for Ipv4\+Fragmentation\+Test\+:
% FIG 0


Collaboration diagram for Ipv4\+Fragmentation\+Test\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classIpv4FragmentationTest_abe15a9d41a354bd95bf8c0b1622a54cb}{Do\+Run} (void)
\begin{DoxyCompactList}\small\item\em Implementation to actually run this Test\+Case. \end{DoxyCompactList}\item 
\hyperlink{classIpv4FragmentationTest_a218a5125235ca9219716bda33eb7994f}{Ipv4\+Fragmentation\+Test} ()
\item 
\hyperlink{classIpv4FragmentationTest_ab78e808cd613878219af0c1aad592ff8}{$\sim$\+Ipv4\+Fragmentation\+Test} ()
\item 
void \hyperlink{classIpv4FragmentationTest_a854c6040ada33b3c61c03b459d1a1d72}{Start\+Server} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Node}{Node} $>$ Server\+Node)
\begin{DoxyCompactList}\small\item\em Start the server. \end{DoxyCompactList}\item 
void \hyperlink{classIpv4FragmentationTest_ae96faa04d6aa0facdf1fbbabb1e3af01}{Handle\+Read\+Server} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Socket}{Socket} $>$ socket)
\begin{DoxyCompactList}\small\item\em Handle incoming packets. \end{DoxyCompactList}\item 
void \hyperlink{classIpv4FragmentationTest_a5ce3759e72c31d2f86d6424ff0702b47}{Start\+Client} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Node}{Node} $>$ Client\+Node)
\begin{DoxyCompactList}\small\item\em Start the client. \end{DoxyCompactList}\item 
void \hyperlink{classIpv4FragmentationTest_ad409cf6c22b25e40f02bd59be6c8350f}{Handle\+Read\+Client} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Socket}{Socket} $>$ socket)
\begin{DoxyCompactList}\small\item\em Handle incoming packets. \end{DoxyCompactList}\item 
void \hyperlink{classIpv4FragmentationTest_a8f6da7f64518a34543b2e164a1b363a4}{Handle\+Read\+Icmp\+Client} (\hyperlink{classns3_1_1Ipv4Address}{Ipv4\+Address} icmp\+Source, uint8\+\_\+t icmp\+Ttl, uint8\+\_\+t icmp\+Type, uint8\+\_\+t icmp\+Code, uint32\+\_\+t icmp\+Info)
\begin{DoxyCompactList}\small\item\em Handle incoming I\+C\+MP packets. \end{DoxyCompactList}\item 
void \hyperlink{classIpv4FragmentationTest_af2de35c56cd4b51230784881bd1221a8}{Set\+Fill} (uint8\+\_\+t $\ast$fill, uint32\+\_\+t fill\+Size, uint32\+\_\+t data\+Size)
\begin{DoxyCompactList}\small\item\em Set the packet fill. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{classIpv4FragmentationTest_a3df0b70a39a1fec9205b40f47a64ab6f}{Send\+Client} (void)
\begin{DoxyCompactList}\small\item\em Send a packet. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{classIpv4FragmentationTest_a2101eb6eb2f3da7f4ba981a08fbf84e0}{m\+\_\+sent\+Packet\+Client}
\begin{DoxyCompactList}\small\item\em Packet sent by client. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{classIpv4FragmentationTest_a006c01f850b31012c3d7794c488fa4a1}{m\+\_\+received\+Packet\+Client}
\begin{DoxyCompactList}\small\item\em Packet received by client. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\+\_\+received\+Packet\+Server}
\begin{DoxyCompactList}\small\item\em Packet received by server. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Socket}{Socket} $>$ \hyperlink{classIpv4FragmentationTest_a5960ce9f8f50e1635921f941c0388f15}{m\+\_\+socket\+Server}
\begin{DoxyCompactList}\small\item\em Server socket. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Socket}{Socket} $>$ \hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\+\_\+socket\+Client}
\begin{DoxyCompactList}\small\item\em Client socket. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{classIpv4FragmentationTest_ac2d67ec7308b06170caa50497ac634a9}{m\+\_\+data\+Size}
\begin{DoxyCompactList}\small\item\em Data size. \end{DoxyCompactList}\item 
uint8\+\_\+t $\ast$ \hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\+\_\+data}
\begin{DoxyCompactList}\small\item\em Data. \end{DoxyCompactList}\item 
uint32\+\_\+t \hyperlink{classIpv4FragmentationTest_a2fa502a8c06dc3e751cacbf31e687251}{m\+\_\+size}
\begin{DoxyCompactList}\small\item\em packet size. \end{DoxyCompactList}\item 
uint8\+\_\+t \hyperlink{classIpv4FragmentationTest_a2ee305a2995a09b8b2faf2ecf700c90d}{m\+\_\+icmp\+Type}
\begin{DoxyCompactList}\small\item\em I\+C\+MP type. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
I\+Pv4 Fragmentation Test. 

\subsection{Constructor \& Destructor Documentation}
\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{Ipv4\+Fragmentation\+Test()}{Ipv4FragmentationTest()}}]{\setlength{\rightskip}{0pt plus 5cm}Ipv4\+Fragmentation\+Test\+::\+Ipv4\+Fragmentation\+Test (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classIpv4FragmentationTest_a218a5125235ca9219716bda33eb7994f}{}\label{classIpv4FragmentationTest_a218a5125235ca9219716bda33eb7994f}

\begin{DoxyCode}
171   : \hyperlink{classns3_1_1TestCase_a3b0b91a96aac1933e8d146e019b9e207}{TestCase} (\textcolor{stringliteral}{"Verify the IPv4 layer 3 protocol fragmentation and reassembly"})
172 \{
173   \hyperlink{classIpv4FragmentationTest_a5960ce9f8f50e1635921f941c0388f15}{m\_socketServer} = 0;
174   \hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data} = 0;
175   \hyperlink{classIpv4FragmentationTest_ac2d67ec7308b06170caa50497ac634a9}{m\_dataSize} = 0;
176   \hyperlink{classIpv4FragmentationTest_a2fa502a8c06dc3e751cacbf31e687251}{m\_size} = 0;
177   \hyperlink{classIpv4FragmentationTest_a2ee305a2995a09b8b2faf2ecf700c90d}{m\_icmpType} = 0;
178 \}
\end{DoxyCode}
\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!````~Ipv4\+Fragmentation\+Test@{$\sim$\+Ipv4\+Fragmentation\+Test}}
\index{````~Ipv4\+Fragmentation\+Test@{$\sim$\+Ipv4\+Fragmentation\+Test}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{$\sim$\+Ipv4\+Fragmentation\+Test()}{~Ipv4FragmentationTest()}}]{\setlength{\rightskip}{0pt plus 5cm}Ipv4\+Fragmentation\+Test\+::$\sim$\+Ipv4\+Fragmentation\+Test (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classIpv4FragmentationTest_ab78e808cd613878219af0c1aad592ff8}{}\label{classIpv4FragmentationTest_ab78e808cd613878219af0c1aad592ff8}

\begin{DoxyCode}
181 \{
182   \textcolor{keywordflow}{if} ( \hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data} )
183     \{
184       \textcolor{keyword}{delete}[] \hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data};
185     \}
186   \hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data} = 0;
187   \hyperlink{classIpv4FragmentationTest_ac2d67ec7308b06170caa50497ac634a9}{m\_dataSize} = 0;
188 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!Do\+Run@{Do\+Run}}
\index{Do\+Run@{Do\+Run}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{Do\+Run(void)}{DoRun(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv4\+Fragmentation\+Test\+::\+Do\+Run (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\hypertarget{classIpv4FragmentationTest_abe15a9d41a354bd95bf8c0b1622a54cb}{}\label{classIpv4FragmentationTest_abe15a9d41a354bd95bf8c0b1622a54cb}


Implementation to actually run this Test\+Case. 

Subclasses should override this method to conduct their tests. 

Implements \hyperlink{classns3_1_1TestCase_a8ff74680cf017ed42011e4be51917a24}{ns3\+::\+Test\+Case}.


\begin{DoxyCode}
316 \{
317   \textcolor{comment}{// set the arp cache to something quite high}
318   \textcolor{comment}{// we shouldn't need because the NetDevice used doesn't need arp, but still}
319   \hyperlink{group__config_ga2e7882df849d8ba4aaad31c934c40c06}{Config::SetDefault} (\textcolor{stringliteral}{"ns3::ArpCache::PendingQueueSize"}, UintegerValue (100));
320 
321   \textcolor{comment}{// Create topology}
322   
323    \textcolor{comment}{// Receiver Node}
324   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} serverNode = CreateObject<Node> ();
325   \textcolor{comment}{// Sender Node}
326   \hyperlink{classns3_1_1Ptr}{Ptr<Node>} clientNode = CreateObject<Node> ();
327 
328   \hyperlink{classns3_1_1NodeContainer}{NodeContainer} \hyperlink{visualizer-ideas_8txt_a3e1b3808014a2c68ab0cd0182e041be2}{nodes} (serverNode, clientNode);
329 
330   \hyperlink{classns3_1_1Ptr}{Ptr<ErrorChannel>} channel = CreateObject<ErrorChannel> ();
331   channel->\hyperlink{classns3_1_1ErrorChannel_a907fdc086d939d84eb4e612d0eac1d84}{SetJumpingTime} (\hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0.5));
332 
333   \hyperlink{classns3_1_1SimpleNetDeviceHelper}{SimpleNetDeviceHelper} helperChannel;
334   helperChannel.\hyperlink{classns3_1_1SimpleNetDeviceHelper_a474460ba6942d4933f443a97df7d4716}{SetNetDevicePointToPointMode} (\textcolor{keyword}{true});
335   \hyperlink{classns3_1_1NetDeviceContainer}{NetDeviceContainer} net = helperChannel.\hyperlink{classns3_1_1SimpleNetDeviceHelper_a35bed9cee32d306362d3e24dfeef4513}{Install} (\hyperlink{visualizer-ideas_8txt_a3e1b3808014a2c68ab0cd0182e041be2}{nodes}, channel);
336 
337   \hyperlink{classns3_1_1InternetStackHelper}{InternetStackHelper} internet;
338   internet.\hyperlink{classns3_1_1InternetStackHelper_a6645b412f31283d2d9bc3d8a95cebbc0}{Install} (\hyperlink{visualizer-ideas_8txt_a3e1b3808014a2c68ab0cd0182e041be2}{nodes});
339 
340   \hyperlink{classns3_1_1Ptr}{Ptr<Ipv4>} ipv4;
341   uint32\_t netdev\_idx;
342   \hyperlink{classns3_1_1Ipv4InterfaceAddress}{Ipv4InterfaceAddress} ipv4Addr;
343 
344   \textcolor{comment}{// Receiver Node}
345   ipv4 = serverNode->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1Ipv4}{Ipv4}> ();
346   netdev\_idx = ipv4->\hyperlink{classns3_1_1Ipv4_a637354128b71bc587ea5a6eeaef42469}{AddInterface} (net.\hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (0));
347   ipv4Addr = \hyperlink{classns3_1_1Ipv4InterfaceAddress}{Ipv4InterfaceAddress} (\hyperlink{classns3_1_1Ipv4Address}{Ipv4Address} (\textcolor{stringliteral}{"10.0.0.1"}), 
      \hyperlink{classns3_1_1Ipv4Mask}{Ipv4Mask} (0xffff0000U));
348   ipv4->\hyperlink{classns3_1_1Ipv4_ad203526cae6a4b86f1bb89e44d2b62f7}{AddAddress} (netdev\_idx, ipv4Addr);
349   ipv4->\hyperlink{classns3_1_1Ipv4_a71b2f8acca4923aef907b50b3196bf23}{SetUp} (netdev\_idx);
350   \hyperlink{classns3_1_1Ptr}{Ptr<BinaryErrorModel>} serverDevErrorModel = CreateObject<BinaryErrorModel> ();
351   \hyperlink{classns3_1_1Ptr}{Ptr<SimpleNetDevice>} serverDev = DynamicCast<SimpleNetDevice> (net.
      \hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (0));
352   serverDevErrorModel->\hyperlink{classns3_1_1ErrorModel_a55d35a3e713c31f650577e9f96cf25c0}{Disable} ();
353   serverDev->SetMtu(1500);
354   serverDev->SetReceiveErrorModel (serverDevErrorModel);
355   \hyperlink{classIpv4FragmentationTest_a854c6040ada33b3c61c03b459d1a1d72}{StartServer} (serverNode);
356 
357   \textcolor{comment}{// Sender Node}
358   ipv4 = clientNode->\hyperlink{classns3_1_1Object_a13e18c00017096c8381eb651d5bd0783}{GetObject}<\hyperlink{classns3_1_1Ipv4}{Ipv4}> ();
359   netdev\_idx = ipv4->\hyperlink{classns3_1_1Ipv4_a637354128b71bc587ea5a6eeaef42469}{AddInterface} (net.\hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (1));
360   ipv4Addr = \hyperlink{classns3_1_1Ipv4InterfaceAddress}{Ipv4InterfaceAddress} (\hyperlink{classns3_1_1Ipv4Address}{Ipv4Address} (\textcolor{stringliteral}{"10.0.0.2"}), 
      \hyperlink{classns3_1_1Ipv4Mask}{Ipv4Mask} (0xffff0000U));
361   ipv4->\hyperlink{classns3_1_1Ipv4_ad203526cae6a4b86f1bb89e44d2b62f7}{AddAddress} (netdev\_idx, ipv4Addr);
362   ipv4->\hyperlink{classns3_1_1Ipv4_a71b2f8acca4923aef907b50b3196bf23}{SetUp} (netdev\_idx);
363   \hyperlink{classns3_1_1Ptr}{Ptr<BinaryErrorModel>} clientDevErrorModel = CreateObject<BinaryErrorModel> ();
364   \hyperlink{classns3_1_1Ptr}{Ptr<SimpleNetDevice>} clientDev = DynamicCast<SimpleNetDevice> (net.
      \hyperlink{classns3_1_1NetDeviceContainer_a677d62594b5c9d2dea155cc5045f4d0b}{Get} (1));
365   clientDevErrorModel->\hyperlink{classns3_1_1ErrorModel_a55d35a3e713c31f650577e9f96cf25c0}{Disable} ();
366   clientDev->SetMtu(1500);
367   clientDev->SetReceiveErrorModel (clientDevErrorModel);
368   \hyperlink{classIpv4FragmentationTest_a5ce3759e72c31d2f86d6424ff0702b47}{StartClient} (clientNode);
369 
370   \textcolor{comment}{// some small packets, some rather big ones}
371   uint32\_t packetSizes[5] = \{1000, 2000, 5000, 10000, 65000\};
372 
373   \textcolor{comment}{// using the alphabet}
374   uint8\_t fillData[78];
375   \textcolor{keywordflow}{for} ( uint32\_t k=48; k<=125; k++ )
376     \{
377       fillData[k-48] = k;
378     \}
379 
380   \textcolor{comment}{// First test: normal channel, no errors, no delays}
381   \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}= 0; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}<5; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}++)
382     \{
383       uint32\_t packetSize = packetSizes[\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}];
384 
385       \hyperlink{classIpv4FragmentationTest_af2de35c56cd4b51230784881bd1221a8}{SetFill} (fillData, 78, packetSize);
386 
387       \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer} = Create<Packet> ();
388       Simulator::ScheduleWithContext (\hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient}->\hyperlink{classns3_1_1Socket_aba642ad4301c1df47befc0aa9afa2e48}{GetNode} ()->
      \hyperlink{classns3_1_1Node_aaf49b64a843565ce3812326313b370ac}{GetId} (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
389                                       &\hyperlink{classIpv4FragmentationTest_a3df0b70a39a1fec9205b40f47a64ab6f}{Ipv4FragmentationTest::SendClient}, \textcolor{keyword}{
      this});
390       Simulator::Run ();
391 
392       uint8\_t recvBuffer[65000];
393 
394       uint16\_t recvSize = \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer}->\hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} ();
395 
396       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (recvSize, packetSizes[\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}], \textcolor{stringliteral}{"Packet size not correct"});
397 
398       \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer}->\hyperlink{classns3_1_1Packet_a5a6d304b9e0d90733919ffe224b98f0d}{CopyData}(recvBuffer, 65000);
399       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (memcmp(\hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data}, recvBuffer, 
      \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer}->\hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} ()),
400                              0, \textcolor{stringliteral}{"Packet content differs"});
401     \}
402 
403   \textcolor{comment}{// Second test: normal channel, no errors, delays each 2 packets.}
404   \textcolor{comment}{// Each other fragment will arrive out-of-order.}
405   \textcolor{comment}{// The packets should be received correctly since reassembly will reorder the fragments.}
406   channel->\hyperlink{classns3_1_1ErrorChannel_aa30b3b76ca1fc19aa68e28bd21431131}{SetJumpingMode}(\textcolor{keyword}{true});
407   \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}= 0; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}<5; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}++)
408     \{
409       uint32\_t packetSize = packetSizes[\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}];
410 
411       \hyperlink{classIpv4FragmentationTest_af2de35c56cd4b51230784881bd1221a8}{SetFill} (fillData, 78, packetSize);
412 
413       \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer} = Create<Packet> ();
414       Simulator::ScheduleWithContext (\hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient}->\hyperlink{classns3_1_1Socket_aba642ad4301c1df47befc0aa9afa2e48}{GetNode} ()->
      \hyperlink{classns3_1_1Node_aaf49b64a843565ce3812326313b370ac}{GetId} (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
415                                       &\hyperlink{classIpv4FragmentationTest_a3df0b70a39a1fec9205b40f47a64ab6f}{Ipv4FragmentationTest::SendClient}, \textcolor{keyword}{
      this});
416       Simulator::Run ();
417 
418       uint8\_t recvBuffer[65000];
419 
420       uint16\_t recvSize = \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer}->\hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} ();
421 
422       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (recvSize, packetSizes[\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}], \textcolor{stringliteral}{"Packet size not correct"});
423 
424       \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer}->\hyperlink{classns3_1_1Packet_a5a6d304b9e0d90733919ffe224b98f0d}{CopyData}(recvBuffer, 65000);
425       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (memcmp(\hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data}, recvBuffer, 
      \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer}->\hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} ()),
426                              0, \textcolor{stringliteral}{"Packet content differs"});
427     \}
428   channel->\hyperlink{classns3_1_1ErrorChannel_aa30b3b76ca1fc19aa68e28bd21431131}{SetJumpingMode}(\textcolor{keyword}{false});
429 
430   \textcolor{comment}{// Third test: normal channel, some errors, no delays.}
431   \textcolor{comment}{// The reassembly procedure should fire a timeout after 30 seconds (as specified in the RFCs).}
432   \textcolor{comment}{// Upon the timeout, the fragments received so far are discarded and an ICMP should be sent back}
433   \textcolor{comment}{// to the sender (if the first fragment has been received).}
434   \textcolor{comment}{// In this test case the first fragment is received, so we do expect an ICMP.}
435   \textcolor{comment}{// Client -> Server : errors enabled}
436   \textcolor{comment}{// Server -> Client : errors disabled (we want to have back the ICMP)}
437   clientDevErrorModel->\hyperlink{classns3_1_1ErrorModel_a55d35a3e713c31f650577e9f96cf25c0}{Disable}();
438   serverDevErrorModel->\hyperlink{classns3_1_1ErrorModel_a571d61a2fc9ce2d30df95da7e87b763c}{Enable}();
439   \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}= 1; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}<5; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}++)
440     \{
441       uint32\_t packetSize = packetSizes[\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}];
442 
443       \hyperlink{classIpv4FragmentationTest_af2de35c56cd4b51230784881bd1221a8}{SetFill} (fillData, 78, packetSize);
444 
445       \textcolor{comment}{// reset the model, we want to receive the very first fragment.}
446       serverDevErrorModel->\hyperlink{classns3_1_1ErrorModel_a6b7cbe56c27562e5ba6daf2f04bcd282}{Reset}();
447 
448       \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer} = Create<Packet> ();
449       \hyperlink{classIpv4FragmentationTest_a2ee305a2995a09b8b2faf2ecf700c90d}{m\_icmpType} = 0;
450       Simulator::ScheduleWithContext (\hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient}->\hyperlink{classns3_1_1Socket_aba642ad4301c1df47befc0aa9afa2e48}{GetNode} ()->
      \hyperlink{classns3_1_1Node_aaf49b64a843565ce3812326313b370ac}{GetId} (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
451                                       &\hyperlink{classIpv4FragmentationTest_a3df0b70a39a1fec9205b40f47a64ab6f}{Ipv4FragmentationTest::SendClient}, \textcolor{keyword}{
      this});
452       Simulator::Run ();
453 
454       uint16\_t recvSize = \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer}->\hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} ();
455 
456       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} ((recvSize == 0), \textcolor{keyword}{true}, \textcolor{stringliteral}{"Server got a packet, something
       wrong"});
457       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} ((m\_icmpType == 11), \textcolor{keyword}{true}, \textcolor{stringliteral}{"Client did not receive
       ICMP::TIME\_EXCEEDED"});
458     \}
459 
460   \textcolor{comment}{// Fourth test: normal channel, no errors, no delays.}
461   \textcolor{comment}{// We check tags}
462   clientDevErrorModel->\hyperlink{classns3_1_1ErrorModel_a55d35a3e713c31f650577e9f96cf25c0}{Disable} ();
463   serverDevErrorModel->\hyperlink{classns3_1_1ErrorModel_a55d35a3e713c31f650577e9f96cf25c0}{Disable} ();
464   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}= 0; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}<5; \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}++)
465     \{
466       uint32\_t packetSize = packetSizes[\hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}];
467 
468       \hyperlink{classIpv4FragmentationTest_af2de35c56cd4b51230784881bd1221a8}{SetFill} (fillData, 78, packetSize);
469 
470       \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer} = Create<Packet> ();
471       Simulator::ScheduleWithContext (\hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient}->\hyperlink{classns3_1_1Socket_aba642ad4301c1df47befc0aa9afa2e48}{GetNode} ()->
      \hyperlink{classns3_1_1Node_aaf49b64a843565ce3812326313b370ac}{GetId} (), \hyperlink{group__timecivil_ga33c34b816f8ff6628e33d5c8e9713b9e}{Seconds} (0),
472                                       &\hyperlink{classIpv4FragmentationTest_a3df0b70a39a1fec9205b40f47a64ab6f}{Ipv4FragmentationTest::SendClient}, \textcolor{keyword}{
      this});
473       Simulator::Run ();
474 
475       \hyperlink{classIPv4TestTag}{IPv4TestTag} packetTag;
476       \textcolor{keywordtype}{bool} found = \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer}->\hyperlink{classns3_1_1Packet_a1734de11f2ca1e78a7872461a0625168}{PeekPacketTag} (packetTag);
477 
478       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (found, \textcolor{keyword}{true}, \textcolor{stringliteral}{"PacketTag not found"});
479       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (packetTag.\hyperlink{classIPv4TestTag_a08214d998ffb2812da56dd9d5dca7da7}{GetToken} (), 42, \textcolor{stringliteral}{"PacketTag value not
       correct"});
480 
481       \hyperlink{classns3_1_1ByteTagIterator}{ByteTagIterator} iter = \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer}->
      \hyperlink{classns3_1_1Packet_a3c03f35c267e8534c29bdaa4686e4823}{GetByteTagIterator} ();
482 
483       uint32\_t end = 0;
484       uint32\_t tagStart = 0;
485       uint32\_t tagEnd = 0;
486       \textcolor{keywordflow}{while} (iter.HasNext ())
487         \{
488           \hyperlink{classns3_1_1ByteTagIterator_1_1Item}{ByteTagIterator::Item} item = iter.Next ();
489           \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (item.\hyperlink{classns3_1_1ByteTagIterator_1_1Item_aaae5fe08c2b67ac485faa4372fe38cea}{GetTypeId} ().
      \hyperlink{classns3_1_1TypeId_aa3c41c79ae428b3cb396a9c6bb3ef314}{GetName} (), \textcolor{stringliteral}{"ns3::IPv4TestTag"}, \textcolor{stringliteral}{"ByteTag name not correct"});
490           tagStart = item.\hyperlink{classns3_1_1ByteTagIterator_1_1Item_abaf7c97dec29431934732d656361d13c}{GetStart} ();
491           tagEnd = item.\hyperlink{classns3_1_1ByteTagIterator_1_1Item_a47e206d7530bd378c26a55f206deefea}{GetEnd} ();
492           \textcolor{keywordflow}{if} (end == 0)
493             \{
494               \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (tagStart, 0, \textcolor{stringliteral}{"First ByteTag Start not correct"});
495             \}
496           \textcolor{keywordflow}{if} (end != 0)
497             \{
498               \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (tagStart, end, \textcolor{stringliteral}{"ByteTag End not correct"});
499             \}
500           end = tagEnd;
501           \hyperlink{classIPv4TestTag}{IPv4TestTag} *byteTag = \textcolor{keyword}{dynamic\_cast<}\hyperlink{classIPv4TestTag}{IPv4TestTag} *\textcolor{keyword}{>} (item.
      \hyperlink{classns3_1_1ByteTagIterator_1_1Item_aaae5fe08c2b67ac485faa4372fe38cea}{GetTypeId} ().\hyperlink{classns3_1_1TypeId_ad9b0bc71ee7593a1ff23ff8d53938e95}{GetConstructor} () ());
502           \hyperlink{group__testing_ga6d4b162d26b8a930115b97dd5f3d9ed9}{NS\_TEST\_EXPECT\_MSG\_NE} (byteTag, 0, \textcolor{stringliteral}{"ByteTag not found"});
503           item.\hyperlink{classns3_1_1ByteTagIterator_1_1Item_ada7f72efd4a0d9caef5edae0ea571ec1}{GetTag} (*byteTag);
504           \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (byteTag->\hyperlink{classIPv4TestTag_a08214d998ffb2812da56dd9d5dca7da7}{GetToken} (), 42, \textcolor{stringliteral}{"ByteTag value not
       correct"});
505           \textcolor{keyword}{delete} byteTag;
506         \}
507       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (end, \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer}->
      \hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} (), \textcolor{stringliteral}{"trivial"});
508     \}
509 
510 
511   Simulator::Destroy ();
512 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2


\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!Handle\+Read\+Client@{Handle\+Read\+Client}}
\index{Handle\+Read\+Client@{Handle\+Read\+Client}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{Handle\+Read\+Client(\+Ptr$<$ Socket $>$ socket)}{HandleReadClient(Ptr< Socket > socket)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv4\+Fragmentation\+Test\+::\+Handle\+Read\+Client (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Socket} $>$}]{socket}
\end{DoxyParamCaption}
)}\hypertarget{classIpv4FragmentationTest_ad409cf6c22b25e40f02bd59be6c8350f}{}\label{classIpv4FragmentationTest_ad409cf6c22b25e40f02bd59be6c8350f}


Handle incoming packets. 


\begin{DoxyParams}{Parameters}
{\em socket} & The receiving socket. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
245 \{
246   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} packet;
247   \hyperlink{classns3_1_1Address}{Address} \hyperlink{lte__amc_8m_a1b4c81ff74eb1a626b5ade44c81004b3}{from};
248   \textcolor{keywordflow}{while} ((packet = socket->\hyperlink{classns3_1_1Socket_af22378d7af9a2745a9eada20210da215}{RecvFrom} (from)))
249     \{
250       \textcolor{keywordflow}{if} (InetSocketAddress::IsMatchingType (from))
251         \{
252           \hyperlink{classIpv4FragmentationTest_a006c01f850b31012c3d7794c488fa4a1}{m\_receivedPacketClient} = packet->\hyperlink{classns3_1_1Packet_a5d5c70802a5f77fc5f0001e0cfc1898b}{Copy}();
253         \}
254     \}
255 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 3




Here is the caller graph for this function\+:
% FIG 4


\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!Handle\+Read\+Icmp\+Client@{Handle\+Read\+Icmp\+Client}}
\index{Handle\+Read\+Icmp\+Client@{Handle\+Read\+Icmp\+Client}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{Handle\+Read\+Icmp\+Client(\+Ipv4\+Address icmp\+Source, uint8\+\_\+t icmp\+Ttl, uint8\+\_\+t icmp\+Type, uint8\+\_\+t icmp\+Code, uint32\+\_\+t icmp\+Info)}{HandleReadIcmpClient(Ipv4Address icmpSource, uint8_t icmpTtl, uint8_t icmpType, uint8_t icmpCode, uint32_t icmpInfo)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv4\+Fragmentation\+Test\+::\+Handle\+Read\+Icmp\+Client (
\begin{DoxyParamCaption}
\item[{{\bf Ipv4\+Address}}]{icmp\+Source, }
\item[{uint8\+\_\+t}]{icmp\+Ttl, }
\item[{uint8\+\_\+t}]{icmp\+Type, }
\item[{uint8\+\_\+t}]{icmp\+Code, }
\item[{uint32\+\_\+t}]{icmp\+Info}
\end{DoxyParamCaption}
)}\hypertarget{classIpv4FragmentationTest_a8f6da7f64518a34543b2e164a1b363a4}{}\label{classIpv4FragmentationTest_a8f6da7f64518a34543b2e164a1b363a4}


Handle incoming I\+C\+MP packets. 


\begin{DoxyParams}{Parameters}
{\em icmp\+Source} & The I\+C\+MP sender. \\
\hline
{\em icmp\+Ttl} & The I\+C\+MP T\+TL. \\
\hline
{\em icmp\+Type} & The I\+C\+MP Type. \\
\hline
{\em icmp\+Code} & The I\+C\+MP Code. \\
\hline
{\em icmp\+Info} & The I\+C\+MP Info. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
261 \{
262   \hyperlink{classIpv4FragmentationTest_a2ee305a2995a09b8b2faf2ecf700c90d}{m\_icmpType} = icmpType;
263 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 5


\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!Handle\+Read\+Server@{Handle\+Read\+Server}}
\index{Handle\+Read\+Server@{Handle\+Read\+Server}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{Handle\+Read\+Server(\+Ptr$<$ Socket $>$ socket)}{HandleReadServer(Ptr< Socket > socket)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv4\+Fragmentation\+Test\+::\+Handle\+Read\+Server (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Socket} $>$}]{socket}
\end{DoxyParamCaption}
)}\hypertarget{classIpv4FragmentationTest_ae96faa04d6aa0facdf1fbbabb1e3af01}{}\label{classIpv4FragmentationTest_ae96faa04d6aa0facdf1fbbabb1e3af01}


Handle incoming packets. 


\begin{DoxyParams}{Parameters}
{\em socket} & The receiving socket. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
214 \{
215   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} packet;
216   \hyperlink{classns3_1_1Address}{Address} \hyperlink{lte__amc_8m_a1b4c81ff74eb1a626b5ade44c81004b3}{from};
217   \textcolor{keywordflow}{while} ((packet = socket->\hyperlink{classns3_1_1Socket_af22378d7af9a2745a9eada20210da215}{RecvFrom} (from)))
218     \{
219       \textcolor{keywordflow}{if} (InetSocketAddress::IsMatchingType (from))
220         \{
221           \hyperlink{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{m\_receivedPacketServer} = packet->\hyperlink{classns3_1_1Packet_a5d5c70802a5f77fc5f0001e0cfc1898b}{Copy}();
222         \}
223     \}
224 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 6




Here is the caller graph for this function\+:
% FIG 7


\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!Send\+Client@{Send\+Client}}
\index{Send\+Client@{Send\+Client}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{Send\+Client(void)}{SendClient(void)}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<$ {\bf Packet} $>$ Ipv4\+Fragmentation\+Test\+::\+Send\+Client (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)}\hypertarget{classIpv4FragmentationTest_a3df0b70a39a1fec9205b40f47a64ab6f}{}\label{classIpv4FragmentationTest_a3df0b70a39a1fec9205b40f47a64ab6f}


Send a packet. 

\begin{DoxyReturn}{Returns}
The sent packet. 
\end{DoxyReturn}

\begin{DoxyCode}
294 \{
295   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} \hyperlink{lte__link__budget_8m_ac9de518908a968428863f829398a4e62}{p};
296   \textcolor{keywordflow}{if} (\hyperlink{classIpv4FragmentationTest_ac2d67ec7308b06170caa50497ac634a9}{m\_dataSize})
297     \{
298       p = Create<Packet> (\hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data}, \hyperlink{classIpv4FragmentationTest_ac2d67ec7308b06170caa50497ac634a9}{m\_dataSize});
299     \}
300   \textcolor{keywordflow}{else}
301     \{
302       p = Create<Packet> (\hyperlink{classIpv4FragmentationTest_a2fa502a8c06dc3e751cacbf31e687251}{m\_size});
303     \}
304   \hyperlink{classIPv4TestTag}{IPv4TestTag} tag;
305   tag.\hyperlink{classIPv4TestTag_a4af8d82a226b8d0871f37086354c1406}{SetToken} (42);
306   p->\hyperlink{classns3_1_1Packet_a7400b8655852f5271c5957250d0141af}{AddPacketTag} (tag);
307   p->\hyperlink{classns3_1_1Packet_ad5997caea8c22757acade2fcb4d7daca}{AddByteTag} (tag);
308 
309   \hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient}->\hyperlink{classns3_1_1Socket_a036901c8f485fe5b6eab93b7f2ec289d}{Send} (p);
310 
311   \textcolor{keywordflow}{return} \hyperlink{lte__link__budget_8m_ac9de518908a968428863f829398a4e62}{p};
312 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 8




Here is the caller graph for this function\+:
% FIG 9


\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!Set\+Fill@{Set\+Fill}}
\index{Set\+Fill@{Set\+Fill}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{Set\+Fill(uint8\+\_\+t $\ast$fill, uint32\+\_\+t fill\+Size, uint32\+\_\+t data\+Size)}{SetFill(uint8_t *fill, uint32_t fillSize, uint32_t dataSize)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv4\+Fragmentation\+Test\+::\+Set\+Fill (
\begin{DoxyParamCaption}
\item[{uint8\+\_\+t $\ast$}]{fill, }
\item[{uint32\+\_\+t}]{fill\+Size, }
\item[{uint32\+\_\+t}]{data\+Size}
\end{DoxyParamCaption}
)}\hypertarget{classIpv4FragmentationTest_af2de35c56cd4b51230784881bd1221a8}{}\label{classIpv4FragmentationTest_af2de35c56cd4b51230784881bd1221a8}


Set the packet fill. 


\begin{DoxyParams}{Parameters}
{\em fill} & The fill. \\
\hline
{\em fill\+Size} & The fill size. \\
\hline
{\em data\+Size} & The packet size. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
267 \{
268   \textcolor{keywordflow}{if} (dataSize != \hyperlink{classIpv4FragmentationTest_ac2d67ec7308b06170caa50497ac634a9}{m\_dataSize})
269     \{
270       \textcolor{keyword}{delete} [] \hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data};
271       \hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data} = \textcolor{keyword}{new} uint8\_t [dataSize];
272       \hyperlink{classIpv4FragmentationTest_ac2d67ec7308b06170caa50497ac634a9}{m\_dataSize} = dataSize;
273     \}
274 
275   \textcolor{keywordflow}{if} (fillSize >= dataSize)
276     \{
277       memcpy (\hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data}, fill, dataSize);
278       \textcolor{keywordflow}{return};
279     \}
280 
281   uint32\_t filled = 0;
282   \textcolor{keywordflow}{while} (filled + fillSize < dataSize)
283     \{
284       memcpy (&\hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data}[filled], fill, fillSize);
285       filled += fillSize;
286     \}
287 
288   memcpy(&\hyperlink{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{m\_data}[filled], fill, dataSize - filled);
289 
290   \hyperlink{classIpv4FragmentationTest_a2fa502a8c06dc3e751cacbf31e687251}{m\_size} = dataSize;
291 \}
\end{DoxyCode}


Here is the caller graph for this function\+:
% FIG 10


\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!Start\+Client@{Start\+Client}}
\index{Start\+Client@{Start\+Client}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{Start\+Client(\+Ptr$<$ Node $>$ Client\+Node)}{StartClient(Ptr< Node > ClientNode)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv4\+Fragmentation\+Test\+::\+Start\+Client (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Node} $>$}]{Client\+Node}
\end{DoxyParamCaption}
)}\hypertarget{classIpv4FragmentationTest_a5ce3759e72c31d2f86d6424ff0702b47}{}\label{classIpv4FragmentationTest_a5ce3759e72c31d2f86d6424ff0702b47}


Start the client. 


\begin{DoxyParams}{Parameters}
{\em Client\+Node} & The client. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
228 \{
229 
230   \textcolor{keywordflow}{if} (\hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient} == 0)
231     \{
232       \hyperlink{classns3_1_1TypeId}{TypeId} tid = TypeId::LookupByName (\textcolor{stringliteral}{"ns3::UdpSocketFactory"});
233       \hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient} = Socket::CreateSocket (ClientNode, tid);
234       \hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient}->\hyperlink{classns3_1_1Socket_ada93439a43de2028b5a8fc6621dad482}{Bind} ();
235       \hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient}->\hyperlink{classns3_1_1Socket_a97f08aaf37b8fd7d4b5cad4dfdd4022a}{Connect} (\hyperlink{classns3_1_1InetSocketAddress}{InetSocketAddress} (
      \hyperlink{classns3_1_1Ipv4Address}{Ipv4Address} (\textcolor{stringliteral}{"10.0.0.1"}), 9));
236       \hyperlink{classns3_1_1CallbackValue}{CallbackValue} cbValue = \hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback}(&
      \hyperlink{classIpv4FragmentationTest_a8f6da7f64518a34543b2e164a1b363a4}{Ipv4FragmentationTest::HandleReadIcmpClient}, \textcolor{keyword}{this});
237       \hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient}->\hyperlink{classns3_1_1ObjectBase_ac60245d3ea4123bbc9b1d391f1f6592f}{SetAttribute} (\textcolor{stringliteral}{"IcmpCallback"}, cbValue);
238     \}
239 
240   \hyperlink{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{m\_socketClient}->\hyperlink{classns3_1_1Socket_a243f7835ef1a85f9270fd3577e3a40da}{SetRecvCallback}(\hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback}(&
      \hyperlink{classIpv4FragmentationTest_ad409cf6c22b25e40f02bd59be6c8350f}{Ipv4FragmentationTest::HandleReadClient}, \textcolor{keyword}{this}));
241 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 11




Here is the caller graph for this function\+:
% FIG 12


\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!Start\+Server@{Start\+Server}}
\index{Start\+Server@{Start\+Server}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{Start\+Server(\+Ptr$<$ Node $>$ Server\+Node)}{StartServer(Ptr< Node > ServerNode)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ipv4\+Fragmentation\+Test\+::\+Start\+Server (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Node} $>$}]{Server\+Node}
\end{DoxyParamCaption}
)}\hypertarget{classIpv4FragmentationTest_a854c6040ada33b3c61c03b459d1a1d72}{}\label{classIpv4FragmentationTest_a854c6040ada33b3c61c03b459d1a1d72}


Start the server. 


\begin{DoxyParams}{Parameters}
{\em Server\+Node} & The server. \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
193 \{
194 
195   \textcolor{keywordflow}{if} (\hyperlink{classIpv4FragmentationTest_a5960ce9f8f50e1635921f941c0388f15}{m\_socketServer} == 0)
196     \{
197       \hyperlink{classns3_1_1TypeId}{TypeId} tid = TypeId::LookupByName (\textcolor{stringliteral}{"ns3::UdpSocketFactory"});
198       \hyperlink{classIpv4FragmentationTest_a5960ce9f8f50e1635921f941c0388f15}{m\_socketServer} = Socket::CreateSocket (ServerNode, tid);
199       \hyperlink{classns3_1_1InetSocketAddress}{InetSocketAddress} local = \hyperlink{classns3_1_1InetSocketAddress}{InetSocketAddress} (Ipv4Address::GetAny ()
      , 9);
200       \hyperlink{classIpv4FragmentationTest_a5960ce9f8f50e1635921f941c0388f15}{m\_socketServer}->\hyperlink{classns3_1_1Socket_ada93439a43de2028b5a8fc6621dad482}{Bind} (local);
201       \hyperlink{classns3_1_1Ptr}{Ptr<UdpSocket>} udpSocket = DynamicCast<UdpSocket> (
      \hyperlink{classIpv4FragmentationTest_a5960ce9f8f50e1635921f941c0388f15}{m\_socketServer});
202       \textcolor{keywordflow}{if} (udpSocket)
203         \{
204           \textcolor{comment}{// equivalent to setsockopt (MCAST\_JOIN\_GROUP)}
205           udpSocket->\hyperlink{classns3_1_1UdpSocket_a3aa48fac00edf4dbd519a6fc7644f0b7}{MulticastJoinGroup} (0, \hyperlink{classns3_1_1Ipv4Address}{Ipv4Address} (\textcolor{stringliteral}{"10.0.0.1"}));
206         \}
207    \}
208 
209   \hyperlink{classIpv4FragmentationTest_a5960ce9f8f50e1635921f941c0388f15}{m\_socketServer}->\hyperlink{classns3_1_1Socket_a243f7835ef1a85f9270fd3577e3a40da}{SetRecvCallback}(\hyperlink{group__makecallbackmemptr_ga9376283685aa99d204048d6a4b7610a4}{MakeCallback}(&
      \hyperlink{classIpv4FragmentationTest_ae96faa04d6aa0facdf1fbbabb1e3af01}{Ipv4FragmentationTest::HandleReadServer}, \textcolor{keyword}{this}));
210 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 13




Here is the caller graph for this function\+:
% FIG 14




\subsection{Member Data Documentation}
\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!m\+\_\+data@{m\+\_\+data}}
\index{m\+\_\+data@{m\+\_\+data}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+data}{m_data}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t$\ast$ Ipv4\+Fragmentation\+Test\+::m\+\_\+data\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}{}\label{classIpv4FragmentationTest_a0560883722435de42b7fcb188ef29586}


Data. 

\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!m\+\_\+data\+Size@{m\+\_\+data\+Size}}
\index{m\+\_\+data\+Size@{m\+\_\+data\+Size}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+data\+Size}{m_dataSize}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t Ipv4\+Fragmentation\+Test\+::m\+\_\+data\+Size\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4FragmentationTest_ac2d67ec7308b06170caa50497ac634a9}{}\label{classIpv4FragmentationTest_ac2d67ec7308b06170caa50497ac634a9}


Data size. 

\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!m\+\_\+icmp\+Type@{m\+\_\+icmp\+Type}}
\index{m\+\_\+icmp\+Type@{m\+\_\+icmp\+Type}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+icmp\+Type}{m_icmpType}}]{\setlength{\rightskip}{0pt plus 5cm}uint8\+\_\+t Ipv4\+Fragmentation\+Test\+::m\+\_\+icmp\+Type\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4FragmentationTest_a2ee305a2995a09b8b2faf2ecf700c90d}{}\label{classIpv4FragmentationTest_a2ee305a2995a09b8b2faf2ecf700c90d}


I\+C\+MP type. 

\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!m\+\_\+received\+Packet\+Client@{m\+\_\+received\+Packet\+Client}}
\index{m\+\_\+received\+Packet\+Client@{m\+\_\+received\+Packet\+Client}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+received\+Packet\+Client}{m_receivedPacketClient}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Packet}$>$ Ipv4\+Fragmentation\+Test\+::m\+\_\+received\+Packet\+Client\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4FragmentationTest_a006c01f850b31012c3d7794c488fa4a1}{}\label{classIpv4FragmentationTest_a006c01f850b31012c3d7794c488fa4a1}


Packet received by client. 

\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!m\+\_\+received\+Packet\+Server@{m\+\_\+received\+Packet\+Server}}
\index{m\+\_\+received\+Packet\+Server@{m\+\_\+received\+Packet\+Server}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+received\+Packet\+Server}{m_receivedPacketServer}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Packet}$>$ Ipv4\+Fragmentation\+Test\+::m\+\_\+received\+Packet\+Server\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}{}\label{classIpv4FragmentationTest_a1cda7da1e37a2413ce73e54a395ecf4a}


Packet received by server. 

\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!m\+\_\+sent\+Packet\+Client@{m\+\_\+sent\+Packet\+Client}}
\index{m\+\_\+sent\+Packet\+Client@{m\+\_\+sent\+Packet\+Client}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+sent\+Packet\+Client}{m_sentPacketClient}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Packet}$>$ Ipv4\+Fragmentation\+Test\+::m\+\_\+sent\+Packet\+Client\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4FragmentationTest_a2101eb6eb2f3da7f4ba981a08fbf84e0}{}\label{classIpv4FragmentationTest_a2101eb6eb2f3da7f4ba981a08fbf84e0}


Packet sent by client. 

\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!m\+\_\+size@{m\+\_\+size}}
\index{m\+\_\+size@{m\+\_\+size}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+size}{m_size}}]{\setlength{\rightskip}{0pt plus 5cm}uint32\+\_\+t Ipv4\+Fragmentation\+Test\+::m\+\_\+size\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4FragmentationTest_a2fa502a8c06dc3e751cacbf31e687251}{}\label{classIpv4FragmentationTest_a2fa502a8c06dc3e751cacbf31e687251}


packet size. 

\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!m\+\_\+socket\+Client@{m\+\_\+socket\+Client}}
\index{m\+\_\+socket\+Client@{m\+\_\+socket\+Client}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+socket\+Client}{m_socketClient}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Socket}$>$ Ipv4\+Fragmentation\+Test\+::m\+\_\+socket\+Client\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}{}\label{classIpv4FragmentationTest_a75297f7fa134ce427f34f866c4372877}


Client socket. 

\index{Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}!m\+\_\+socket\+Server@{m\+\_\+socket\+Server}}
\index{m\+\_\+socket\+Server@{m\+\_\+socket\+Server}!Ipv4\+Fragmentation\+Test@{Ipv4\+Fragmentation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+socket\+Server}{m_socketServer}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Socket}$>$ Ipv4\+Fragmentation\+Test\+::m\+\_\+socket\+Server\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classIpv4FragmentationTest_a5960ce9f8f50e1635921f941c0388f15}{}\label{classIpv4FragmentationTest_a5960ce9f8f50e1635921f941c0388f15}


Server socket. 



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
internet/test/\hyperlink{ipv4-fragmentation-test_8cc}{ipv4-\/fragmentation-\/test.\+cc}\end{DoxyCompactItemize}
