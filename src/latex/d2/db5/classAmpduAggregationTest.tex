\hypertarget{classAmpduAggregationTest}{}\section{Ampdu\+Aggregation\+Test Class Reference}
\label{classAmpduAggregationTest}\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}


Ampdu Aggregation Test.  




Inheritance diagram for Ampdu\+Aggregation\+Test\+:
% FIG 0


Collaboration diagram for Ampdu\+Aggregation\+Test\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classAmpduAggregationTest_a33d6ed639cf5e1bbcf0c4e3dd8f1079e}{Ampdu\+Aggregation\+Test} ()
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void \hyperlink{classAmpduAggregationTest_a7414dc8d4dd982ab4c1eaadb5b2c693d}{Do\+Run} (void)
\begin{DoxyCompactList}\small\item\em Implementation to actually run this Test\+Case. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1MacLow}{Mac\+Low} $>$ \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\+\_\+low}
\begin{DoxyCompactList}\small\item\em Mac\+Low. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1YansWifiPhy}{Yans\+Wifi\+Phy} $>$ \hyperlink{classAmpduAggregationTest_a220a24ff11749ab912f7c13b50132b5c}{m\+\_\+phy}
\begin{DoxyCompactList}\small\item\em Phy. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1EdcaTxopN}{Edca\+TxopN} $>$ \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\+\_\+edca}
\begin{DoxyCompactList}\small\item\em E\+D\+CA. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1MacTxMiddle}{Mac\+Tx\+Middle} $\ast$ \hyperlink{classAmpduAggregationTest_a69145cfecbe5625743bb6165b99e5069}{m\+\_\+tx\+Middle}
\begin{DoxyCompactList}\small\item\em Mac\+Tx\+Middle. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1WifiRemoteStationManager}{Wifi\+Remote\+Station\+Manager} $>$ \hyperlink{classAmpduAggregationTest_abd162c86cd5eb8e4146bcacd20ccc312}{m\+\_\+manager}
\begin{DoxyCompactList}\small\item\em remote station manager \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1ObjectFactory}{Object\+Factory} \hyperlink{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}{m\+\_\+factory}
\begin{DoxyCompactList}\small\item\em factory \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1MpduAggregator}{Mpdu\+Aggregator} $>$ \hyperlink{classAmpduAggregationTest_aa98ac82d3471dd1133359921810bf284}{m\+\_\+mpdu\+Aggregator}
\begin{DoxyCompactList}\small\item\em A-\/\+M\+P\+DU aggregrator. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1DcfManager}{Dcf\+Manager} $\ast$ \hyperlink{classAmpduAggregationTest_ab4228ccddddc9bc922b9eca47cf90054}{m\+\_\+dcf\+Manager}
\begin{DoxyCompactList}\small\item\em D\+CF manager. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
Ampdu Aggregation Test. 

\subsection{Constructor \& Destructor Documentation}
\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\subsubsection[{\texorpdfstring{Ampdu\+Aggregation\+Test()}{AmpduAggregationTest()}}]{\setlength{\rightskip}{0pt plus 5cm}Ampdu\+Aggregation\+Test\+::\+Ampdu\+Aggregation\+Test (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classAmpduAggregationTest_a33d6ed639cf5e1bbcf0c4e3dd8f1079e}{}\label{classAmpduAggregationTest_a33d6ed639cf5e1bbcf0c4e3dd8f1079e}

\begin{DoxyCode}
59   : \hyperlink{classns3_1_1TestCase_a3b0b91a96aac1933e8d146e019b9e207}{TestCase} (\textcolor{stringliteral}{"Check the correctness of MPDU aggregation operations"})
60 \{
61 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!Do\+Run@{Do\+Run}}
\index{Do\+Run@{Do\+Run}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\subsubsection[{\texorpdfstring{Do\+Run(void)}{DoRun(void)}}]{\setlength{\rightskip}{0pt plus 5cm}void Ampdu\+Aggregation\+Test\+::\+Do\+Run (
\begin{DoxyParamCaption}
\item[{void}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [virtual]}}\hypertarget{classAmpduAggregationTest_a7414dc8d4dd982ab4c1eaadb5b2c693d}{}\label{classAmpduAggregationTest_a7414dc8d4dd982ab4c1eaadb5b2c693d}


Implementation to actually run this Test\+Case. 

Subclasses should override this method to conduct their tests. 

Implements \hyperlink{classns3_1_1TestCase_a8ff74680cf017ed42011e4be51917a24}{ns3\+::\+Test\+Case}.


\begin{DoxyCode}
65 \{
66   \textcolor{comment}{/*}
67 \textcolor{comment}{   * Create and configure phy layer.}
68 \textcolor{comment}{   */}
69   \hyperlink{classAmpduAggregationTest_a220a24ff11749ab912f7c13b50132b5c}{m\_phy} = CreateObject<YansWifiPhy> ();
70   \hyperlink{classAmpduAggregationTest_a220a24ff11749ab912f7c13b50132b5c}{m\_phy}->\hyperlink{classns3_1_1WifiPhy_aeafbea9bd8c1ae20f85584f55d868d23}{ConfigureStandard} (\hyperlink{group__wifi_gga1299834f4e1c615af3ca738033b76a49aaabe94a0be4668583c42595437b4a6c0}{WIFI\_PHY\_STANDARD\_80211n\_5GHZ}
      );
71 
72   \textcolor{comment}{/*}
73 \textcolor{comment}{   * Create and configure manager.}
74 \textcolor{comment}{   */}
75   \hyperlink{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}{m\_factory} = \hyperlink{classns3_1_1ObjectFactory}{ObjectFactory} ();
76   \hyperlink{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}{m\_factory}.\hyperlink{classns3_1_1ObjectFactory_a77dcd099064038a1eb7a6b8251229ec3}{SetTypeId} (\textcolor{stringliteral}{"ns3::ConstantRateWifiManager"});
77   \hyperlink{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}{m\_factory}.\hyperlink{classns3_1_1ObjectFactory_aef5c0d5019c96bdf01cefd1ff83f4a68}{Set} (\textcolor{stringliteral}{"DataMode"}, StringValue (\textcolor{stringliteral}{"HtMcs7"}));
78   \hyperlink{classAmpduAggregationTest_abd162c86cd5eb8e4146bcacd20ccc312}{m\_manager} = \hyperlink{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}{m\_factory}.\hyperlink{classns3_1_1ObjectFactory_a18152e93f0a6fe184ed7300cb31e9896}{Create}<\hyperlink{classns3_1_1WifiRemoteStationManager}{WifiRemoteStationManager}> ()
      ;
79   \hyperlink{classAmpduAggregationTest_abd162c86cd5eb8e4146bcacd20ccc312}{m\_manager}->\hyperlink{classns3_1_1WifiRemoteStationManager_a823deffface82c9fe1daa06ce11c585b}{SetupPhy} (\hyperlink{classAmpduAggregationTest_a220a24ff11749ab912f7c13b50132b5c}{m\_phy});
80   \hyperlink{classAmpduAggregationTest_abd162c86cd5eb8e4146bcacd20ccc312}{m\_manager}->\hyperlink{classns3_1_1WifiRemoteStationManager_a9078e641b9b16f237974d07d37d88af9}{SetHtSupported} (\textcolor{keyword}{true});
81 
82   \textcolor{comment}{/*}
83 \textcolor{comment}{   * Create and configure mac layer.}
84 \textcolor{comment}{   */}
85   \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low} = CreateObject<MacLow> ();
86   \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a1f2c6e12277422c081fa92f8edfe66e8}{SetPhy} (\hyperlink{classAmpduAggregationTest_a220a24ff11749ab912f7c13b50132b5c}{m\_phy});
87   \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a8151fd0fa31a7034f86aa65b3e4973fa}{SetWifiRemoteStationManager} (\hyperlink{classAmpduAggregationTest_abd162c86cd5eb8e4146bcacd20ccc312}{m\_manager});
88   \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a399290b378df4e041b9c4f7cc7b9b465}{SetAddress} (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:01"}));
89 
90   \hyperlink{classAmpduAggregationTest_ab4228ccddddc9bc922b9eca47cf90054}{m\_dcfManager} = \textcolor{keyword}{new} \hyperlink{classns3_1_1DcfManager}{DcfManager} ();
91   \hyperlink{classAmpduAggregationTest_ab4228ccddddc9bc922b9eca47cf90054}{m\_dcfManager}->\hyperlink{classns3_1_1DcfManager_af744fc49f79b89475ae47004962bc989}{SetupLow} (\hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low});
92   \hyperlink{classAmpduAggregationTest_ab4228ccddddc9bc922b9eca47cf90054}{m\_dcfManager}->\hyperlink{classns3_1_1DcfManager_aba35d453c3c37ce143a8a728be5034c9}{SetupPhyListener} (\hyperlink{classAmpduAggregationTest_a220a24ff11749ab912f7c13b50132b5c}{m\_phy});
93   \hyperlink{classAmpduAggregationTest_ab4228ccddddc9bc922b9eca47cf90054}{m\_dcfManager}->\hyperlink{classns3_1_1DcfManager_a9e0041c0547840e3c0eab18420b27af1}{SetSlot} (\hyperlink{group__timecivil_ga17465a639c8d1464e76538afdd78a9f0}{MicroSeconds} (9));
94 
95   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca} = CreateObject<EdcaTxopN> ();
96   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_a297ac12852a5e6854e4068b2767f767d}{SetLow} (\hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low});
97   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1EdcaTxopN_ae7203b449d7865a1730fdc7006090b83}{SetAccessCategory} (\hyperlink{group__wifi_ggab422b4562ba272b39a9b6bca3513f3aca136016fc12611734060b599355503c29}{AC\_BE});
98   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1EdcaTxopN_a970b9c67fab2744466283724064cc6fa}{SetWifiRemoteStationManager} (
      \hyperlink{classAmpduAggregationTest_abd162c86cd5eb8e4146bcacd20ccc312}{m\_manager});
99   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_ae13ebd282b7d27b43722becc5789be65}{SetManager} (\hyperlink{classAmpduAggregationTest_ab4228ccddddc9bc922b9eca47cf90054}{m\_dcfManager});
100 
101   \hyperlink{classAmpduAggregationTest_a69145cfecbe5625743bb6165b99e5069}{m\_txMiddle} = \textcolor{keyword}{new} \hyperlink{classns3_1_1MacTxMiddle}{MacTxMiddle} ();
102   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_a45964693593c510b735b4ec190157b9a}{SetTxMiddle} (\hyperlink{classAmpduAggregationTest_a69145cfecbe5625743bb6165b99e5069}{m\_txMiddle});
103   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1EdcaTxopN_aeca53fddb95468e9e56ee452adf8b263}{CompleteConfig} ();
104 
105   \textcolor{comment}{/*}
106 \textcolor{comment}{   * Configure MPDU aggregation.}
107 \textcolor{comment}{   */}
108   \hyperlink{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}{m\_factory} = \hyperlink{classns3_1_1ObjectFactory}{ObjectFactory} ();
109   \hyperlink{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}{m\_factory}.\hyperlink{classns3_1_1ObjectFactory_a77dcd099064038a1eb7a6b8251229ec3}{SetTypeId} (\textcolor{stringliteral}{"ns3::MpduStandardAggregator"});
110   \hyperlink{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}{m\_factory}.\hyperlink{classns3_1_1ObjectFactory_aef5c0d5019c96bdf01cefd1ff83f4a68}{Set} (\textcolor{stringliteral}{"MaxAmpduSize"}, UintegerValue (65535));
111   \hyperlink{classAmpduAggregationTest_aa98ac82d3471dd1133359921810bf284}{m\_mpduAggregator} = \hyperlink{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}{m\_factory}.\hyperlink{classns3_1_1ObjectFactory_a18152e93f0a6fe184ed7300cb31e9896}{Create}<
      \hyperlink{classns3_1_1MpduAggregator}{MpduAggregator}> ();
112   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1EdcaTxopN_a7e7515c14b633de6c10087f02864b793}{SetMpduAggregator} (\hyperlink{classAmpduAggregationTest_aa98ac82d3471dd1133359921810bf284}{m\_mpduAggregator});
113 
114   \textcolor{comment}{/*}
115 \textcolor{comment}{   * Create a dummy packet of 1500 bytes and fill mac header fields.}
116 \textcolor{comment}{   */}
117   \hyperlink{classns3_1_1Ptr}{Ptr<const Packet>} pkt = Create<Packet> (1500);
118   \hyperlink{classns3_1_1Ptr}{Ptr<Packet>} currentAggregatedPacket = Create<Packet> ();
119   \hyperlink{classns3_1_1WifiMacHeader}{WifiMacHeader} hdr;
120   hdr.\hyperlink{classns3_1_1WifiMacHeader_a6478a02b80d5c01657714c5c7a0ae1cb}{SetAddr1} (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:02"}));
121   hdr.SetAddr2 (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:01"}));
122   hdr.SetType (\hyperlink{namespacens3_a9318472db39b35b2092de5c721e6ab0aafd37aea1ac3edba5410fac6367b19b1d}{WIFI\_MAC\_QOSDATA});
123   hdr.SetQosTid (0);
124   uint16\_t sequence = \hyperlink{classAmpduAggregationTest_a69145cfecbe5625743bb6165b99e5069}{m\_txMiddle}->\hyperlink{classns3_1_1MacTxMiddle_a791d277bf45e2b45b57b2fdb9417cc25}{GetNextSequenceNumberFor} (&hdr);
125   hdr.SetSequenceNumber (sequence);
126   hdr.SetFragmentNumber (0);
127   hdr.SetNoMoreFragments ();
128   hdr.SetNoRetry ();
129 
130   \textcolor{comment}{/*}
131 \textcolor{comment}{   * Establish agreement.}
132 \textcolor{comment}{   */}
133   \hyperlink{classns3_1_1MgtAddBaRequestHeader}{MgtAddBaRequestHeader} reqHdr;
134   reqHdr.\hyperlink{classns3_1_1MgtAddBaRequestHeader_a6c500c2af17b44cead2c9449ed35bc5f}{SetImmediateBlockAck} ();
135   reqHdr.\hyperlink{classns3_1_1MgtAddBaRequestHeader_af21456709bd3e8a7574eda1627115eb9}{SetTid} (0);
136   reqHdr.\hyperlink{classns3_1_1MgtAddBaRequestHeader_a480af17ddad3bf04f0adee28bccd2ef5}{SetBufferSize} (0);
137   reqHdr.\hyperlink{classns3_1_1MgtAddBaRequestHeader_aeb99891a5d0299f49a027a346173f9b3}{SetTimeout} (0);
138   reqHdr.\hyperlink{classns3_1_1MgtAddBaRequestHeader_af88f102a8becfc3e0202c4dfb969a05f}{SetStartingSequence} (0);
139   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1EdcaTxopN_a7a79eaafe03995bb274451aa752b83b2}{m\_baManager}->\hyperlink{classns3_1_1BlockAckManager_a44483ff8e6011faf1190dc0f178e66b7}{CreateAgreement} (&reqHdr, hdr.GetAddr1 ());
140 
141   \textcolor{comment}{//-----------------------------------------------------------------------------------------------------}
142 
143   \textcolor{comment}{/*}
144 \textcolor{comment}{   * Test behavior when no other packets are in the queue}
145 \textcolor{comment}{   */}
146   \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_aec9902bc8026338baf261d2de8fcd83b}{m\_currentHdr} = hdr;
147   \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_aa4f81bb523ceed1bbf5a84851b25e29c}{m\_currentPacket} = pkt->\hyperlink{classns3_1_1Packet_a5d5c70802a5f77fc5f0001e0cfc1898b}{Copy} ();
148   \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_af87bd81ded4d362f9f1dc89dbbee65a3}{m\_currentTxVector} = \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a04bad04eade9ff1de0940b01c5bcf514}{GetDataTxVector} (
      \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_aa4f81bb523ceed1bbf5a84851b25e29c}{m\_currentPacket}, &\hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_aec9902bc8026338baf261d2de8fcd83b}{m\_currentHdr});
149 
150   \textcolor{keywordtype}{bool} isAmpdu = \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a228f675a7db0df0e39edb611167861cc}{IsAmpdu} (pkt, hdr);
151   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (isAmpdu, \textcolor{keyword}{false}, \textcolor{stringliteral}{"a single packet should not result in an
       A-MPDU"});
152   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (\hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a50ea30f5dff00a3ef2683b9275717c6f}{m\_aggregateQueue}[0]->GetNPackets 
      (), 0, \textcolor{stringliteral}{"aggregation queue is not flushed"});
153 
154   \textcolor{comment}{//-----------------------------------------------------------------------------------------------------}
155 
156   \textcolor{comment}{/*}
157 \textcolor{comment}{   * Test behavior when 2 more packets are in the queue}
158 \textcolor{comment}{   */}
159   \hyperlink{classns3_1_1Ptr}{Ptr<const Packet>} pkt1 = Create<Packet> (1500);
160   \hyperlink{classns3_1_1Ptr}{Ptr<const Packet>} pkt2 = Create<Packet> (1500);
161   \hyperlink{classns3_1_1WifiMacHeader}{WifiMacHeader} hdr1, hdr2;
162 
163   hdr1.\hyperlink{classns3_1_1WifiMacHeader_a6478a02b80d5c01657714c5c7a0ae1cb}{SetAddr1} (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:02"}));
164   hdr1.SetAddr2 (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:01"}));
165   hdr1.SetType (\hyperlink{namespacens3_a9318472db39b35b2092de5c721e6ab0aafd37aea1ac3edba5410fac6367b19b1d}{WIFI\_MAC\_QOSDATA});
166   hdr1.SetQosTid (0);
167 
168   hdr2.SetAddr1 (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:02"}));
169   hdr2.SetAddr2 (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:01"}));
170   hdr2.SetType (\hyperlink{namespacens3_a9318472db39b35b2092de5c721e6ab0aafd37aea1ac3edba5410fac6367b19b1d}{WIFI\_MAC\_QOSDATA});
171   hdr2.SetQosTid (0);
172 
173   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_a6c89d0aeccbc5e8724d404bc45f796d7}{GetQueue} ()->Enqueue (Create<WifiMacQueueItem> (pkt1, hdr1));
174   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_a6c89d0aeccbc5e8724d404bc45f796d7}{GetQueue} ()->Enqueue (Create<WifiMacQueueItem> (pkt2, hdr2));
175 
176   isAmpdu = \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a228f675a7db0df0e39edb611167861cc}{IsAmpdu} (pkt, hdr);
177   uint32\_t aggregationQueueSize = \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a50ea30f5dff00a3ef2683b9275717c6f}{m\_aggregateQueue}[0]->GetNPackets ();
178   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (isAmpdu, \textcolor{keyword}{true}, \textcolor{stringliteral}{"MPDU aggregation failed"});
179   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (\hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_aa4f81bb523ceed1bbf5a84851b25e29c}{m\_currentPacket}->
      \hyperlink{classns3_1_1Packet_a462855c9929954d4301a4edfe55f4f1c}{GetSize} (), 4606, \textcolor{stringliteral}{"A-MPDU size is not correct"});
180   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (aggregationQueueSize, 3, \textcolor{stringliteral}{"aggregation queue should not be
       empty"});
181   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (\hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_a6c89d0aeccbc5e8724d404bc45f796d7}{GetQueue} ()->GetNPackets (), 0, \textcolor{stringliteral}{"queue
       should be empty"});
182 
183   \hyperlink{classns3_1_1Ptr}{Ptr <WifiMacQueueItem>} dequeuedItem;
184   \hyperlink{classns3_1_1WifiMacHeader}{WifiMacHeader} dequeuedHdr;
185   uint32\_t \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i} = 0;
186   \textcolor{keywordflow}{for} (; aggregationQueueSize > 0; aggregationQueueSize--, i++)
187     \{
188       dequeuedItem = \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a50ea30f5dff00a3ef2683b9275717c6f}{m\_aggregateQueue}[0]->Dequeue ();
189       dequeuedHdr = dequeuedItem->GetHeader ();
190       \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (dequeuedHdr.\hyperlink{classns3_1_1WifiMacHeader_aa202a29c2d6aebe9b3d589e58cbd17bb}{GetSequenceNumber} (), 
      \hyperlink{bernuolliDistribution_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}, \textcolor{stringliteral}{"wrong sequence number"});
191     \}
192   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (aggregationQueueSize, 0, \textcolor{stringliteral}{"aggregation queue should be empty"})
      ;
193 
194   \textcolor{comment}{//-----------------------------------------------------------------------------------------------------}
195 
196   \textcolor{comment}{/*}
197 \textcolor{comment}{   * Test behavior when the 802.11n station and another non-QoS station are associated to the AP.}
198 \textcolor{comment}{   * The AP sends an A-MPDU to the 802.11n station followed by the last retransmission of a non-QoS data
       frame to the non-QoS station.}
199 \textcolor{comment}{   * This is used to reproduce bug 2224.}
200 \textcolor{comment}{   */}
201   pkt1 = Create<Packet> (1500);
202   pkt2 = Create<Packet> (1500);
203   hdr1.SetAddr1 (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:02"}));
204   hdr1.SetAddr2 (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:01"}));
205   hdr1.SetType (\hyperlink{namespacens3_a9318472db39b35b2092de5c721e6ab0aafd37aea1ac3edba5410fac6367b19b1d}{WIFI\_MAC\_QOSDATA});
206   hdr1.SetQosTid (0);
207   hdr1.SetSequenceNumber (3);
208   hdr2.SetAddr1 (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:03"}));
209   hdr2.SetAddr2 (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:01"}));
210   hdr2.SetType (\hyperlink{namespacens3_a9318472db39b35b2092de5c721e6ab0aaf7067a476d424f297c26441fa1a515df}{WIFI\_MAC\_DATA});
211   hdr2.SetQosTid (0);
212 
213   \hyperlink{classns3_1_1Ptr}{Ptr<const Packet>} pkt3 = Create<Packet> (1500);
214   \hyperlink{classns3_1_1WifiMacHeader}{WifiMacHeader} hdr3;
215   hdr3.\hyperlink{classns3_1_1WifiMacHeader_a51634924960a25606596916eabdcc12e}{SetSequenceNumber} (0);
216   hdr3.SetAddr1 (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:03"}));
217   hdr3.SetAddr2 (\hyperlink{classns3_1_1Mac48Address}{Mac48Address} (\textcolor{stringliteral}{"00:00:00:00:00:01"}));
218   hdr3.SetType (\hyperlink{namespacens3_a9318472db39b35b2092de5c721e6ab0aaf7067a476d424f297c26441fa1a515df}{WIFI\_MAC\_DATA});
219   hdr3.SetQosTid (0);
220 
221   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_a6c89d0aeccbc5e8724d404bc45f796d7}{GetQueue} ()->Enqueue (Create<WifiMacQueueItem> (pkt3, hdr3));
222 
223   isAmpdu = \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a228f675a7db0df0e39edb611167861cc}{IsAmpdu} (pkt1, hdr1);
224   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (isAmpdu, \textcolor{keyword}{false}, \textcolor{stringliteral}{"a single packet for this destination should
       not result in an A-MPDU"});
225   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (\hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a50ea30f5dff00a3ef2683b9275717c6f}{m\_aggregateQueue}[0]->GetNPackets 
      (), 0, \textcolor{stringliteral}{"aggregation queue is not flushed"});
226 
227   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_ae965eb2f4d504e00526e751cd1dab3a6}{m\_currentHdr} = hdr2;
228   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_a3c454c21337aac0944f86caad8b7a719}{m\_currentPacket} = pkt2->Copy ();
229   isAmpdu = \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a228f675a7db0df0e39edb611167861cc}{IsAmpdu} (pkt2, hdr2);
230   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (isAmpdu, \textcolor{keyword}{false}, \textcolor{stringliteral}{"no MPDU aggregation should be performed if
       there is no agreement"});
231   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (\hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1MacLow_a50ea30f5dff00a3ef2683b9275717c6f}{m\_aggregateQueue}[0]->GetNPackets 
      (), 0, \textcolor{stringliteral}{"aggregation queue is not flushed"});
232 
233   \hyperlink{classAmpduAggregationTest_abd162c86cd5eb8e4146bcacd20ccc312}{m\_manager}->\hyperlink{classns3_1_1WifiRemoteStationManager_af9bf74dff1a083929967fd324d17c4c0}{SetMaxSlrc} (0); \textcolor{comment}{//set to 0 in order to fake that the maximum number of
       retries has been reached}
234   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1EdcaTxopN_ad16ece50ac2937e5cdfeae010d4b5c88}{MissedAck} ();
235 
236   \hyperlink{group__testing_ga7304ba46a28d8cf08dfdfd6499cf7068}{NS\_TEST\_EXPECT\_MSG\_EQ} (\hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_a3c454c21337aac0944f86caad8b7a719}{m\_currentPacket}, 0, \textcolor{stringliteral}{"packet
       should be discarded"});
237   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1DcaTxop_a6c89d0aeccbc5e8724d404bc45f796d7}{GetQueue} ()->Remove (pkt3);
238 
239   Simulator::Destroy ();
240 
241   \textcolor{keyword}{delete} \hyperlink{classAmpduAggregationTest_a69145cfecbe5625743bb6165b99e5069}{m\_txMiddle};
242 
243   \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low}->\hyperlink{classns3_1_1Object_aa90ae598863f6c251cdab3c3722afdaf}{Dispose} ();
244   \hyperlink{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{m\_low} = 0;
245 
246   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca}->\hyperlink{classns3_1_1Object_aa90ae598863f6c251cdab3c3722afdaf}{Dispose} ();
247   \hyperlink{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{m\_edca} = 0;
248 
249   \textcolor{keyword}{delete} \hyperlink{classAmpduAggregationTest_ab4228ccddddc9bc922b9eca47cf90054}{m\_dcfManager};
250 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2




\subsection{Member Data Documentation}
\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!m\+\_\+dcf\+Manager@{m\+\_\+dcf\+Manager}}
\index{m\+\_\+dcf\+Manager@{m\+\_\+dcf\+Manager}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+dcf\+Manager}{m_dcfManager}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Dcf\+Manager}$\ast$ Ampdu\+Aggregation\+Test\+::m\+\_\+dcf\+Manager\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classAmpduAggregationTest_ab4228ccddddc9bc922b9eca47cf90054}{}\label{classAmpduAggregationTest_ab4228ccddddc9bc922b9eca47cf90054}


D\+CF manager. 

\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!m\+\_\+edca@{m\+\_\+edca}}
\index{m\+\_\+edca@{m\+\_\+edca}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+edca}{m_edca}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Edca\+TxopN}$>$ Ampdu\+Aggregation\+Test\+::m\+\_\+edca\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}{}\label{classAmpduAggregationTest_aa073b38b49ac92944de917cd25fe46f4}


E\+D\+CA. 

\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!m\+\_\+factory@{m\+\_\+factory}}
\index{m\+\_\+factory@{m\+\_\+factory}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+factory}{m_factory}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Object\+Factory} Ampdu\+Aggregation\+Test\+::m\+\_\+factory\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}{}\label{classAmpduAggregationTest_a3efaaca4bf81a378cb170add8bf52b26}


factory 

\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!m\+\_\+low@{m\+\_\+low}}
\index{m\+\_\+low@{m\+\_\+low}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+low}{m_low}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Mac\+Low}$>$ Ampdu\+Aggregation\+Test\+::m\+\_\+low\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}{}\label{classAmpduAggregationTest_a65f2d8fbd8b46a92ace2c371d2a091d9}


Mac\+Low. 

\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!m\+\_\+manager@{m\+\_\+manager}}
\index{m\+\_\+manager@{m\+\_\+manager}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+manager}{m_manager}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Wifi\+Remote\+Station\+Manager}$>$ Ampdu\+Aggregation\+Test\+::m\+\_\+manager\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classAmpduAggregationTest_abd162c86cd5eb8e4146bcacd20ccc312}{}\label{classAmpduAggregationTest_abd162c86cd5eb8e4146bcacd20ccc312}


remote station manager 

\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!m\+\_\+mpdu\+Aggregator@{m\+\_\+mpdu\+Aggregator}}
\index{m\+\_\+mpdu\+Aggregator@{m\+\_\+mpdu\+Aggregator}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+mpdu\+Aggregator}{m_mpduAggregator}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Mpdu\+Aggregator}$>$ Ampdu\+Aggregation\+Test\+::m\+\_\+mpdu\+Aggregator\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classAmpduAggregationTest_aa98ac82d3471dd1133359921810bf284}{}\label{classAmpduAggregationTest_aa98ac82d3471dd1133359921810bf284}


A-\/\+M\+P\+DU aggregrator. 

\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!m\+\_\+phy@{m\+\_\+phy}}
\index{m\+\_\+phy@{m\+\_\+phy}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+phy}{m_phy}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<${\bf Yans\+Wifi\+Phy}$>$ Ampdu\+Aggregation\+Test\+::m\+\_\+phy\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classAmpduAggregationTest_a220a24ff11749ab912f7c13b50132b5c}{}\label{classAmpduAggregationTest_a220a24ff11749ab912f7c13b50132b5c}


Phy. 

\index{Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}!m\+\_\+tx\+Middle@{m\+\_\+tx\+Middle}}
\index{m\+\_\+tx\+Middle@{m\+\_\+tx\+Middle}!Ampdu\+Aggregation\+Test@{Ampdu\+Aggregation\+Test}}
\subsubsection[{\texorpdfstring{m\+\_\+tx\+Middle}{m_txMiddle}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Mac\+Tx\+Middle}$\ast$ Ampdu\+Aggregation\+Test\+::m\+\_\+tx\+Middle\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classAmpduAggregationTest_a69145cfecbe5625743bb6165b99e5069}{}\label{classAmpduAggregationTest_a69145cfecbe5625743bb6165b99e5069}


Mac\+Tx\+Middle. 



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
wifi/test/\hyperlink{wifi-aggregation-test_8cc}{wifi-\/aggregation-\/test.\+cc}\end{DoxyCompactItemize}
