\hypertarget{classns3_1_1Ipv4L3Protocol_1_1Fragments}{}\section{ns3\+:\+:Ipv4\+L3\+Protocol\+:\+:Fragments Class Reference}
\label{classns3_1_1Ipv4L3Protocol_1_1Fragments}\index{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}}


A Set of Fragment belonging to the same packet (src, dst, identification and proto)  




Inheritance diagram for ns3\+:\+:Ipv4\+L3\+Protocol\+:\+:Fragments\+:
% FIG 0


Collaboration diagram for ns3\+:\+:Ipv4\+L3\+Protocol\+:\+:Fragments\+:
% FIG 1
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_ab8123ff39d71b4309255b426fbca630a}{Fragments} ()
\begin{DoxyCompactList}\small\item\em Constructor. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a76f7acceb0c1e77fdd5dcf401ac02b8e}{$\sim$\+Fragments} ()
\begin{DoxyCompactList}\small\item\em Destructor. \end{DoxyCompactList}\item 
void \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5d56e329da3a9f48e0300cec26ae37e8}{Add\+Fragment} (\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ fragment, uint16\+\_\+t fragment\+Offset, bool more\+Fragment)
\begin{DoxyCompactList}\small\item\em Add a fragment. \end{DoxyCompactList}\item 
bool \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a6373fdd57dfcb84b6954b00948fc9277}{Is\+Entire} () const 
\begin{DoxyCompactList}\small\item\em If all fragments have been added. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_ab4a808c6dc768ccee3b49c829085f92a}{Get\+Packet} () const 
\begin{DoxyCompactList}\small\item\em Get the entire packet. \end{DoxyCompactList}\item 
\hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$ \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a7fd8b69e913c1326a37a13a4ea8deebc}{Get\+Partial\+Packet} () const 
\begin{DoxyCompactList}\small\item\em Get the complete part of the packet. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a8b4cd61997b516c716d809d2f2f12b51}{m\+\_\+more\+Fragment}
\begin{DoxyCompactList}\small\item\em True if other fragments will be sent. \end{DoxyCompactList}\item 
\hyperlink{openflow-interface_8h_afd9bcfa176617760671b67580f536fa7}{std\+::list}$<$ std\+::pair$<$ \hyperlink{classns3_1_1Ptr}{Ptr}$<$ \hyperlink{classns3_1_1Packet}{Packet} $>$, uint16\+\_\+t $>$ $>$ \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\+\_\+fragments}
\begin{DoxyCompactList}\small\item\em The current fragments. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Additional Inherited Members}


\subsection{Detailed Description}
A Set of Fragment belonging to the same packet (src, dst, identification and proto) 

\subsection{Constructor \& Destructor Documentation}
\index{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}!Fragments@{Fragments}}
\index{Fragments@{Fragments}!ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}}
\subsubsection[{\texorpdfstring{Fragments()}{Fragments()}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments\+::\+Fragments (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1Ipv4L3Protocol_1_1Fragments_ab8123ff39d71b4309255b426fbca630a}{}\label{classns3_1_1Ipv4L3Protocol_1_1Fragments_ab8123ff39d71b4309255b426fbca630a}


Constructor. 


\begin{DoxyCode}
1550   : \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a8b4cd61997b516c716d809d2f2f12b51}{m\_moreFragment} (0)
1551 \{
1552   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
1553 \}
\end{DoxyCode}
\index{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}!````~Fragments@{$\sim$\+Fragments}}
\index{````~Fragments@{$\sim$\+Fragments}!ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}}
\subsubsection[{\texorpdfstring{$\sim$\+Fragments()}{~Fragments()}}]{\setlength{\rightskip}{0pt plus 5cm}ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments\+::$\sim$\+Fragments (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1Ipv4L3Protocol_1_1Fragments_a76f7acceb0c1e77fdd5dcf401ac02b8e}{}\label{classns3_1_1Ipv4L3Protocol_1_1Fragments_a76f7acceb0c1e77fdd5dcf401ac02b8e}


Destructor. 


\begin{DoxyCode}
1556 \{
1557   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
1558 \}
\end{DoxyCode}


\subsection{Member Function Documentation}
\index{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}!Add\+Fragment@{Add\+Fragment}}
\index{Add\+Fragment@{Add\+Fragment}!ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}}
\subsubsection[{\texorpdfstring{Add\+Fragment(\+Ptr$<$ Packet $>$ fragment, uint16\+\_\+t fragment\+Offset, bool more\+Fragment)}{AddFragment(Ptr< Packet > fragment, uint16_t fragmentOffset, bool moreFragment)}}]{\setlength{\rightskip}{0pt plus 5cm}void ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments\+::\+Add\+Fragment (
\begin{DoxyParamCaption}
\item[{{\bf Ptr}$<$ {\bf Packet} $>$}]{fragment, }
\item[{uint16\+\_\+t}]{fragment\+Offset, }
\item[{bool}]{more\+Fragment}
\end{DoxyParamCaption}
)}\hypertarget{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5d56e329da3a9f48e0300cec26ae37e8}{}\label{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5d56e329da3a9f48e0300cec26ae37e8}


Add a fragment. 


\begin{DoxyParams}{Parameters}
{\em fragment} & the fragment \\
\hline
{\em fragment\+Offset} & the offset of the fragment \\
\hline
{\em more\+Fragment} & the bit \char`\"{}\+More Fragment\char`\"{} \\
\hline
\end{DoxyParams}

\begin{DoxyCode}
1562 \{
1563   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this} << fragment << fragmentOffset << moreFragment);
1564 
1565   std::list<std::pair<Ptr<Packet>, uint16\_t> >::iterator it;
1566 
1567   \textcolor{keywordflow}{for} (it = \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.begin (); it != \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.end (); it++)
1568     \{
1569       \textcolor{keywordflow}{if} (it->second > fragmentOffset)
1570         \{
1571           \textcolor{keywordflow}{break};
1572         \}
1573     \}
1574 
1575   \textcolor{keywordflow}{if} (it == \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.end ())
1576     \{
1577       \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a8b4cd61997b516c716d809d2f2f12b51}{m\_moreFragment} = moreFragment;
1578     \}
1579 
1580   \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.insert (it, std::pair<Ptr<Packet>, uint16\_t> (fragment, fragmentOffset));
1581 \}
\end{DoxyCode}
\index{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}!Get\+Packet@{Get\+Packet}}
\index{Get\+Packet@{Get\+Packet}!ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}}
\subsubsection[{\texorpdfstring{Get\+Packet() const }{GetPacket() const }}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<$ {\bf Packet} $>$ ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments\+::\+Get\+Packet (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}\hypertarget{classns3_1_1Ipv4L3Protocol_1_1Fragments_ab4a808c6dc768ccee3b49c829085f92a}{}\label{classns3_1_1Ipv4L3Protocol_1_1Fragments_ab4a808c6dc768ccee3b49c829085f92a}


Get the entire packet. 

\begin{DoxyReturn}{Returns}
the entire packet 
\end{DoxyReturn}

\begin{DoxyCode}
1615 \{
1616   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
1617 
1618   std::list<std::pair<Ptr<Packet>, uint16\_t> >::const\_iterator it = \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.begin ();
1619 
1620   Ptr<Packet> \hyperlink{lte__link__budget_8m_ac9de518908a968428863f829398a4e62}{p} = it->first->Copy ();
1621   uint16\_t lastEndOffset = p->GetSize ();
1622   it++;
1623 
1624   \textcolor{keywordflow}{for} ( ; it != \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.end (); it++)
1625     \{
1626       \textcolor{keywordflow}{if} ( lastEndOffset > it->second )
1627         \{
1628           \textcolor{comment}{// The fragments are overlapping.}
1629           \textcolor{comment}{// We do not overwrite the "old" with the "new" because we do not know when each arrived.}
1630           \textcolor{comment}{// This is different from what Linux does.}
1631           \textcolor{comment}{// It is not possible to emulate a fragmentation attack.}
1632           uint32\_t newStart = lastEndOffset - it->second;
1633           \textcolor{keywordflow}{if} ( it->first->GetSize () > newStart )
1634             \{
1635               uint32\_t newSize = it->first->GetSize () - newStart;
1636               Ptr<Packet> tempFragment = it->first->CreateFragment (newStart, newSize);
1637               p->AddAtEnd (tempFragment);
1638             \}
1639         \}
1640       \textcolor{keywordflow}{else}
1641         \{
1642           \hyperlink{group__logging_ga88acd260151caf2db9c0fc84997f45ce}{NS\_LOG\_LOGIC} (\textcolor{stringliteral}{"Adding: "} << *(it->first) );
1643           p->AddAtEnd (it->first);
1644         \}
1645       lastEndOffset = p->GetSize ();
1646     \}
1647 
1648   \textcolor{keywordflow}{return} \hyperlink{lte__link__budget_8m_ac9de518908a968428863f829398a4e62}{p};
1649 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 2


\index{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}!Get\+Partial\+Packet@{Get\+Partial\+Packet}}
\index{Get\+Partial\+Packet@{Get\+Partial\+Packet}!ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}}
\subsubsection[{\texorpdfstring{Get\+Partial\+Packet() const }{GetPartialPacket() const }}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ptr}$<$ {\bf Packet} $>$ ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments\+::\+Get\+Partial\+Packet (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}\hypertarget{classns3_1_1Ipv4L3Protocol_1_1Fragments_a7fd8b69e913c1326a37a13a4ea8deebc}{}\label{classns3_1_1Ipv4L3Protocol_1_1Fragments_a7fd8b69e913c1326a37a13a4ea8deebc}


Get the complete part of the packet. 

\begin{DoxyReturn}{Returns}
the part we have comeplete 
\end{DoxyReturn}

\begin{DoxyCode}
1653 \{
1654   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
1655   
1656   std::list<std::pair<Ptr<Packet>, uint16\_t> >::const\_iterator it = \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.begin ();
1657 
1658   Ptr<Packet> \hyperlink{lte__link__budget_8m_ac9de518908a968428863f829398a4e62}{p} = Create<Packet> ();
1659   uint16\_t lastEndOffset = 0;
1660 
1661   \textcolor{keywordflow}{if} ( \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.begin ()->second > 0 )
1662     \{
1663       \textcolor{keywordflow}{return} \hyperlink{lte__link__budget_8m_ac9de518908a968428863f829398a4e62}{p};
1664     \}
1665 
1666   \textcolor{keywordflow}{for} ( it = \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.begin (); it != \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.end (); it++)
1667     \{
1668       \textcolor{keywordflow}{if} ( lastEndOffset > it->second )
1669         \{
1670           uint32\_t newStart = lastEndOffset - it->second;
1671           uint32\_t newSize = it->first->GetSize () - newStart;
1672           Ptr<Packet> tempFragment = it->first->CreateFragment (newStart, newSize);
1673           p->AddAtEnd (tempFragment);
1674         \}
1675       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( lastEndOffset == it->second )
1676         \{
1677           \hyperlink{group__logging_ga88acd260151caf2db9c0fc84997f45ce}{NS\_LOG\_LOGIC} (\textcolor{stringliteral}{"Adding: "} << *(it->first) );
1678           p->AddAtEnd (it->first);
1679         \}
1680       lastEndOffset = p->GetSize ();
1681     \}
1682 
1683   \textcolor{keywordflow}{return} \hyperlink{lte__link__budget_8m_ac9de518908a968428863f829398a4e62}{p};
1684 \}
\end{DoxyCode}


Here is the call graph for this function\+:
% FIG 3


\index{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}!Is\+Entire@{Is\+Entire}}
\index{Is\+Entire@{Is\+Entire}!ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}}
\subsubsection[{\texorpdfstring{Is\+Entire() const }{IsEntire() const }}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments\+::\+Is\+Entire (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}\hypertarget{classns3_1_1Ipv4L3Protocol_1_1Fragments_a6373fdd57dfcb84b6954b00948fc9277}{}\label{classns3_1_1Ipv4L3Protocol_1_1Fragments_a6373fdd57dfcb84b6954b00948fc9277}


If all fragments have been added. 

\begin{DoxyReturn}{Returns}
true if the packet is entire 
\end{DoxyReturn}

\begin{DoxyCode}
1585 \{
1586   \hyperlink{log-macros-disabled_8h_a90b90d5bad1f39cb1b64923ea94c0761}{NS\_LOG\_FUNCTION} (\textcolor{keyword}{this});
1587 
1588   \textcolor{keywordtype}{bool} ret = !\hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a8b4cd61997b516c716d809d2f2f12b51}{m\_moreFragment} && \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.size () > 0;
1589 
1590   \textcolor{keywordflow}{if} (ret)
1591     \{
1592       uint16\_t lastEndOffset = 0;
1593 
1594       \textcolor{keywordflow}{for} (\hyperlink{openflow-interface_8h_afd9bcfa176617760671b67580f536fa7}{std::list}<std::pair<Ptr<Packet>, uint16\_t> >::const\_iterator it = 
      \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.begin (); it != \hyperlink{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{m\_fragments}.end (); it++)
1595         \{
1596           \textcolor{comment}{// overlapping fragments do exist}
1597           \hyperlink{group__logging_ga88acd260151caf2db9c0fc84997f45ce}{NS\_LOG\_LOGIC} (\textcolor{stringliteral}{"Checking overlaps "} << lastEndOffset << \textcolor{stringliteral}{" - "} << it->second );
1598 
1599           \textcolor{keywordflow}{if} (lastEndOffset < it->second)
1600             \{
1601               ret = \textcolor{keyword}{false};
1602               \textcolor{keywordflow}{break};
1603             \}
1604           \textcolor{comment}{// fragments might overlap in strange ways}
1605           uint16\_t fragmentEnd = it->first->GetSize () + it->second;
1606           lastEndOffset = \hyperlink{80211b_8c_affe776513b24d84b39af8ab0930fef7f}{std::max} ( lastEndOffset, fragmentEnd );
1607         \}
1608     \}
1609 
1610   \textcolor{keywordflow}{return} ret;
1611 \}
\end{DoxyCode}


\subsection{Member Data Documentation}
\index{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}!m\+\_\+fragments@{m\+\_\+fragments}}
\index{m\+\_\+fragments@{m\+\_\+fragments}!ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}}
\subsubsection[{\texorpdfstring{m\+\_\+fragments}{m_fragments}}]{\setlength{\rightskip}{0pt plus 5cm}{\bf std\+::list}$<$std\+::pair$<${\bf Ptr}$<${\bf Packet}$>$, uint16\+\_\+t$>$ $>$ ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments\+::m\+\_\+fragments\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}{}\label{classns3_1_1Ipv4L3Protocol_1_1Fragments_a5647938dd668471f5872839589d104d9}


The current fragments. 

\index{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}!m\+\_\+more\+Fragment@{m\+\_\+more\+Fragment}}
\index{m\+\_\+more\+Fragment@{m\+\_\+more\+Fragment}!ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments@{ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments}}
\subsubsection[{\texorpdfstring{m\+\_\+more\+Fragment}{m_moreFragment}}]{\setlength{\rightskip}{0pt plus 5cm}bool ns3\+::\+Ipv4\+L3\+Protocol\+::\+Fragments\+::m\+\_\+more\+Fragment\hspace{0.3cm}{\ttfamily [private]}}\hypertarget{classns3_1_1Ipv4L3Protocol_1_1Fragments_a8b4cd61997b516c716d809d2f2f12b51}{}\label{classns3_1_1Ipv4L3Protocol_1_1Fragments_a8b4cd61997b516c716d809d2f2f12b51}


True if other fragments will be sent. 



The documentation for this class was generated from the following files\+:\begin{DoxyCompactItemize}
\item 
internet/model/\hyperlink{ipv4-l3-protocol_8h}{ipv4-\/l3-\/protocol.\+h}\item 
internet/model/\hyperlink{ipv4-l3-protocol_8cc}{ipv4-\/l3-\/protocol.\+cc}\end{DoxyCompactItemize}
